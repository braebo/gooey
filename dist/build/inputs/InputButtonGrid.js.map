{"version":3,"file":"InputButtonGrid.js","sources":["../../../../src/inputs/InputButtonGrid.ts"],"sourcesContent":["import type { JavascriptStyleProperty } from '../shared/css-types'\nimport type { ElementMap, InputOptions } from './Input'\nimport type { TooltipOptions } from '../shared/Tooltip'\nimport type { CreateOptions } from '../shared/create'\nimport type { Folder } from '../Folder'\nimport type {\n\tButtonControllerEvents,\n\tButtonControllerOptions,\n\tButtonEventPayload,\n} from '../controllers/ButtonController'\n\nimport { ButtonController } from '../controllers/ButtonController'\nimport { getStyle } from '../shared/getStyle'\nimport { Logger } from '../shared/logger'\nimport { create } from '../shared/create'\nimport { state } from '../shared/state'\nimport { toFn } from '../shared/toFn'\nimport { Input } from './Input'\n\n/**\n * @see {@link ButtonGridInputOptions.value}\n */\nexport type ButtonGridArrays = ButtonControllerOptions[][]\n\n/**\n * A unique identifier for a button in a {@link ButtonGridArrays} array.  Used as the key in the\n * {@link InputButtonGrid.buttons} map, as the value in the {@link InputButtonGrid.state} property,\n * and as the `id` attribute on the button element.\n */\nexport type ButtonId = string\n\n/**\n * A fully processed {@link ButtonGridArrays} entry with the generated {@link ButtonController}s.\n * Stored in the input's {@link InputButtonGrid.buttonGrid|`buttonGrid`} property.\n */\nexport type ButtonGrid = ButtonController[][]\n\n/**\n * Options for the {@link InputButtonGrid} {@link Input}.\n */\nexport type ButtonGridInputOptions = {\n\treadonly __type?: 'ButtonGridInputOptions'\n\n\t/**\n\t * A 2D array of {@link ButtonControllerOptions} objects, representing a grid of buttons. The inner\n\t * arrays represent rows, and the outer array represents columns.\n\t * @example\n\t * ```ts\n\t * [\n\t *   // First row columns\n\t *   [\n\t *     { text: 'top-left', onClick: () => {} },\n\t *     { text: 'top-right', onClick: () => {} }\n\t *   ],\n\t *   // Second row columns\n\t *   [\n\t *     { text: 'bottom-left', onClick: () => {} },\n\t *     { text: 'bottom-right', onClick: () => {} }\n\t *   ]\n\t * ]\n\t * ```\n\t */\n\tvalue: ButtonGridArrays\n\n\t/**\n\t * Optional css style overrides in {@link JavascriptStyleProperty} (camelCase) format.\n\t */\n\tstyle?: CreateOptions['style']\n\n\t/**\n\t * Whether to apply the `active` classname to the button when it is clicked, changing its\n\t * appearance.\n\t * @default true\n\t */\n\tapplyActiveClass?: boolean\n\n\t/**\n\t * When `false`, the `active` class will be removed from all buttons before applying it to the\n\t * clicked button.  Whem `true`, each button's active class will toggle independently.\n\t */\n\tmultiple?: boolean\n\n\t/**\n\t * Whether a button is clickable.  If a function is passed, it will be called whenever the\n\t * button is refreshed.\n\t * @default false\n\t */\n\tdisabled?: boolean | (() => boolean)\n} & InputOptions<ButtonGridArrays>\n\nexport const BUTTONGRID_INPUT_DEFAULTS = {\n\t__type: 'ButtonGridInputOptions' as const,\n\tvalue: [[{ id: '', text: '', onClick: () => {} }]],\n\tstyle: {\n\t\tgap: '0.5em',\n\t},\n\tapplyActiveClass: true,\n\tresettable: false,\n} as const satisfies ButtonGridInputOptions\n\nexport interface ButtonGridControllerElements extends ElementMap {\n\tcontainer: HTMLElement\n\tbuttonGrid: HTMLButtonElement[]\n}\n\nexport class InputButtonGrid extends Input<\n\t// ButtonController,\n\tSet<ButtonId>,\n\tButtonGridInputOptions,\n\tButtonGridControllerElements,\n\tButtonControllerEvents\n> {\n\treadonly __type = 'InputButtonGrid' as const\n\treadonly initialValue = {} as ButtonGridArrays\n\t// readonly state = state({} as ButtonController)\n\n\t/**\n\t * An array of active button ids.\n\t * @see {@link Input.state}\n\t */\n\treadonly state = state(new Set<ButtonId>())\n\n\tbuttons: Map<ButtonId, ButtonController> = new Map()\n\tbuttonGrid: ButtonGrid\n\n\t/**\n\t * A Set of active button ids.\n\t */\n\tget active(): Set<ButtonId> {\n\t\treturn this.state.value\n\t}\n\tsetActive(id: ButtonId) {\n\t\tconst button = this.buttons.get(id)\n\t\tif (!button) {\n\t\t\tconsole.warn(`Button id \"${id}\" not found`)\n\t\t\treturn\n\t\t}\n\n\t\tconst cls = this.opts.applyActiveClass\n\n\t\tif (!this.opts.multiple) {\n\t\t\tfor (const btn of this.buttons.values()) {\n\t\t\t\tbtn.active = false\n\t\t\t\tif (cls) btn.element.classList.remove('active')\n\t\t\t\tthis.state.value.delete(id)\n\t\t\t}\n\n\t\t\tbutton.active = true\n\t\t\tif (cls) button.element.classList.add('active')\n\t\t\tthis.state.value.add(id)\n\t\t} else {\n\t\t\tconst newState = !button.active\n\t\t\tbutton.active = newState\n\t\t\tif (cls) button.element.classList.toggle('active', newState)\n\t\t\tnewState ? this.state.value.add(id) : this.state.value.delete(id)\n\t\t}\n\t}\n\n\tprivate _log: Logger\n\n\tconstructor(options: Partial<ButtonGridInputOptions>, folder: Folder) {\n\t\tconst opts = Object.assign({}, BUTTONGRID_INPUT_DEFAULTS, options)\n\t\tsuper(opts, folder)\n\n\t\tthis._evm.registerEvents(['click'])\n\n\t\tthis.initialValue = opts.value\n\t\tthis._log = new Logger(`InputButtonGrid ${opts.title}`, { fg: 'cyan' })\n\t\tthis._log.fn('constructor').debug({ opts, this: this })\n\n\t\tconst container = create('div', {\n\t\t\tclasses: ['gooey-input', 'gooey-input-buttongrid-container'],\n\t\t\tparent: this.elements.content,\n\t\t})\n\n\t\tthis.elements.controllers = {\n\t\t\tcontainer,\n\t\t\tbuttonGrid: [],\n\t\t} as const satisfies ButtonGridControllerElements\n\n\t\tthis.buttonGrid = this.toGrid(this.initialValue)\n\n\t\tthis.refresh()\n\t}\n\n\tonClick(\n\t\tcallback: (payload: {\n\t\t\t/** The original click event. */\n\t\t\tevent: MouseEvent\n\t\t\t/** The individual {@link ButtonController} that was clicked. */\n\t\t\tbutton: ButtonController\n\t\t}) => void,\n\t): void {\n\t\tthis._evm.on('click', ({ event, button }) => callback({ event, button }))\n\t}\n\n\t/**\n\t * Converts a {@link ButtonGridArrays} into a a grid of {@link HTMLButtonElement}\n\t * elements, and\n\t *\n\t * - appends them to the {@link InputButtonGrid.elements.controllers.container}\n\t */\n\ttoGrid(grid: ButtonGridArrays): ButtonGrid {\n\t\tconst instanceGrid: ButtonGrid = []\n\t\tconst seen = new Set<string>()\n\n\t\tconst rows = grid.length\n\t\tconst cols = Math.max(...grid.map(row => row.length))\n\n\t\t// Remove all buttons.\n\t\tfor (const { element } of this.buttons.values()) {\n\t\t\telement.remove()\n\t\t}\n\t\tthis.buttons.clear()\n\n\t\tfor (let i = 0; i < rows; i++) {\n\t\t\tconst row = create('div', {\n\t\t\t\tclasses: ['gooey-controller-buttongrid-row'],\n\t\t\t\tparent: this.elements.controllers.container,\n\t\t\t\tstyle: { gap: '0.5em' },\n\t\t\t})\n\n\t\t\tinstanceGrid[i] = []\n\n\t\t\tfor (let j = 0; j < cols; j++) {\n\t\t\t\tconst opts = grid[i]?.[j]\n\t\t\t\tif (opts) {\n\t\t\t\t\tconst id = this._resolveId(opts, seen)\n\n\t\t\t\t\t// console.warn(id)\n\t\t\t\t\tseen.add(id)\n\n\t\t\t\t\tconst button = this.addButton(opts, id, i, j)\n\t\t\t\t\trow.appendChild(button.element)\n\t\t\t\t\tinstanceGrid[i][j] = button\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.elements.container.style.setProperty(\n\t\t\t'height',\n\t\t\tgetStyle(this.elements.controllers.container, 'height'),\n\t\t)\n\n\t\treturn instanceGrid\n\t}\n\n\tprivate _resolveId(opts: ButtonControllerOptions, seen: Set<ButtonId>) {\n\t\tlet id = opts.id ?? (typeof opts.text === 'function' ? opts.text() : opts.text)\n\t\tlet i = 0\n\n\t\t// const ids = new Set(this.buttons.keys())\n\t\t// while (ids.has(id + (i ? i : ''))) i++\n\t\twhile (seen.has(id + (i ? i : ''))) i++\n\n\t\tif (i) id += i\n\n\t\treturn id\n\t}\n\n\taddButton(opts: ButtonControllerOptions, id: string, i: number, j: number): ButtonController {\n\t\tconst text = toFn(opts.text)\n\n\t\tconst tooltip: Partial<TooltipOptions> | undefined = opts.tooltip\n\t\t\t? Object.assign(\n\t\t\t\t\t{\n\t\t\t\t\t\tplacement: 'top',\n\t\t\t\t\t\tdelay: 1000,\n\t\t\t\t\t},\n\t\t\t\t\topts.tooltip,\n\t\t\t\t)\n\t\t\t: undefined\n\n\t\topts.element = create('button', {\n\t\t\tid,\n\t\t\tclasses: [\n\t\t\t\t'gooey-controller',\n\t\t\t\t'gooey-controller-button',\n\t\t\t\t'gooey-controller-buttongrid-button',\n\t\t\t],\n\t\t\tinnerHTML: text(),\n\t\t\tdataset: {\n\t\t\t\tid,\n\t\t\t\trow: String(i),\n\t\t\t\tcol: String(j),\n\t\t\t},\n\t\t\tstyle: {\n\t\t\t\t...opts.style,\n\t\t\t\twidth: '100%',\n\t\t\t},\n\t\t\ttooltip,\n\t\t})\n\n\t\tif (typeof opts.active !== 'function') {\n\t\t\topts.active = () => {\n\t\t\t\t// if (this.opts.multiple) {\n\t\t\t\t// \treturn this.state.value.includes(id)\n\t\t\t\t// }\n\t\t\t\t// return this.state.value === btn.id\n\t\t\t\treturn this.state.value.has(id)\n\t\t\t}\n\t\t}\n\n\t\tconst btn = new ButtonController(opts)\n\n\t\tif (this.opts.applyActiveClass) {\n\t\t\tbtn.element.classList.toggle('active', btn.active)\n\t\t}\n\n\t\tbtn.on('click', payload => {\n\t\t\tthis._set(payload)\n\n\t\t\t// this.set()\n\n\t\t\t// this._evm.emit('click', payload)\n\t\t})\n\n\t\tthis.buttons.set(id, btn)\n\n\t\treturn btn\n\t}\n\n\tprivate _set(payload: ButtonEventPayload) {\n\t\t// const { button } = payload\n\t\t// const cls = this.opts.applyActiveClass\n\n\t\t// btn.element.classList.toggle('active', this.state.value === btn.id)\n\t\tthis.setActive(payload.button.id)\n\n\t\tthis._evm.emit('click', payload)\n\t}\n\n\tset() {\n\t\t// this.state.add(id)\n\n\t\t// this._emit('click')\n\t\tthis.refresh()\n\t}\n\n\trefresh() {\n\t\tthis._log.fn('refresh').debug({ this: this })\n\n\t\tfor (const btn of this.buttons.values()) {\n\t\t\tbtn.refresh()\n\t\t}\n\n\t\tsuper.refresh()\n\t\treturn this\n\t}\n\n\tenable() {\n\t\tfor (const btn of this.buttons.values()) {\n\t\t\tbtn.enable()\n\t\t}\n\t\tthis.disabled = false\n\t\treturn this\n\t}\n\n\tdisable() {\n\t\tfor (const btn of this.buttons.values()) {\n\t\t\tbtn.disable()\n\t\t}\n\t\tthis.disabled = true\n\t\treturn this\n\t}\n\n\tdispose() {\n\t\tfor (const btn of this.buttons.values()) {\n\t\t\tbtn.dispose()\n\t\t}\n\t\tthis.buttons.clear()\n\t\tsuper.dispose()\n\t}\n}\n"],"names":[],"mappings":"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"}