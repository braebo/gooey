{"version":3,"file":"InputButton.js","sources":["../../../../src/inputs/InputButton.ts"],"sourcesContent":["import type { ElementMap, InputEvents, InputOptions } from './Input'\nimport type { State } from '../shared/state'\nimport type { Folder } from '../Folder'\n\nimport { ButtonController } from '../controllers/ButtonController'\nimport { Logger } from '../shared/logger'\nimport { create } from '../shared/create'\nimport { state } from '../shared/state'\nimport { Input } from './Input'\nimport { DEV } from 'esm-env'\n\nexport type ButtonClickFunction = (this: InputButton) => void\n\nexport type ButtonInputOptions = InputOptions<ButtonClickFunction> & {\n\treadonly __type?: 'ButtonInputOptions'\n\ttext: string | (() => string)\n\t/**\n\t * The function to call when the button is clicked.\n\t */\n\tvalue?: ButtonClickFunction\n\t/**\n\t * An alias for {@link value} (does the same thing).\n\t */\n\tonClick?: ButtonClickFunction\n}\n\nexport const BUTTON_INPUT_DEFAULTS: ButtonInputOptions = {\n\t__type: 'ButtonInputOptions' as const,\n\ttext: () => 'click me',\n} as const\n\nexport interface ButtonControllerElements extends ElementMap {\n\tcontainer: HTMLElement\n\tbutton: HTMLButtonElement\n}\n\ninterface ButtonInputEvents extends InputEvents<InputButton> {\n\tclick: void\n}\n\nexport class InputButton extends Input<\n\tButtonController,\n\tButtonInputOptions,\n\tButtonControllerElements,\n\tButtonInputEvents\n> {\n\treadonly __type = 'InputButton' as const\n\treadonly initialValue = {} as ButtonController\n\treadonly state = state({}) as State<ButtonController>\n\n\tonClick: ButtonClickFunction = () => {}\n\n\tbutton: ButtonController\n\n\tprivate _log: Logger\n\n\tconstructor(options: Partial<ButtonInputOptions>, folder: Folder) {\n\t\tconst opts = Object.assign({}, BUTTON_INPUT_DEFAULTS, options, {\n\t\t\t__type: 'ButtonInputOptions' as const,\n\t\t})\n\t\tsuper(opts, folder)\n\t\tthis._evm.registerEvents(['change', 'refresh', 'click'])\n\n\t\tthis._log = new Logger(`InputButton ${opts.title}`, { fg: 'cyan' })\n\t\tthis._log.fn('constructor').debug({ opts, this: this })\n\n\t\tif (opts.value) this.onClick = opts.value\n\t\telse if (opts.onClick) this.onClick = opts.onClick\n\t\telse {\n\t\t\tif (DEV) {\n\t\t\t\tconsole.error(\n\t\t\t\t\t`${this.title} created with no onClick function. Use the 'value' or 'onClick' property to assign one.`,\n\t\t\t\t)\n\t\t\t}\n\t\t}\n\n\t\tconst container = create('div', {\n\t\t\tclasses: ['fracgui-input-button-container'],\n\t\t\tparent: this.elements.content,\n\t\t})\n\n\t\tthis.button = new ButtonController({\n\t\t\ttext: opts.text,\n\t\t\tonClick: opts.onClick,\n\t\t\tparent: container,\n\t\t})\n\n\t\tthis.elements.controllers = {\n\t\t\tcontainer,\n\t\t\tbutton: this.button.element,\n\t\t} as const satisfies ButtonControllerElements\n\n\t\tthis._evm.listen(this.elements.controllers.button, 'click', this.click.bind(this))\n\n\t\tthis._evm.add(this.state.subscribe(this.refresh.bind(this)))\n\t}\n\n\tget text() {\n\t\treturn this.button.text\n\t}\n\tset text(v: string | (() => string)) {\n\t\tthis.button.text = v\n\t}\n\n\t/**\n\t * Manually calls the {@link onClick} function.\n\t */\n\tclick() {\n\t\tthis.button.click({ ...new MouseEvent('click'), target: this.button.element })\n\t}\n\n\tenable() {\n\t\tthis.button.enable()\n\t\tsuper.enable()\n\t\treturn this\n\t}\n\n\tdisable() {\n\t\tthis.button.disable()\n\t\tsuper.disable()\n\t\treturn this\n\t}\n\n\t/**\n\t * Overwrites the\n\t */\n\tset = (v: ButtonController | unknown) => {\n\t\tif (ButtonController.is(v)) {\n\t\t\tv //=>\n\t\t\tthis.state.set(v)\n\t\t}\n\t}\n\n\t/**\n\t * Refreshes the button text.\n\t */\n\trefresh() {\n\t\tthis.button.refresh()\n\t\tsuper.refresh()\n\t\treturn this\n\t}\n\n\tdispose() {\n\t\tthis.button.dispose()\n\t\tsuper.dispose()\n\t}\n}\n"],"names":[],"mappings":"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"}