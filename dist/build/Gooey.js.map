{"version":3,"file":"Gooey.js","sources":["../../../src/Gooey.ts"],"sourcesContent":["import type { WindowInstance, WindowManagerOptions } from './shared/WindowManager'\nimport type { Theme, ThemeMode } from './styles/themer/types'\nimport type { ThemerOptions } from './styles/themer/Themer'\nimport type { FolderOptions, FolderPreset } from './Folder'\nimport type { ResizableOptions } from './shared/resizable'\nimport type { DraggableOptions } from './shared/draggable'\nimport type { Placement } from './shared/place'\nimport type { Commit } from './UndoManager'\n\nimport theme_default from './styles/themes/vanilla'\nimport theme_scout from './styles/themes/scout'\nimport theme_flat from './styles/themes/flat'\nimport style from './styles/gooey.css'\n\nimport { WindowManager, WINDOWMANAGER_DEFAULTS } from './shared/WindowManager'\nimport { persist, type PersistedValue } from './shared/persist'\nimport { deepMergeOpts } from './shared/deepMergeOpts'\nimport { resolveOpts } from './shared/resolveOpts'\nimport { PresetManager } from './PresetManager'\nimport { Themer } from './styles/themer/Themer'\nimport settingsIcon from './svg/settings-icon'\nimport { GUI_VARS } from './styles/GOOEY_VARS'\nimport { UndoManager } from './UndoManager'\nimport { select } from './shared/select'\nimport { nanoid } from './shared/nanoid'\nimport { Logger } from './shared/logger'\nimport { create } from './shared/create'\nimport { place } from './shared/place'\nimport { Folder } from './Folder'\nimport { o } from './shared/l'\n\n//#region Types ························································································¬\n\ntype GooeyTheme = 'default' | 'flat' | 'scout' | (string & {})\n\nexport interface GooeyElements {\n\troot: HTMLElement\n\tcontainer: HTMLElement\n\twrapper: HTMLElement\n\tsettingsFolder: Folder\n}\n\nexport interface GooeyOptions {\n\t__type: 'GooeyOptions'\n\n\t/**\n\t * The title of the Gooey.\n\t * @default 'gooey'\n\t */\n\ttitle: string\n\n\t/**\n\t * Defines which properties to persist in localStorage, and under which\n\t * key, if any.  If `true`, the {@link GUI_STORAGE_DEFAULTS} will be used.\n\t * If `false`, no state will be persisted.\n\t * @default true\n\t */\n\tstorage: boolean | Partial<GooeyStorageOptions>\n\n\t/**\n\t * The container to append the gooey to.\n\t * @default 'body'\n\t */\n\t// container: HTMLElement\n\tcontainer: string | HTMLElement | 'document' | 'body'\n\n\t/**\n\t * Whether the gooey is draggable.\n\t * @default true\n\t */\n\tdraggable: boolean\n\n\t/**\n\t * Whether the gooey is resizable.\n\t * @default true\n\t */\n\tresizable: boolean\n\n\t/**\n\t * The title of the theme to use for the gooey.  To add your own themes,\n\t * use {@link themerOptions.themes}.\n\t * @default 'default'\n\t */\n\ttheme: GooeyTheme\n\n\t/**\n\t * The themes available to the gooey.\n\t * @defaultValue [ {@link theme_default|default}, {@link theme_flat|flat}, {@link theme_scout|scout} ]\n\t */\n\tthemes: Theme[]\n\n\t/**\n\t * The initial {@link Themer.mode|theme mode}.\n\t * @default 'dark'\n\t */\n\tthemeMode: 'light' | 'dark' | 'system'\n\n\t/**\n\t * The gooey's initial position on the screen.  If `undefined`, the gooey will\n\t * be placed in the top-right corner of the screen.\n\t *\n\t * This value can either be a {@link Placement} string, or an object with\n\t * `x` and `y` properties representing the position in pixels.\n\t * @default 'top-right'\n\t */\n\tposition: Placement | { x: number; y: number }\n\n\t/**\n\t * The margin in pixels to apply to the placement.  Can be a number\n\t * to apply the same margin to both x and y, or an object with x\n\t * and y properties to apply different margins to each axis.\n\t * @default 16\n\t */\n\tmargin: number | { x?: number; y?: number }\n\n\t/**\n\t * The initial width of the gooey in pixels.\n\t *\n\t * @remakrs This can also be set by overriding the `--gooey-root_width` CSS custom property on\n\t * the {@link Gooey.element} element `.gooey-root`, which is responsible for the root width.\n\t * @default undefined\n\t */\n\twidth?: number\n\n\t/**\n\t * The initial expanded state of the gooey.\n\t * @default false\n\t */\n\tclosed: boolean\n\n\t/**\n\t * The initial hidden state of the gooey.\n\t * @default false\n\t */\n\thidden?: boolean\n\n\t/**\n\t * Presets to make available in the gooey.\n\t * @default []\n\t */\n\tpresets?: GooeyPreset[]\n\n\t/**\n\t * The default preset to load when the gooey is created, or the initial gooey state if undefined.\n\t * @default undefined\n\t */\n\tdefaultPreset?: GooeyPreset\n\n\t/**\n\t * A unique id for the gooey's root element.\n\t * @default {@link nanoid}\n\t */\n\tid?: string\n\n\t/**\n\t * Whether to load the default font for use.  Set to `false` if you're overwriting\n\t * the `--fragcui-font` variable in your theme.\n\t * @default true\n\t */\n\tloadDefaultFont?: boolean\n\n\t/**\n\t * Any {@link FolderOptions} for the builtin global settings folder.  It also accepts 2\n\t * additional settings, `uiFolder` and `presetsFolder`, which are {@link FolderOptions}\n\t * for the 2 sub-folders.\n\t * @default { closed: true }\n\t */\n\tsettingsFolder?: Partial<FolderOptions> & {\n\t\tuiFolder?: Partial<FolderOptions>\n\t\tpresetsFolder?: Partial<FolderOptions>\n\t}\n\n\t/**\n\t * An offset to apply to the initial position of the gooey.\n\t * @default { x: 0, y: 0 }\n\t */\n\toffset?: { x?: number; y?: number }\n}\n\nexport interface GooeyOptionsInternal extends GooeyOptions {\n\t/**\n\t * todo - this needs to be public, maybe as `GooeyOptions.parentGooey` so the user doesn't\n\t * todo - have to think about the window manager?\n\t * @internal\n\t */\n\t_windowManager?: WindowManager\n\n\t/**\n\t * @internal\n\t */\n\t_themer?: Themer\n}\n\n/**\n * Defines which properties to persist in localStorage, and under which\n * key.\n * @example\n * // defaults:\n * {\n *   key: 'gooey',\n *   closed: true,\n *   theme: true,\n *   presets: true,\n *   position: false,\n *   size: false,\n * }\n */\nexport interface GooeyStorageOptions {\n\t__type: 'GooeyStorageOptions'\n\n\t/**\n\t * Prefix to use for localStorage keys.\n\t *\n\t * @remarks The provided string is prepended to the gooey's title, lowercased, and hyphens\n\t * are replaced with spaces.  For example, a gooey titled `\"Foo Bar\"` is stored as\n\t * `\"foo-bar::gooey\"`.\n\t *\n\t * @default \"default\"\n\t */\n\tkey: string\n\n\t/**\n\t * Whether to persist the folder's expanded state.\n\t * @default true\n\t */\n\tclosed?: boolean\n\n\t/**\n\t * Whether to persist the theme.\n\t * @default true\n\t */\n\ttheme?: boolean\n\n\t/**\n\t * Whether to persist the gooey's position.\n\t * @default false\n\t */\n\tposition?: boolean\n\n\t/**\n\t * Whether to persist the gooey's size.\n\t * @default false\n\t */\n\tsize?: boolean\n\n\t/**\n\t * Whether to persist the gooey's presets.\n\t * @default true\n\t */\n\tpresets?: boolean\n}\n\nexport interface GooeyPreset {\n\t__type: 'GooeyPreset'\n\t__version: string\n\tid: string\n\ttitle: string\n\tdata: FolderPreset\n}\n//#endregion\n\n//#region Constants ····················································································¬\n\nexport const GUI_STORAGE_DEFAULTS: GooeyStorageOptions = {\n\t__type: 'GooeyStorageOptions',\n\tkey: 'default',\n\tclosed: true,\n\ttheme: true,\n\tpresets: true,\n\tposition: false,\n\tsize: false,\n} as const\n\n/**\n * The default {@link WindowManagerOptions} for a {@link Gooey}'s\n * {@link Gooey.windowManager|window manager}.  These are handled internally via the private\n * {@link GooeyOptionsInternal._windowManager|gooey options}.\n * @internal\n */\nexport const GUI_WINDOWMANAGER_DEFAULTS = {\n\t__type: 'WindowManagerOptions',\n\tpreserveZ: false,\n\tzFloor: 0,\n\tbounds: undefined,\n\tobstacles: undefined,\n\tresizable: {\n\t\tgrabberSize: 9,\n\t\tcolor: 'var(--bg-d)',\n\t\tsides: ['right', 'left'],\n\t\tcorners: [],\n\t},\n\tdraggable: {\n\t\tbounds: undefined,\n\t\tclasses: {\n\t\t\tdefault: 'gooey-draggable',\n\t\t\tdragging: 'gooey-dragging',\n\t\t\tcancel: 'gooey-cancel',\n\t\t\tdragged: 'gooey-dragged',\n\t\t},\n\t},\n} as const satisfies WindowManagerOptions\n\n/**\n * The default values for {@link GooeyOptions}.\n */\nexport const GUI_DEFAULTS = {\n\t__type: 'GooeyOptions',\n\ttitle: 'gooey',\n\tstorage: true,\n\tclosed: false,\n\tposition: 'top-right',\n\tmargin: 16,\n\tcontainer: 'body',\n\ttheme: 'vanilla',\n\tthemeMode: 'dark',\n\tthemes: [theme_default, theme_flat, theme_scout],\n\tresizable: true,\n\tdraggable: true,\n\tloadDefaultFont: true,\n\tsettingsFolder: {\n\t\tclosed: true as boolean,\n\t\tuiFolder: { closed: true, presetId: 'gooey_settings__ui_folder' },\n\t\tpresetsFolder: { closed: true, presetId: 'gooey_settings__presets_folder' },\n\t},\n\toffset: { x: 0, y: 0 },\n} as const satisfies GooeyOptions\n\n/**\n * Methods inherited from {@link Folder} to forward to the gooey.\n * @remarks Gooey _used to_ extend {@link Folder}, but that caused more problems than it solved...\n */\n// prettier-ignore\nconst FORWARDED_METHODS = ['on', 'add', 'addMany', 'addButtonGrid', 'addSelect', 'addButton', 'addText', 'addNumber', 'addSwitch', 'addColor', 'bind', 'bindMany', 'bindButtonGrid', 'bindSelect', 'bindButton', 'bindText', 'bindNumber', 'bindSwitch', 'bindColor', 'open', 'close', 'show', 'hide', 'toggle', 'toggleHidden'] as const satisfies Array<keyof Folder>;\n//#endregion\n\nexport interface Gooey extends Pick<Folder, (typeof FORWARDED_METHODS)[number]> {}\n\n/**\n * A customizable GUI toolkit for quickly creating interactive controls panels.\n */\nexport class Gooey {\n\t__type = 'Gooey' as const\n\n\tid = nanoid()\n\tfolder: Folder\n\n\telements: GooeyElements\n\n\t/**\n\t * The initial options passed to the gooey.\n\t */\n\topts: GooeyOptions & { storage: GooeyStorageOptions | false }\n\n\t/**\n\t * The {@link PresetManager} instance for the gooey.\n\t */\n\tpresetManager!: PresetManager\n\n\t/**\n\t * Whether any of the inputs have been changed from their default values in the active preset.\n\t */\n\tdirty = false\n\n\t/**\n\t * A transparent (display:contents) wrapper for the Gooey.  Used for the global style variables.\n\t */\n\twrapper!: HTMLElement\n\n\t/**\n\t * The main div containing the a Gooey — specifically, the {@link Folder.element}.\n\t */\n\tcontainer!: HTMLElement\n\n\t/**\n\t * The {@link UndoManager} instance for the gooey, handling undo/redo functionality.\n\t * @internal\n\t */\n\t_undoManager = new UndoManager()\n\n\tthemer: Themer\n\t// themeEditor?: ThemeEditor\n\twindowManager?: WindowManager\n\tmoveTo: (position: { x: number; y: number }) => void = () => {}\n\tmoveBy: (delta: { x?: number; y?: number }) => void = () => {}\n\n\t/**\n\t * `false` if this {@link Gooey}'s {@link WindowManager} belongs to an existing, external\n\t * instance _(i.e. a separate {@link Gooey} instance or custom {@link WindowManager})_.  The\n\t * {@link WindowManager} will be disposed when this {@link Gooey} is disposed.\n\t * @internal\n\t */\n\tprivate _isWindowManagerOwner = false\n\tprivate _theme!: GooeyOptions['theme']\n\tprivate _log: Logger\n\tprivate _closedMap: PersistedValue<Record<string, boolean>>\n\tprivate static _initialized = false\n\n\tconstructor(title?: Partial<GooeyOptions>, options?: Partial<GooeyOptions>)\n\tconstructor(options?: Partial<GooeyOptions>, never?: never)\n\tconstructor(\n\t\ttitleOrOptions?: string | Partial<GooeyOptions>,\n\t\toptions = {} as Partial<GooeyOptions>,\n\t) {\n\t\t//#region Setup ················································································¬\n\n\t\tif (!Gooey._initialized && globalThis.document) {\n\t\t\tGooey._initialized = true\n\t\t\tconst sheet = new CSSStyleSheet()\n\t\t\tsheet.replaceSync(style)\n\t\t\tglobalThis.document.adoptedStyleSheets.push(sheet)\n\t\t}\n\n\t\tconst initialOptions =\n\t\t\ttypeof titleOrOptions === 'string'\n\t\t\t\t? {\n\t\t\t\t\t\t...options,\n\t\t\t\t\t\ttitle: titleOrOptions,\n\t\t\t\t\t}\n\t\t\t\t: (titleOrOptions ?? {})\n\n\t\tconst opts = deepMergeOpts([GUI_DEFAULTS, initialOptions], {\n\t\t\tconcatArrays: false,\n\t\t}) as GooeyOptions\n\n\t\topts.container ??= document.body\n\n\t\topts.offset ??= { x: 0, y: 0 }\n\t\tif (initialOptions.offset?.x) opts.offset.x = initialOptions.offset.x\n\t\tif (initialOptions.offset?.y) opts.offset.y = initialOptions.offset.y\n\n\t\tif (typeof opts.storage === 'object') {\n\t\t\topts.storage = Object.assign({}, GUI_STORAGE_DEFAULTS, opts.storage)\n\t\t}\n\n\t\tlet storageKey = ''\n\t\tconst storageOpts = resolveOpts(opts.storage, GUI_STORAGE_DEFAULTS)\n\t\tif (!storageOpts) {\n\t\t} else {\n\t\t\tstorageKey = `${storageOpts.key}::${opts.title?.toLowerCase().replaceAll(/\\s/g, '-')}`\n\t\t\topts.storage = {\n\t\t\t\t...storageOpts,\n\t\t\t\tkey: storageKey,\n\t\t\t}\n\t\t}\n\n\t\tthis.opts = opts as GooeyOptions & { storage: GooeyStorageOptions | false }\n\n\t\tthis._log = new Logger(`Gooey ${this.opts.title}`, { fg: 'palevioletred' })\n\n\t\tif (this.opts.loadDefaultFont !== false) {\n\t\t\tthis._loadFonts()\n\t\t}\n\n\t\tthis.elements ??= {} as GooeyElements\n\n\t\tthis.container = select(this.opts.container)[0]\n\t\tthis.elements.container = this.container\n\n\t\tthis.wrapper = create('div', {\n\t\t\tclasses: ['gooey-wrapper'],\n\t\t\tstyle: {\n\t\t\t\tdisplay: 'contents',\n\t\t\t},\n\t\t})\n\t\tthis.elements.wrapper = this.wrapper\n\t\tthis.wrapper.style.visibility = 'hidden'\n\t\tthis.container.append(this.wrapper)\n\n\t\tthis._closedMap = persist(`${storageKey || `gooey::${this.opts.title}`}::closed-map`, {})\n\t\tthis._closedMap\n\n\t\tthis.folder = new Folder({\n\t\t\t...this.opts,\n\t\t\t__type: 'FolderOptions',\n\t\t\tcontainer: this.wrapper,\n\t\t\t// @ts-expect-error @internal\n\t\t\tgooey: this,\n\t\t\tpresetId: this.opts.title,\n\t\t})\n\n\t\t// Poor-mans inheritance...\n\t\tfor (const key of FORWARDED_METHODS) {\n\t\t\t// @ts-expect-error - ¯\\_(ツ)_/¯\n\t\t\tthis[key] = this.folder[key].bind(this.folder)\n\t\t}\n\n\t\tconst handleUndoRedo = (e: KeyboardEvent) => {\n\t\t\tif (globalThis.navigator?.userAgent?.match(/mac/i)) {\n\t\t\t\tif (e.metaKey && e.key === 'z') {\n\t\t\t\t\te.preventDefault()\n\t\t\t\t\te.shiftKey ? this._undoManager.redo() : this._undoManager.undo()\n\t\t\t\t}\n\t\t\t} else if (e.ctrlKey) {\n\t\t\t\tif (e.key === 'z') {\n\t\t\t\t\te.preventDefault()\n\t\t\t\t\tthis._undoManager.undo()\n\t\t\t\t}\n\n\t\t\t\tif (e.key === 'y') {\n\t\t\t\t\te.preventDefault()\n\t\t\t\t\tthis._undoManager.redo()\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tremoveEventListener('keydown', handleUndoRedo)\n\t\taddEventListener('keydown', handleUndoRedo)\n\t\t//#endregion\n\n\t\tconst { button, updateIcon } = this._createSettingsButton(\n\t\t\tthis.folder.elements.toolbar.container,\n\t\t)\n\t\tthis.folder.elements.toolbar.settingsButton = button\n\n\t\tlet settingsFolderClosed = GUI_DEFAULTS.settingsFolder.closed\n\t\t// Use localstorage, if enabled.\n\t\tif (typeof opts.storage === 'object' && opts.storage.closed !== false) {\n\t\t\tsettingsFolderClosed = this._closedMap.value['gooey_settings'] ?? true\n\t\t} else if (opts.settingsFolder?.closed) {\n\t\t\tsettingsFolderClosed = opts.settingsFolder.closed\n\t\t}\n\n\t\tthis.elements.settingsFolder = this.addFolder('gooey_settings_folder', {\n\t\t\t// @ts-expect-error @internal\n\t\t\t_headerless: true,\n\t\t\t...opts.settingsFolder,\n\t\t\tclosed: settingsFolderClosed,\n\t\t\tsaveable: false,\n\t\t\tpresetId: 'gooey_settings',\n\t\t})\n\t\tthis.elements.settingsFolder.element.classList.add(\n\t\t\t'gooey-settings-folder',\n\t\t\t'gooey-folder-alt',\n\t\t)\n\t\tupdateIcon()\n\t\tthis.elements.settingsFolder.element.style.setProperty('order', '-99') // todo - sup with this?\n\n\t\tthis.themer =\n\t\t\t(this.opts as GooeyOptionsInternal)._themer ??\n\t\t\tthis._createThemer(this.elements.settingsFolder)!\n\t\tthis.theme = this.opts.theme\n\t\tthis.presetManager = this._createPresetManager(this.elements.settingsFolder)\n\n\t\tthis.windowManager ??= this._createWindowManager(this.opts, this.opts.storage)\n\n\t\tif (!this.opts.hidden) {\n\t\t\tthis._revealing = true\n\t\t}\n\t}\n\n\tget title(): string {\n\t\treturn this.folder.title\n\t}\n\tset title(v: string) {\n\t\tthis.folder.title = v\n\t}\n\n\tget closed(): Folder['closed'] {\n\t\treturn this.folder.closed\n\t}\n\n\tget hidden(): boolean {\n\t\treturn this.folder.hidden\n\t}\n\n\tget inputs() {\n\t\treturn this.folder.inputs\n\t}\n\tget allInputs() {\n\t\t// todo - Really don't love this.\n\t\treturn new Map(\n\t\t\t[...this.folder.allInputs.entries()].filter(\n\t\t\t\t// Filter out the global settings,\n\t\t\t\t([k]) => !k.match(/gooey_settings/) && k !== 'theme' && k !== 'mode',\n\t\t\t),\n\t\t)\n\t}\n\n\tget window(): WindowInstance | undefined {\n\t\treturn this.windowManager?.windows.get(this.folder.element.id)\n\t}\n\n\tset theme(theme: GooeyTheme) {\n\t\tthis._theme = theme\n\t\tthis.folder.element.setAttribute('theme', theme)\n\t\tthis.folder.element.setAttribute('mode', this.themer.mode.value)\n\t}\n\tget theme() {\n\t\treturn this._theme!\n\t}\n\n\t/**\n\t * The root {@link folder} {@link Folder.element|element}.\n\t */\n\tget element(): HTMLElement {\n\t\treturn this.folder.element\n\t}\n\n\t/**\n\t * The position of the window relative to the {@link container}.\n\t */\n\tget position() {\n\t\treturn this.window?.draggableInstance?.position ?? { x: 0, y: 0 }\n\t}\n\tset position(v: { x: number; y: number }) {\n\t\tthis.window?.draggableInstance?.moveTo(v)\n\t}\n\n\trevealTimeout: ReturnType<typeof setTimeout> | undefined\n\trevealIdle: ReturnType<typeof requestIdleCallback> | undefined\n\n\tpublic addFolder(title: string, options?: Partial<FolderOptions>) {\n\t\treturn this.folder.addFolder(title, {\n\t\t\t...options,\n\t\t\t// @ts-expect-error @internal\n\t\t\tgooey: this,\n\t\t})\n\t}\n\n\t/**\n\t * Saves the current gooey state as a preset.\n\t */\n\tsave(\n\t\t/**\n\t\t * The title of the preset.\n\t\t */\n\t\ttitle: string,\n\t\t/**\n\t\t * A unique id for the preset.\n\t\t * @defaultValue {@link nanoid|nanoid(10)}\n\t\t */\n\t\tid = nanoid(10),\n\t\tversion?: string,\n\t) {\n\t\tthis._log.fn('save').debug({ title, id })\n\t\tconst preset: GooeyPreset = {\n\t\t\t__type: 'GooeyPreset',\n\t\t\t__version: version ?? this.presetManager.__version,\n\t\t\tid,\n\t\t\ttitle,\n\t\t\tdata: this.folder.save(),\n\t\t} as const\n\n\t\treturn preset\n\t}\n\n\t/**\n\t * Loads a given preset into the gooey, updating all inputs.\n\t */\n\tload(preset: GooeyPreset | Record<string, any>) {\n\t\tthis._log.fn('load').debug({ preset })\n\n\t\t// todo - this isn't working, it's being unset immediately somewhere...\n\t\tthis.dirty = false\n\n\t\tthis._lockCommits(preset as GooeyPreset)\n\t\tthis.folder.load(preset.data)\n\t\tPromise.resolve().then(() => this._unlockCommits())\n\t}\n\n\tprivate _undoLock = false\n\tprivate _lockCommit: { from: GooeyPreset | undefined } = { from: undefined }\n\n\t/**\n\t * Commits a change to the input's value to the undo manager.\n\t */\n\tprivate _commit(commit: Partial<Commit>) {\n\t\tif (this._undoLock) {\n\t\t\tthis._log.fn('commit').debug('LOCKED: prevented commit while locked')\n\t\t\treturn\n\t\t}\n\t\tthis._log.fn('commit').debug('commited', commit)\n\t\tthis._undoManager?.commit(commit as Commit)\n\t}\n\n\t/**\n\t * Prevents the input from registering undo history, storing the initial\n\t * for the eventual commit in {@link _unlockCommits}.\n\t */\n\tprivate _lockCommits = (from: GooeyPreset) => {\n\t\tthis._undoManager.lockedExternally = true\n\t\tthis._lockCommit.from = from\n\t\tthis._log.fn(o('lock')).debug('commit', { from, lockCommit: this._lockCommit })\n\t}\n\n\t/**\n\t * Unlocks commits and saves the current commit stored in lock.\n\t */\n\tprivate _unlockCommits = (commit?: Partial<Commit>) => {\n\t\tcommit ??= {}\n\t\tcommit.target ??= this as any\n\t\tcommit.from ??= this._lockCommit.from\n\n\t\tthis._undoManager.lockedExternally = false\n\t\tthis._commit(commit)\n\n\t\tthis._log.fn(o('unlock')).debug('commit', { commit, lockCommit: this._lockCommit })\n\t}\n\n\tprivate _loadFonts() {\n\t\tconst fredoka = new FontFace(\n\t\t\t'fredoka',\n\t\t\t`url(${encodeURI?.(\n\t\t\t\t'https://cdn.jsdelivr.net/fontsource/fonts/fredoka:vf@latest/latin-wdth-normal.woff2',\n\t\t\t)})`,\n\t\t\t{\n\t\t\t\tstyle: 'normal',\n\t\t\t\tdisplay: 'auto',\n\t\t\t\tweight: '300 700',\n\t\t\t\tstretch: '75% 125%',\n\t\t\t\tunicodeRange:\n\t\t\t\t\t'U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD',\n\t\t\t},\n\t\t)\n\n\t\tfredoka.load().then(font => {\n\t\t\t// @ts-expect-error - ¯\\_(ツ)_/¯\n\t\t\tdocument.fonts.add(font)\n\t\t})\n\n\t\tconst Inconsolata = new FontFace(\n\t\t\t'Inconsolata',\n\t\t\t`url(${encodeURI?.(\n\t\t\t\t'https://cdn.jsdelivr.net/fontsource/fonts/inconsolata:vf@latest/latin-wdth-normal.woff2',\n\t\t\t)})`,\n\t\t\t{\n\t\t\t\tstyle: 'normal',\n\t\t\t\tdisplay: 'auto',\n\t\t\t\tweight: '300 700',\n\t\t\t\tstretch: '75% 125%',\n\t\t\t\tunicodeRange:\n\t\t\t\t\t'U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD',\n\t\t\t},\n\t\t)\n\n\t\tInconsolata.load().then(font => {\n\t\t\t// @ts-expect-error - ¯\\_(ツ)_/¯\n\t\t\tdocument.fonts.add(font)\n\t\t})\n\t}\n\n\tprivate _createThemer(folder: Folder) {\n\t\tthis._log.fn('createThemer').debug({ folder })\n\t\tlet finalThemer = undefined as Themer | undefined\n\t\tconst themer = (this.opts as GooeyOptionsInternal)._themer\n\t\tconst themerOptions: Partial<ThemerOptions> = {\n\t\t\tlocalStorageKey: this.opts.storage ? this.opts.storage.key + '::themer' : undefined,\n\t\t\tmode: this.opts.themeMode,\n\t\t\tautoInit: !this.themer,\n\t\t\tpersistent: !!(this.opts.storage && this.opts.storage.theme),\n\t\t\tthemes: this.opts.themes,\n\t\t\ttheme: this.opts.themes.find(t => t.title === this.opts.theme),\n\t\t\tvars: GUI_VARS,\n\t\t}\n\t\tthemerOptions.vars = deepMergeOpts([GUI_VARS, themerOptions.vars])\n\n\t\tif (themer) {\n\t\t\tfinalThemer = themer\n\t\t} else {\n\t\t\tthemerOptions.wrapper = this.wrapper\n\t\t\tfinalThemer = new Themer(this.folder.element, themerOptions)\n\t\t}\n\n\t\tconst uiFolder = folder.addFolder(\n\t\t\t'ui',\n\t\t\tObject.assign(\n\t\t\t\t{},\n\t\t\t\tGUI_DEFAULTS.settingsFolder.uiFolder,\n\t\t\t\tthis.opts.settingsFolder?.uiFolder,\n\t\t\t\t{ presetId: 'gooey_settings__ui_folder' },\n\t\t\t),\n\t\t)\n\n\t\tif (folder) {\n\t\t\tconst themeInput = uiFolder.addSelect('theme', finalThemer.themes.value, {\n\t\t\t\tpresetId: uiFolder.presetId + '__theme_select',\n\t\t\t\tlabelKey: 'title',\n\t\t\t\tinitialValue: finalThemer.theme.value,\n\t\t\t})\n\t\t\tthemeInput.on('change', v => {\n\t\t\t\tfinalThemer.theme.set(v.value)\n\t\t\t})\n\n\t\t\tconst modeButtons = uiFolder.addButtonGrid(\n\t\t\t\t'mode',\n\t\t\t\t[\n\t\t\t\t\t['light', 'dark', 'system'].map(m => ({\n\t\t\t\t\t\ttext: m,\n\t\t\t\t\t\tonClick: () => finalThemer?.mode.set(m as ThemeMode),\n\t\t\t\t\t\tactive: () => finalThemer?.mode.value === m,\n\t\t\t\t\t})),\n\t\t\t\t],\n\t\t\t\t{\n\t\t\t\t\tpresetId: uiFolder.presetId + '__mode_buttons',\n\t\t\t\t\tapplyActiveClass: true,\n\t\t\t\t},\n\t\t\t)\n\t\t\tuiFolder.evm.add(\n\t\t\t\tfinalThemer.mode.subscribe(v => {\n\t\t\t\t\tmodeButtons.setActive(v)\n\t\t\t\t}),\n\t\t\t)\n\t\t}\n\n\t\treturn finalThemer\n\t}\n\n\tprivate _createSettingsButton(parent: HTMLElement): {\n\t\tbutton: HTMLButtonElement\n\t\tupdateIcon: () => void\n\t} {\n\t\tconst button = create('button', {\n\t\t\tparent,\n\t\t\tclasses: ['gooey-toolbar-item', 'gooey-settings-button'],\n\t\t\tinnerHTML: settingsIcon,\n\t\t\ttooltip: {\n\t\t\t\ttext: () => {\n\t\t\t\t\treturn this.elements.settingsFolder?.closed.value\n\t\t\t\t\t\t? 'Open Settings'\n\t\t\t\t\t\t: 'Close Settings'\n\t\t\t\t},\n\t\t\t\tplacement: 'right',\n\t\t\t\toffsetX: '.5rem',\n\t\t\t\tdelay: 250,\n\t\t\t\tdelayOut: 0,\n\t\t\t\thideOnClick: true,\n\t\t\t\tstyle: this._getStyles,\n\t\t\t},\n\t\t})\n\n\t\tconst updateIcon = () => {\n\t\t\tthis.folder.elements.toolbar.settingsButton?.classList.toggle(\n\t\t\t\t'open',\n\t\t\t\t!this.elements.settingsFolder.closed.value,\n\t\t\t)\n\t\t}\n\n\t\tbutton.addEventListener('click', () => {\n\t\t\tthis.elements.settingsFolder.toggle()\n\n\t\t\tupdateIcon()\n\n\t\t\tif (this.folder.closed) this.folder.open()\n\t\t})\n\n\t\treturn { button, updateIcon }\n\t}\n\n\tprivate _createPresetManager(settingsFolder: Folder): PresetManager {\n\t\tconst { presets, defaultPreset, storage } = this.opts\n\t\tlet localStorageKey: string | undefined\n\t\tif (typeof storage === 'object' && storage.presets) {\n\t\t\tlocalStorageKey = storage.key + '::presets'\n\t\t}\n\n\t\tlet closed = GUI_DEFAULTS.settingsFolder.presetsFolder.closed\n\n\t\tif (this.opts.settingsFolder?.presetsFolder?.closed) {\n\t\t\tclosed = this.opts.settingsFolder.presetsFolder.closed\n\t\t}\n\n\t\treturn new PresetManager(this, settingsFolder, {\n\t\t\tpresets,\n\t\t\tdefaultPreset,\n\t\t\tlocalStorageKey,\n\t\t\tfolderOptions: {\n\t\t\t\t...this.opts.settingsFolder?.presetsFolder,\n\t\t\t\tclosed,\n\t\t\t},\n\t\t})\n\t}\n\n\tprivate static _parseWidth(str?: string): number | undefined {\n\t\tif (!str) return\n\n\t\tif (!globalThis.window) {\n\t\t\tconsole.warn('parseCss can only be used in the browser')\n\t\t\treturn\n\t\t}\n\n\t\tconst dummy = document.createElement('div')\n\t\tdummy.style.width = str\n\t\tdocument.body.appendChild(dummy)\n\t\tconst width = dummy.getBoundingClientRect().width\n\t\tdummy.remove()\n\t\treturn width\n\t}\n\n\tprivate _createWindowManager(\n\t\toptions: Partial<GooeyOptions>,\n\t\tstorageOpts: typeof this.opts.storage,\n\t): WindowManager {\n\t\tif (this.windowManager) return this.windowManager // ??\n\n\t\tlet dragOpts = undefined as Partial<DraggableOptions> | undefined\n\t\tif (this.opts.draggable) {\n\t\t\tdragOpts = Object.assign({}, GUI_WINDOWMANAGER_DEFAULTS.draggable, {\n\t\t\t\thandle: this.folder.elements.header,\n\t\t\t\tposition: this.opts.position,\n\t\t\t\tlocalStorageKey: storageOpts && storageOpts.key ? storageOpts.key : undefined,\n\t\t\t\tbounds: this.container,\n\t\t\t} as DraggableOptions)\n\n\t\t\tif (storageOpts && storageOpts.position === false) {\n\t\t\t\tdragOpts.localStorageKey = undefined\n\t\t\t}\n\t\t}\n\n\t\tlet resizeOpts = undefined as Partial<ResizableOptions> | undefined\n\t\tif (this.opts.resizable) {\n\t\t\tresizeOpts = Object.assign({}, GUI_WINDOWMANAGER_DEFAULTS.resizable)\n\t\t\tresizeOpts.bounds = this.container\n\n\t\t\tresizeOpts.localStorageKey =\n\t\t\t\tstorageOpts && storageOpts.key ? storageOpts.key : undefined\n\t\t\tif (storageOpts && storageOpts.size === false) {\n\t\t\t\tresizeOpts.localStorageKey = undefined\n\t\t\t}\n\t\t}\n\n\t\tif (resizeOpts && this.opts.width) {\n\t\t\tresizeOpts.initialSize = { width: this.opts.width }\n\n\t\t\t// Update the min-width variable if the provided width is smaller than the default.\n\t\t\tconst currentMinWidth = Gooey._parseWidth(\n\t\t\t\tthis.wrapper.style.getPropertyValue('--gooey-root_min-width'),\n\t\t\t)\n\t\t\tif (currentMinWidth && this.opts.width < currentMinWidth) {\n\t\t\t\tthis.wrapper.style.setProperty('--gooey-root_min-width', `${this.opts.width}px`)\n\t\t\t}\n\n\t\t\tthis.folder.element.style.width = `${this.opts.width}px`\n\t\t}\n\n\t\t// Use the provided window manager if it's an instance.\n\t\tif ((options as GooeyOptionsInternal)?._windowManager instanceof WindowManager) {\n\t\t\tconst windowManager = (options as GooeyOptionsInternal)._windowManager!\n\n\t\t\twindowManager.add(this.folder.element, {\n\t\t\t\tid: this.id,\n\t\t\t\tresizable: resizeOpts,\n\t\t\t\tdraggable: dragOpts,\n\t\t\t})\n\n\t\t\treturn windowManager\n\t\t}\n\n\t\tconst windowManagerOpts = resolveOpts<WindowManagerOptions>(\n\t\t\t{\n\t\t\t\t...GUI_WINDOWMANAGER_DEFAULTS,\n\t\t\t\tdraggable: dragOpts,\n\t\t\t\tresizable: resizeOpts,\n\t\t\t},\n\t\t\tWINDOWMANAGER_DEFAULTS,\n\t\t)\n\n\t\tthis._log\n\t\t\t.fn('_createWindowManager')\n\t\t\t.debug({ windowManagerOpts, options, opts: this.opts, dragOpts, resizeOpts })\n\n\t\tconst windowManager = new WindowManager({\n\t\t\t...windowManagerOpts,\n\t\t\tdraggable: dragOpts,\n\t\t\tresizable: resizeOpts,\n\t\t})\n\t\tthis._isWindowManagerOwner = true\n\n\t\tconst { window } = windowManager.add(this.folder.element, {\n\t\t\t// The rest of the options will be inherited from the WindowManager instance.\n\t\t\tid: this.id,\n\t\t})\n\n\t\tthis.moveTo = window.moveTo\n\t\tthis.moveBy = window.moveBy\n\n\t\treturn windowManager\n\t}\n\n\tprivate _revealing: boolean = false\n\tprivate _repositionTimeout: ReturnType<typeof setTimeout> | undefined\n\trefreshPosition() {\n\t\tthis._log.fn('refreshPosition')\n\n\t\trequestAnimationFrame(() => {\n\t\t\tclearTimeout(this._repositionTimeout)\n\t\t\tthis._repositionTimeout = setTimeout(() => {\n\t\t\t\tthis._log.fn('refreshPosition').debug('Calling _updatePosition()')\n\t\t\t\tthis._updatePosition()\n\n\t\t\t\tif (this._revealing) {\n\t\t\t\t\tthis._revealing = false\n\t\t\t\t\t// Now that we're in position and inputs are loaded, we can animate-in.\n\t\t\t\t\tthis.wrapper.style.visibility = 'visible'\n\t\t\t\t\tthis.folder.element.animate([{ opacity: 0 }, { opacity: 1 }], {\n\t\t\t\t\t\tfill: 'none',\n\t\t\t\t\t\tduration: 150,\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}, 100)\n\t\t})\n\t}\n\n\t/**\n\t * Resolves and sets the position of the root Gooey {@link element}.\n\t * This function calculates the correct position based on the specified options,\n\t * container bounds, and storage settings. It then updates the position of the\n\t * draggable instance if necessary.d\n\t */\n\tprivate _updatePosition() {\n\t\tif (!this.container || !this.wrapper) return\n\n\t\tconst rect = this.element.getBoundingClientRect()\n\n\t\tif (typeof this.opts.position === 'string') {\n\t\t\tconst bounds = this.container.getBoundingClientRect()\n\t\t\tif (!bounds) {\n\t\t\t\tconsole.error('Invalid bounds:', this.opts.container)\n\t\t\t\tthrow new Error('Invalid container.')\n\t\t\t}\n\n\t\t\tconst placementPosition = place(rect, this.opts.position, {\n\t\t\t\tbounds,\n\t\t\t\tmargin: this.opts.margin,\n\t\t\t\toffset: this.opts.offset,\n\t\t\t})\n\n\t\t\tconst win = this.window\n\t\t\tif (win?.draggableInstance) {\n\t\t\t\twin.draggableInstance.position = placementPosition\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * todo - Add the public resolved vars to `Themer` and remove this.\n\t * @internal\n\t */\n\tprivate _getStyles = (): Record<string, string> => {\n\t\treturn {\n\t\t\t'--fg-a': this.wrapper?.style.getPropertyValue('--gooey-fg-a'),\n\t\t\t'--bg-a': this.wrapper?.style.getPropertyValue('--gooey-bg-a'),\n\t\t\t'--bg-b': this.wrapper?.style.getPropertyValue('--gooey-bg-b'),\n\t\t\t'--font-a': this.wrapper?.style.getPropertyValue('--gooey-font-family'),\n\t\t\t'--shadow-lightness': this.wrapper?.style.getPropertyValue('--gooey-shadow-lightness'),\n\t\t}\n\t}\n\n\tdispose = (): void => {\n\t\tthis._log.fn('dispose').debug(this)\n\t\tthis.themer?.dispose()\n\t\t// this.themeEditor?.dispose()\n\t\tif (this._isWindowManagerOwner) {\n\t\t\tthis.windowManager?.dispose()\n\t\t}\n\t\tthis.presetManager.folder.dispose()\n\t\tthis.elements.settingsFolder?.dispose()\n\t\tthis.folder?.dispose()\n\t}\n}\n"],"names":[],"mappings":"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"}