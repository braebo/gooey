{"version":3,"file":"place.js","sources":["../../../../src/shared/place.ts"],"sourcesContent":["import { select, type ElementOrSelector } from './select'\n\nexport type Placement = 'center' | `${TBC}-${LRC}` | `${LRC}-${TBC}`\n\ntype LeftRight = 'left' | 'right'\ntype LRC = LeftRight | 'center'\n\ntype TopBottom = 'top' | 'bottom'\ntype TBC = TopBottom | 'center'\n\ntype VirtualRect = Record<string, any> & {\n\tx: number\n\ty: number\n\twidth: number\n\theight: number\n}\n\nexport const PLACEMENTS = [\n\t'center',\n\t'center-center',\n\t'center-left',\n\t'center-right',\n\t'top-center',\n\t'top-left',\n\t'top-right',\n\t'bottom-center',\n\t'bottom-left',\n\t'bottom-right',\n\t'center-top',\n\t'center-bottom',\n\t'left-center',\n\t'left-top',\n\t'left-bottom',\n\t'right-center',\n\t'right-top',\n\t'right-bottom',\n] as const satisfies Placement[]\n\nexport type PlacementOptions = Parameters<typeof place>[2]\n\n/**\n * Determines the x and y position of an element relative to\n * a bounding box based on a given {@link Placement} string.\n * Optional {@link PlacementOptions} can be provided to specify\n * the bounding box and a margin.\n *\n * @param node - The element to place.\n * @param placement - The {@link Placement} string.\n * @param options - The {@link PlacementOptions}.\n * @param options.bounds - The bounding box to place the element within.\n * @param options.margin - The margin in pixels to apply to the placement.\n *\n * @example\n * ```ts\n * const { x, y } = place(node, 'top-right', { bounds: window, margin: 10 })\n * ```\n */\nexport function place(\n\tnode:\n\t\t| DOMRect\n\t\t| VirtualRect\n\t\t| (Record<string, any> & { width: number; height: number })\n\t\t| ElementOrSelector,\n\tplacement = 'top-right',\n\toptions?: {\n\t\t/**\n\t\t * The bounding box to place the element within.  Can be a\n\t\t * DOMRect, custom {@link VirtualRect}, or `'window'`.\n\t\t * @default 'window'\n\t\t */\n\t\tbounds?: DOMRect | VirtualRect | 'window' | ElementOrSelector\n\t\t/**\n\t\t * The margin in pixels to apply to the placement.  Can be a number\n\t\t * to apply the same margin to both x and y, or an object with x\n\t\t * and y properties to apply different margins to each axis.\n\t\t * @default 0\n\t\t */\n\t\tmargin?: number | Partial<{ x: number; y: number }>\n\t},\n): { x: number; y: number } {\n\tconst { bounds, margin } = Object.assign(\n\t\t{\n\t\t\tbounds: undefined as VirtualRect | undefined,\n\t\t\tmargin: 10 as number | Partial<{ x: number; y: number }>,\n\t\t},\n\t\toptions,\n\t)\n\n\tconst rect =\n\t\ttypeof node === 'string'\n\t\t\t? select(node)[0]?.getBoundingClientRect()\n\t\t\t: node instanceof Element\n\t\t\t\t? node.getBoundingClientRect()\n\t\t\t\t: node\n\n\tif (!rect) throw new Error('Invalid node: ' + node)\n\n\tconst b =\n\t\tbounds === 'window' && typeof window !== 'undefined'\n\t\t\t? { x: 0, y: 0, width: window.innerWidth, height: window.innerHeight }\n\t\t\t: typeof bounds === 'string'\n\t\t\t\t? select(bounds)[0]?.getBoundingClientRect()\n\t\t\t\t: (bounds ?? { x: 0, y: 0, width: 100, height: 100 })\n\n\tif (!b) throw new Error('Invalid bounds: ' + bounds)\n\n\tconst m: { x: number; y: number } =\n\t\ttypeof margin === 'number'\n\t\t\t? { x: margin, y: margin }\n\t\t\t: Object.assign({ x: 0, y: 0 }, margin)\n\n\t// prettier-ignore\n\tswitch (placement) {\n\t\tcase ('center'):\n\t\tcase ('center-center'): return { x: b.width / 2 - rect.width / 2, y: b.height / 2 - rect.height / 2 }\n\t\tcase ('top-left'):\n\t\tcase ('left-top'): return { x: m.x, y: m.y }\n\t\tcase ('top-center'):\n\t\tcase ('center-top'): return { x: b.width / 2 - rect.width / 2, y: m.y }\n\t\tcase ('top-right'):\n\t\tcase ('right-top'): return { x: b.width - rect.width - m.x, y: m.y }\n\t\tcase ('bottom-left'):\n\t\tcase ('left-bottom'): return { x: m.x, y: b.height - rect.height - m.y }\n\t\tcase ('bottom-center'):\n\t\tcase ('center-bottom'): return { x: b.width / 2 - rect.width / 2, y: b.height - rect.height - m.y }\n\t\tcase ('bottom-right'):\n\t\tcase ('right-bottom'): return { x: b.width - rect.width - m.x, y: b.height - rect.height - m.y }\n\t\tcase ('left-center'):\n\t\tcase ('center-left'): return { x: m.x, y: b.height / 2 - rect.height / 2 }\n\t\tcase ('right-center'):\n\t\tcase ('center-right'): return { x: b.width - rect.width - m.x, y: b.height / 2 - rect.height / 2 }\n\t\tdefault: throw new Error('Invalid placement: ' + placement)\n\t}\n}\n"],"names":[],"mappings":"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"}