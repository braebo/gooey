{"version":3,"file":"CopyButton.js","sources":["../../../../src/shared/CopyButton.ts"],"sourcesContent":["import { Tooltip } from '../shared/Tooltip'\nimport { create } from '../shared/create'\nimport { append } from '../shared/mount'\nimport { CopySVG } from '../svg/CopySVG'\n\nexport class CopyButton {\n\tbutton: HTMLDivElement\n\ticon: CopySVG\n\t/**\n\t * When the copy animation is active, this is `true` and the button has an `active` class.\n\t */\n\tactive = false\n\t/**\n\t * When the copy animation is outroing, this is `true` and the button has an `outro` class.\n\t */\n\toutro = false\n\n\t#completeTimeout!: ReturnType<typeof setTimeout>\n\n\ttooltip: Tooltip\n\n\tconstructor(\n\t\tpublic container: HTMLElement,\n\t\tpublic text: () => string,\n\t\tpublic message = 'Copy',\n\t) {\n\t\tconst button = create('div', {\n\t\t\tclasses: ['copy-button'],\n\t\t\ttitle: 'Copy',\n\t\t\tattributes: {\n\t\t\t\t'aria-label': 'Copy',\n\t\t\t\ttitle: 'Copy',\n\t\t\t},\n\t\t})\n\n\t\tconst svgContainer = create('div', {\n\t\t\tclasses: ['copy-button-svg-container'],\n\t\t})\n\n\t\tthis.button = button\n\t\tthis.icon = new CopySVG()\n\n\t\tthis.button.addEventListener('click', this.copy)\n\n\t\tappend(container, this.button, svgContainer, this.icon.svg)\n\n\t\tthis.tooltip = new Tooltip(this.button, {\n\t\t\ttext: message,\n\t\t\tplacement: 'top',\n\t\t\toffsetY: '6px',\n\t\t\tdelay: 600,\n\t\t})\n\t}\n\n\tcopy = () => {\n\t\tif (typeof navigator === 'undefined') return\n\t\tif (this.active) return\n\n\t\tlet text = this.text()\n\n\t\tif (!text) return\n\n\t\tif (typeof text === 'object') text = JSON.stringify(text)\n\n\t\tnavigator.clipboard?.writeText?.(text)\n\t\tclearTimeout(this.#completeTimeout)\n\n\t\tthis.#animateIn()\n\t}\n\n\t#animateIn = () => {\n\t\tthis.active = true\n\n\t\tthis.tooltip.show()\n\t\tthis.button.blur()\n\n\t\tthis.button.classList.add('active')\n\t\tthis.icon.svg.classList.add('active')\n\n\t\tthis.icon.front.setAttribute('x', '5.5')\n\t\tthis.icon.front.setAttribute('y', '5.5')\n\t\tthis.icon.front.setAttribute('rx', '10')\n\t\tthis.icon.front.setAttribute('ry', '10')\n\n\t\tthis.tooltip.text = 'Copied!'\n\n\t\tsetTimeout(this.#animateOut, 1250)\n\t}\n\n\t#animateOut = () => {\n\t\tthis.active = false\n\t\tthis.outro = true\n\n\t\tthis.button.classList.remove('active')\n\t\tthis.icon.svg.classList.remove('active')\n\t\tthis.icon.svg.classList.add('outro')\n\t\tthis.button.classList.add('outro')\n\n\t\tthis.icon.front.setAttribute('x', '8')\n\t\tthis.icon.front.setAttribute('y', '8')\n\t\tthis.icon.front.setAttribute('rx', '1')\n\t\tthis.icon.front.setAttribute('ry', '1')\n\n\t\t// setTimeout(this.#complete, 500)\n\t\tsetTimeout(this.#complete, 900)\n\t}\n\n\t#complete = () => {\n\t\tthis.button.classList.remove('outro')\n\t\tthis.icon.svg.classList.remove('outro')\n\t\tthis.outro = false\n\n\t\tthis.tooltip.hide()\n\t\tclearTimeout(this.#completeTimeout)\n\t\tthis.#completeTimeout = setTimeout(() => {\n\t\t\tthis.tooltip.text = this.message\n\t\t}, 300)\n\t}\n}\n"],"names":[],"mappings":"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"}