{"version":3,"file":"ua.js","sources":["../../../../src/shared/ua.ts"],"sourcesContent":["/**\n * Detects the current operating system.  On the server, the request object must be provided.\n * @param request - The request object. If not provided, the global `navigator` object is used.\n * @returns The operating system.  Note: `ipados` is separate from `ios`.\n */\nexport function getOS(\n\trequest?: Request,\n): 'mac' | 'windows' | 'linux' | 'android' | 'ios' | 'ipados' {\n\tif (isIOS(request)) return 'ios'\n\tif (isIPad(request)) return 'ipados'\n\tif (isAndroid(request)) return 'android'\n\tif (isMac(request)) return 'mac'\n\tif (isWindows(request)) return 'windows'\n\tif (isLinux(request)) return 'linux'\n\tthrow new Error('Unknown platform')\n}\n\n/**\n * Detects the current browser.\n */\nexport function getBrowser(request?: Request): 'chrome' | 'firefox' | 'safari' | 'other' {\n\tif (isChrome(request) || isEdge(request)) return 'chrome'\n\tif (isFirefox(request)) return 'firefox'\n\tif (isSafari(request)) return 'safari'\n\treturn 'other'\n}\n\n/**\n * Resolves the user agent string.  On the server, the request object must be provided.\n * @param request - The request object. If not provided, the global `navigator` object is returned.\n */\nexport function getUserAgent(request?: Request) {\n\tif (typeof globalThis.navigator === 'undefined' && !request) {\n\t\tconsole.error(\n\t\t\t'Error getting user-agent: Request object is required on the server, but was not provided.',\n\t\t)\n\t}\n\n\treturn request?.headers.get('user-agent') || globalThis.navigator?.userAgent\n}\n\n/**\n * Detects if the current browser matches the provided platform.\n */\nexport function isPlatform(platform: RegExp, request?: Request) {\n\tconst ua = getUserAgent(request)\n\treturn !!ua?.match(platform)\n}\n\n/**\n * Detects if the current browser is a webview. The request parameter is required on the server.\n * @param request - The request object. If not provided, the global `navigator` object is used.\n */\nexport function isWebview(request?: Request) {\n\treturn !!getUserAgent(request).match(/webview|wv|ip((?!.*Safari)|(?=.*like Safari))/i)\n}\n\n/**\n * `true` if the current browser is running on a desktop.\n */\nexport function isDesktop(request?: Request) {\n\treturn !isMobile(request)\n}\n\n/**\n * `true` if the current browser is running on MacOS.\n */\nexport function isMac(request?: Request) {\n\treturn isPlatform(/mac/i, request) && !isMobile(request)\n}\n\n/**\n * `true` if the current browser is running on MacOS.\n */\nexport function isApple(request?: Request) {\n\treturn (\n\t\tisMac(request) || isIOS(request) || isIPad(request) || isIPadOS(request) || isIPad(request)\n\t)\n}\n\n/**\n * `true` if the current browser is running on Windows.\n */\nexport function isWindows(request?: Request) {\n\treturn isPlatform(/win/i, request)\n}\n\n/**\n * `true` if the current browser is running on Linux.\n */\nexport function isLinux(request?: Request) {\n\treturn isPlatform(/linux/i, request)\n}\n\n/**\n * `true` when running in a browser.\n */\nexport function isBrowser() {\n\treturn typeof window !== 'undefined'\n}\n\n/**\n * `true` when running in a server environment.\n */\nexport function isServer() {\n\treturn typeof window === 'undefined'\n}\n\n/**\n * `true` if the current browser is running on a mobile device.\n */\nexport function isMobile(request?: Request) {\n\treturn isAndroid(request) || isIOS(request) || isIPad(request)\n}\n\n/**\n * `true` if the current browser is running on iOS.\n */\nexport function isIOS(request?: Request) {\n\treturn isPlatform(/iphone/i, request)\n}\n\n/**\n * `true` if the current browser is running on iPadOS.\n */\nexport function isIPadOS(request?: Request) {\n\treturn isIPad(request)\n}\n\n/**\n * `true` if the current browser is running on an iPad.\n */\nexport function isIPad(request?: Request) {\n\t// return isSafari(request) && !isIOS(request)\n\treturn isPlatform(/ipad/i, request)\n}\n\n/**\n * `true` if the current browser is running on Android.\n */\nexport function isAndroid(request?: Request) {\n\treturn isPlatform(/android/i, request)\n}\n\n/**\n * `true` if the current browser is running on Safari.\n */\nexport function isSafari(request?: Request) {\n\treturn isPlatform(/^((?!chrome|android).)*safari/i, request)\n}\n\n/**\n * `true` if the current browser is Chrome.\n */\nexport function isChrome(request?: Request) {\n\treturn isPlatform(/chrome/i, request)\n}\n\n/**\n * `true` if the current browser is Firefox.\n */\nexport function isFirefox(request?: Request) {\n\treturn isPlatform(/firefox/i, request)\n}\n\n/**\n * `true` if the current browser is Edge.\n */\nexport function isEdge(request?: Request) {\n\treturn isPlatform(/edg/i, request)\n}\n"],"names":[],"mappings":"AAAA;;;;AAIG;AAuBH;;;AAGG;AACG,SAAU,YAAY,CAAC,OAAiB,EAAA;IAC7C,IAAI,OAAO,UAAU,CAAC,SAAS,KAAK,WAAW,IAAI,CAAC,OAAO,EAAE;AAC5D,QAAA,OAAO,CAAC,KAAK,CACZ,2FAA2F,CAC3F,CAAA;KACD;AAED,IAAA,OAA6C,UAAU,CAAC,SAAS,EAAE,SAAS,CAAA;AAC7E,CAAC;AAED;;AAEG;AACa,SAAA,UAAU,CAAC,QAAgB,EAAE,OAAiB,EAAA;AAC7D,IAAA,MAAM,EAAE,GAAG,YAAY,CAAC,OAAO,CAAC,CAAA;IAChC,OAAO,CAAC,CAAC,EAAE,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAA;AAC7B,CAAC;AAiBD;;AAEG;AACG,SAAU,KAAK,CAAC,OAAiB,EAAA;AACtC,IAAA,OAAO,UAAU,CAAC,MAAM,EAAE,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAA;AACzD,CAAC;AAED;;AAEG;AACG,SAAU,OAAO,CAAC,OAAiB,EAAA;IACxC,QACC,KAAK,CAAC,OAAO,CAAC,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,IAAI,QAAQ,CAAC,OAAO,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,EAC3F;AACF,CAAC;AA8BD;;AAEG;AACG,SAAU,QAAQ,CAAC,OAAiB,EAAA;AACzC,IAAA,OAAO,SAAS,CAAC,OAAO,CAAC,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,CAAA;AAC/D,CAAC;AAED;;AAEG;AACG,SAAU,KAAK,CAAC,OAAiB,EAAA;AACtC,IAAA,OAAO,UAAU,CAAC,SAAS,EAAE,OAAO,CAAC,CAAA;AACtC,CAAC;AAED;;AAEG;AACG,SAAU,QAAQ,CAAC,OAAiB,EAAA;AACzC,IAAA,OAAO,MAAM,CAAC,OAAO,CAAC,CAAA;AACvB,CAAC;AAED;;AAEG;AACG,SAAU,MAAM,CAAC,OAAiB,EAAA;;AAEvC,IAAA,OAAO,UAAU,CAAC,OAAO,EAAE,OAAO,CAAC,CAAA;AACpC,CAAC;AAED;;AAEG;AACG,SAAU,SAAS,CAAC,OAAiB,EAAA;AAC1C,IAAA,OAAO,UAAU,CAAC,UAAU,EAAE,OAAO,CAAC,CAAA;AACvC,CAAC;AAED;;AAEG;AACG,SAAU,QAAQ,CAAC,OAAiB,EAAA;AACzC,IAAA,OAAO,UAAU,CAAC,gCAAgC,EAAE,OAAO,CAAC,CAAA;AAC7D;;;;"}