{"version":3,"file":"Tooltip.js","sources":["../../../../src/shared/Tooltip.ts"],"sourcesContent":["import type { JavascriptStyleProperty } from './css-types'\nimport type { ElementOrSelector } from './select'\n\nimport { deepMergeOpts } from './deepMergeOpts'\nimport { EventManager } from './EventManager'\nimport { styled } from './decorators/styled'\nimport { entries } from './object'\nimport { create } from './create'\nimport { toFn } from './toFn'\nimport { DEV } from 'esm-env'\n\ntype Selector = `#${string}` | `.${string}`\ntype Anchor = Element | Selector | 'mouse' | 'node' | null\ntype Anchors = { x: Anchor; y: Anchor }\ntype AnchorRect = DOMRect | { left: number; top: number; width: number; height: number }\n\n/**\n * Options for the tooltip.\n */\nexport interface TooltipOptions {\n\treadonly __type?: 'TooltipOptions'\n\n\t/**\n\t * The text to display in the tooltip.  Can be a string, number, or a function that returns a string or number.\n\t */\n\ttext: string | (() => string)\n\n\t/**\n\t * The placement of the tooltip relative to the element.  Can be `'top'`, `'bottom'`, `'left'`, or `'right'`.\n\t */\n\tplacement: 'top' | 'bottom' | 'left' | 'right'\n\n\t/**\n\t * The element to which the tooltip is placed relative to.  Can be a selector,\n\t * an element, or the string literal `'mouse'` to use the pointer position.\n\t *\n\t * Can also be an object with unique `x` and `y` anchors for each axis.\n\t *\n\t * By default, the node that the tooltip is attached to will be used as the anchor.\n\t *\n\t * @example { x: 'mouse', y: undefined }\n\t */\n\tanchor: Anchor | Anchors\n\n\t/**\n\t * Delay in milliseconds before the tooltip is shown.\n\t * @defaultValue 250\n\t */\n\tdelay: number\n\n\t/**\n\t * Delay in milliseconds before the tooltip is hidden.\n\t * @defaultValue 0\n\t */\n\tdelayOut: number\n\n\t/**\n\t * An optional x-axis offset (any valid css unit).\n\t * @defaultValue '0%'\n\t */\n\toffsetX: string\n\n\t/**\n\t * An optional y-axis offset (any valid css unit).\n\t * @defaultValue '0%'\n\t */\n\toffsetY: string\n\n\t/**\n\t * Animation in/out duration times / easing.\n\t */\n\tanimation: {\n\t\t/**\n\t\t * The tooltip reveal animation duration in ms.\n\t\t * @defaultValue 300\n\t\t */\n\t\tduration: KeyframeAnimationOptions['duration']\n\t\t/**\n\t\t * The tooltip hide animation duration in ms.\n\t\t * @defaultValue 150\n\t\t */\n\t\tdurationOut: KeyframeAnimationOptions['duration']\n\t\t/**\n\t\t * The tooltip reveal and hide animation easing.\n\t\t * @defaultValue 'cubic-bezier(0.23, 1, 0.320, 1)'\n\t\t */\n\t\teasing: KeyframeAnimationOptions['easing']\n\t}\n\n\t/**\n\t * Custom style overrides for the tooltip element (all valid CSS properties are allowed).\n\t * i.e. { padding: '4px 8px', color: 'var(--fg-a, #fff)' }\n\t * @defaultValue undefined\n\t */\n\tstyle?: Partial<Record<JavascriptStyleProperty, string>>\n\n\t/**\n\t * If specified, the container element for the tooltip.\n\t * @defaultValue document.body\n\t */\n\tparent?: HTMLElement\n\n\t/**\n\t * Hides the tooltip on click if `true`.\n\t * @defaultValue false\n\t */\n\thideOnClick: boolean\n}\n\nexport const TOOLTIP_DEFAULTS: TooltipOptions = {\n\t__type: 'TooltipOptions' as const,\n\ttext: '',\n\tplacement: 'top',\n\tanchor: 'node',\n\tdelay: 250,\n\tdelayOut: 0,\n\toffsetX: '0%',\n\toffsetY: '0%',\n\tanimation: {\n\t\tduration: 300,\n\t\tdurationOut: 150,\n\t\teasing: 'cubic-bezier(0.23, 1, 0.320, 1)',\n\t},\n\tstyle: undefined,\n\thideOnClick: false,\n}\n\n@styled\nexport class Tooltip {\n\treadonly __type = 'Tooltip' as const\n\n\t/**\n\t * The tooltip element itself.\n\t */\n\telement: HTMLDivElement | undefined | null\n\n\t/**\n\t * The parent element of the tooltip.\n\t */\n\tparent: HTMLElement | undefined | null\n\n\t/**\n\t * Whether the tooltip is currently showing.\n\t */\n\tshowing = false\n\n\topts: TooltipOptions\n\n\tprivate _text: () => string\n\tprivate _evm = new EventManager()\n\tprivate _animPositions!: { from: string; to: string }\n\tprivate _delayInTimer!: ReturnType<typeof setTimeout>\n\tprivate _delayOutTimer!: ReturnType<typeof setTimeout>\n\n\tconstructor(\n\t\t/**\n\t\t * The node that the tooltip is attached to.\n\t\t */\n\t\tpublic node: HTMLElement | undefined | null,\n\t\toptions?: Partial<TooltipOptions>,\n\t) {\n\t\tconst opts = deepMergeOpts([TOOLTIP_DEFAULTS, options])\n\t\tthis.opts = opts\n\n\t\tthis.placement = opts.placement\n\n\t\tthis._text = toFn(opts.text)\n\n\t\tthis.parent = options?.parent ?? document.getElementById('svelte') ?? document.body\n\n\t\tthis.element = create('div', {\n\t\t\tclasses: ['fractils-tooltip'],\n\t\t\tinnerHTML: String(this._text()),\n\t\t\tstyle: options?.style,\n\t\t})\n\n\t\tif (opts.style) {\n\t\t\tfor (const [key, value] of entries(opts.style)) {\n\t\t\t\tif (key && value) {\n\t\t\t\t\tthis.element?.style.setProperty(key, value)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._evm.listen(node!, 'pointerenter', this.show)\n\t\tthis._evm.listen(node!, 'pointerleave', this.hide)\n\t\tthis._evm.listen(node!, 'pointermove', this._updatePosition)\n\t\tthis._evm.listen(node!, 'click', () => {\n\t\t\tif (opts.hideOnClick) this.hide()\n\t\t\telse this.refresh()\n\t\t})\n\t}\n\n\trefresh() {\n\t\tif (!this.element) return\n\t\tthis.element.innerHTML = String(this.text)\n\t\tsetTimeout(() => this._updatePosition(), 0)\n\t\tthis._maybeWatchAnchor()\n\t\tclearTimeout(this._delayInTimer)\n\t\tclearTimeout(this._delayOutTimer)\n\t}\n\n\t/**\n\t * The text to display in the tooltip.  Assigning a new value will update the tooltip text.\n\t */\n\tget text() {\n\t\treturn this._text()\n\t}\n\tset text(text: string | (() => string)) {\n\t\tthis._text = toFn(text)\n\t\tif (!this.element) return\n\t\tthis.element.innerHTML = String(this._text())\n\t}\n\n\tget placement() {\n\t\treturn this.opts.placement\n\t}\n\tset placement(v) {\n\t\tthis.opts.placement = v\n\t\tswitch (v) {\n\t\t\tcase 'top':\n\t\t\t\tthis._animPositions = { from: 'translateY(4px)', to: 'translateY(0)' }\n\t\t\t\tbreak\n\t\t\tcase 'bottom':\n\t\t\t\tthis._animPositions = { from: 'translateY(-4px)', to: 'translateY(0)' }\n\t\t\t\tbreak\n\t\t\tcase 'left':\n\t\t\t\tthis._animPositions = { from: 'translateX(4px)', to: 'translateX(0)' }\n\t\t\t\tbreak\n\t\t\tcase 'right':\n\t\t\t\tthis._animPositions = { from: 'translateX(-4px)', to: 'translateX(0)' }\n\t\t}\n\t}\n\n\tget offsetX() {\n\t\treturn this.opts.offsetX!\n\t}\n\tset offsetX(v) {\n\t\tthis.opts.offsetX = v\n\t\tthis._updatePosition()\n\t}\n\n\tget offsetY() {\n\t\treturn this.opts.offsetY!\n\t}\n\tset offsetY(v) {\n\t\tthis.opts.offsetY = v\n\t\tthis._updatePosition()\n\t}\n\n\t/**\n\t * Animates the tooltip into view.\n\t */\n\tshow = () => {\n\t\tif (this.showing) return\n\t\tif (!this.text) return\n\n\t\tclearTimeout(this._delayInTimer)\n\t\tclearTimeout(this._delayOutTimer)\n\n\t\tthis._delayInTimer = setTimeout(async () => {\n\t\t\tif (this.element) this.parent?.appendChild(this.element)\n\t\t\tthis.showing = true\n\n\t\t\tthis.element?.animate(\n\t\t\t\t[\n\t\t\t\t\t{ opacity: '0', transform: this._animPositions.from },\n\t\t\t\t\t{ opacity: '1', transform: this._animPositions.to },\n\t\t\t\t],\n\t\t\t\t{\n\t\t\t\t\tduration: this.opts.animation!.duration,\n\t\t\t\t\teasing: this.opts.animation!.easing,\n\t\t\t\t\tfill: 'forwards',\n\t\t\t\t},\n\t\t\t)\n\n\t\t\tthis._updatePosition()\n\t\t\tthis._maybeWatchAnchor()\n\t\t}, this.opts.delay)\n\t}\n\n\t/**\n\t * Animates the tooltip out of view.\n\t */\n\thide = () => {\n\t\tclearTimeout(this._delayInTimer)\n\t\tclearTimeout(this._delayOutTimer)\n\n\t\tthis._delayOutTimer = setTimeout(async () => {\n\t\t\tif (this.showing) {\n\t\t\t\tthis.showing = false\n\n\t\t\t\tif (this._watcherId) {\n\t\t\t\t\tthis._evm.unlisten(this._watcherId)\n\t\t\t\t}\n\n\t\t\t\tawait this.element?.animate(\n\t\t\t\t\t[\n\t\t\t\t\t\t{ opacity: '1', transform: this._animPositions.to },\n\t\t\t\t\t\t{ opacity: '0', transform: this._animPositions.from },\n\t\t\t\t\t],\n\t\t\t\t\t{\n\t\t\t\t\t\tduration: this.opts.animation!.durationOut,\n\t\t\t\t\t\teasing: this.opts.animation!.easing,\n\t\t\t\t\t\tfill: 'forwards',\n\t\t\t\t\t},\n\t\t\t\t).finished\n\n\t\t\t\tthis.unmount()\n\t\t\t}\n\t\t}, this.opts.delayOut)\n\t}\n\n\t/**\n\t * Whether the tooltip is currently mounted to the DOM.\n\t * @internal\n\t */\n\tprivate _mounted = false\n\tmount() {\n\t\tif (this._mounted) return\n\t\tthis._mounted = true\n\t\tif (this.element) this.parent?.appendChild(this.element)\n\t}\n\tunmount() {\n\t\tif (!this._mounted) return\n\t\tthis._mounted = false\n\t\tif (this.element) this.parent?.removeChild(this.element)\n\t}\n\n\tprivate _updatePosition = (e?: PointerEvent) => {\n\t\tif (!this.element) return\n\n\t\tconst tooltipRect = this.element.getBoundingClientRect()\n\n\t\tif (this.element.innerHTML !== this.text) {\n\t\t\tthis.element.innerHTML = String(this.text)\n\t\t}\n\n\t\tif (e?.type === 'pointermove') {\n\t\t\tthis._mouse = {\n\t\t\t\tx: e.clientX,\n\t\t\t\ty: e.clientY,\n\t\t\t}\n\t\t}\n\n\t\t// todo - can we safely \"cache\" the anchor?\n\t\tconst anchor = this._getAnchorRects()\n\t\tif (!anchor) return\n\n\t\tlet left = 0\n\t\tlet top = 0\n\n\t\tconst baseOffset = 4\n\n\t\tthis.element.classList.add('fractils-tooltip-' + this.placement)\n\n\t\tswitch (this.placement) {\n\t\t\tcase 'top':\n\t\t\t\tleft = anchor.x.left + window.scrollX + anchor.x.width / 2 - tooltipRect.width / 2\n\t\t\t\ttop = anchor.y.top + window.scrollY - tooltipRect.height - baseOffset\n\t\t\t\tbreak\n\t\t\tcase 'bottom':\n\t\t\t\tleft = anchor.x.left + window.scrollX + anchor.x.width / 2 - tooltipRect.width / 2\n\t\t\t\ttop = anchor.y.top + window.scrollY + anchor.y.height + baseOffset\n\t\t\t\tbreak\n\t\t\tcase 'left':\n\t\t\t\tleft = anchor.x.left + window.scrollX - tooltipRect.width - baseOffset\n\t\t\t\ttop = anchor.y.top + window.scrollY + anchor.y.height / 2 - tooltipRect.height / 2\n\t\t\t\tbreak\n\t\t\tcase 'right':\n\t\t\t\tleft = anchor.x.left + window.scrollX + anchor.x.width + baseOffset\n\t\t\t\ttop = anchor.y.top + window.scrollY + anchor.y.height / 2 - tooltipRect.height / 2\n\t\t\t\tbreak\n\t\t}\n\n\t\tconst parentRect = this.parent?.getBoundingClientRect()\n\t\tif (!parentRect) return\n\n\t\tthis.element.style.left = `calc(${left - parentRect.left}px + ${this.opts.offsetX!})`\n\t\tthis.element.style.top = `calc(${top - parentRect.top}px + ${this.opts.offsetY!})`\n\t}\n\n\t// todo - mobile touch events support?\n\tprivate _mouse = { x: 0, y: 0 }\n\n\tprivate _getAnchorRects():\n\t\t| {\n\t\t\t\tx: AnchorRect\n\t\t\t\ty: AnchorRect\n\t\t  }\n\t\t| undefined {\n\t\tconst getRect = <Alt extends string = never>(\n\t\t\tanchor: TooltipOptions['anchor'],\n\t\t): AnchorRect | Alt | undefined => {\n\t\t\tif (!anchor) return this.node?.getBoundingClientRect()\n\n\t\t\tswitch (typeof anchor) {\n\t\t\t\tcase 'string': {\n\t\t\t\t\tswitch (anchor) {\n\t\t\t\t\t\tcase 'node': {\n\t\t\t\t\t\t\treturn this.node?.getBoundingClientRect()\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase 'mouse': {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tleft: this._mouse.x + window.scrollX,\n\t\t\t\t\t\t\t\ttop: this._mouse.y + window.scrollY,\n\t\t\t\t\t\t\t\twidth: 0,\n\t\t\t\t\t\t\t\theight: 0,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdefault: {\n\t\t\t\t\t\t\tconst el = document.querySelector(anchor)\n\n\t\t\t\t\t\t\tif (el) {\n\t\t\t\t\t\t\t\treturn el.getBoundingClientRect()\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (DEV) console.warn('Tooltip anchor not found:', anchor)\n\t\t\t\t\t\t\t\treturn this.node?.getBoundingClientRect()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcase 'object': {\n\t\t\t\t\t// Unique x and y anchors.\n\t\t\t\t\tif (anchor && 'x' in anchor && 'y' in anchor) {\n\t\t\t\t\t\treturn 'separate' as Alt\n\t\t\t\t\t} else if (anchor instanceof HTMLElement) {\n\t\t\t\t\t\treturn anchor.getBoundingClientRect()\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (DEV) console.warn('Invalid tooltip anchor:', anchor)\n\t\t\t\t\t\treturn this.node?.getBoundingClientRect()\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdefault: {\n\t\t\t\t\tif (DEV) console.warn('Invalid tooltip anchor:', anchor)\n\t\t\t\t\treturn this.node?.getBoundingClientRect()\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst rect = getRect<'separate'>(this.opts.anchor)\n\n\t\tif (rect === 'separate') {\n\t\t\tconst x = getRect((this.opts.anchor as Anchors).x)\n\t\t\tconst y = getRect((this.opts.anchor as Anchors).y)\n\n\t\t\tif (!x || !y) return undefined\n\n\t\t\treturn { x, y }\n\t\t}\n\n\t\tif (!rect) return undefined\n\t\treturn { x: rect, y: rect }\n\t}\n\n\tprivate _watcherId?: string\n\n\t/**\n\t * Determines if the tooltip should watch any anchors for movement.\n\t */\n\tprivate _maybeWatchAnchor() {\n\t\tconst maybeWatch = (el: ElementOrSelector | null) => {\n\t\t\tif (!el) return\n\n\t\t\tconst anchor =\n\t\t\t\tel instanceof HTMLElement\n\t\t\t\t\t? el\n\t\t\t\t\t: this.node?.querySelector(el) ?? document.querySelector(el)\n\n\t\t\tconst watchAnchor = () => {\n\t\t\t\tif (anchor) {\n\t\t\t\t\tthis._watch(anchor as HTMLElement)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (anchor) {\n\t\t\t\tif (this._watcherId) {\n\t\t\t\t\tthis._evm.unlisten(this._watcherId)\n\t\t\t\t}\n\n\t\t\t\tthis._watcherId = this._evm.listen(\n\t\t\t\t\tanchor,\n\t\t\t\t\t'transitionrun',\n\t\t\t\t\twatchAnchor,\n\t\t\t\t\t{},\n\t\t\t\t\t'anchor',\n\t\t\t\t)\n\t\t\t}\n\t\t}\n\n\t\tconst getAnchor = (anchor: Anchor) => {\n\t\t\tif (anchor instanceof HTMLElement) {\n\t\t\t\treturn anchor as HTMLElement\n\t\t\t} else if (typeof anchor === 'string') {\n\t\t\t\treturn anchor === 'node' ? this.node : anchor === 'mouse' ? null : anchor\n\t\t\t}\n\t\t\treturn null\n\t\t}\n\n\t\tif (\n\t\t\tthis.opts.anchor &&\n\t\t\ttypeof this.opts.anchor === 'object' &&\n\t\t\t'x' in this.opts.anchor &&\n\t\t\t'y' in this.opts.anchor\n\t\t) {\n\t\t\tconst anchorX = getAnchor(this.opts.anchor.x)\n\t\t\tconst anchorY = getAnchor(this.opts.anchor.y)\n\n\t\t\tif (anchorX === anchorY) {\n\t\t\t\tmaybeWatch(anchorX)\n\t\t\t} else {\n\t\t\t\tmaybeWatch(anchorX)\n\t\t\t\tmaybeWatch(anchorY)\n\t\t\t}\n\t\t} else {\n\t\t\tmaybeWatch(getAnchor(this.opts.anchor))\n\t\t}\n\t}\n\n\tprivate _watchingAnchor = false\n\tprivate _watchingFinished = false\n\tprivate _watchTimeout: ReturnType<typeof setTimeout> | undefined = undefined\n\t/**\n\t * Keeps the tooltip position in sync with the anchor when an anchor's\n\t * transform is in transition while the tooltip is showing.\n\t * @todo - watch animation events too?\n\t */\n\tprivate _watch(el: HTMLElement) {\n\t\tif (this._watchingAnchor) {\n\t\t\treturn\n\t\t}\n\t\tthis._watchingFinished = false\n\t\tthis._watchingAnchor = true\n\n\t\tconst complete = () => {\n\t\t\tthis._watchingFinished = true\n\t\t\tthis._watchingAnchor = false\n\t\t\tthis.element?.style.setProperty('transition-duration', '0.1s')\n\t\t\tif (timeout) el.removeEventListener('transitionend', timeout)\n\t\t}\n\n\t\tconst timeout = () => {\n\t\t\tif (this._watchingFinished) return\n\t\t\tcomplete()\n\t\t}\n\n\t\tif (!this.showing) {\n\t\t\tcomplete()\n\t\t\treturn\n\t\t}\n\n\t\tclearTimeout(this._watchTimeout)\n\t\tthis._watchTimeout = setTimeout(() => {\n\t\t\tif (!this._watchingFinished) {\n\t\t\t\tcomplete()\n\t\t\t}\n\t\t}, 500)\n\n\t\tel.removeEventListener('transitionend', timeout)\n\t\tel.addEventListener('transitionend', timeout)\n\n\t\tif (!this._watchingFinished) {\n\t\t\tthis.node?.style.setProperty('transition-duration', '0s')\n\n\t\t\ttickLoop(() => {\n\t\t\t\tif (!this._watchingFinished) {\n\t\t\t\t\tthis._updatePosition()\n\t\t\t\t\treturn false\n\t\t\t\t} else {\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n\n\tdispose() {\n\t\tclearTimeout(this._watchTimeout)\n\n\t\tthis._evm.dispose()\n\t\tthis.element?.remove()\n\t}\n\n\tstatic style = /*css*/ `\n\t\t.fractils-tooltip {\n\t\t\tposition: absolute;\n\n\t\t\tmin-width: 3rem;\n\t\t\tmax-width: auto;\n\t\t\tmin-height: auto;\n\t\t\tmax-height: auto;\n\t\t\tpadding: 4px 8px;\n\n\t\t\topacity: 0;\n\t\t\tcolor: var(--fg-a, #fff);\n\t\t\tbackground-color: var(--bg-a, #000);\n\t\t\tborder-radius: var(--radius-sm, 4px);\n\t\t\tbox-shadow: var(--shadow, 0rem 0.0313rem 0.0469rem hsl(var(--shadow-color) / 0.02),\n\t\t\t\t0rem 0.125rem 0.0938rem hsl(var(--shadow-color) / 0.02),\n\t\t\t\t0rem 0.1563rem 0.125rem hsl(var(--shadow-color) / 0.025),\n\t\t\t\t0rem 0.1875rem 0.1875rem hsl(var(--shadow-color) / 0.05),\n\t\t\t\t0rem 0.3125rem 0.3125rem hsl(var(--shadow-color) / 0.05),\n\t\t\t\t0rem 0.4375rem 0.625rem hsl(var(--shadow-color) / 0.075));\n\n\t\t\ttext-align: center;\n\t\t\tfont-size: var(--font-size-sm, 12px);\n\t\t\tfont-family: var(--gooey-font, var(--font-a, 'fredoka'));\n\t\t\tletter-spacing: 1px;\n\n\t\t\tz-index: 1000;\n\t\t\tpointer-events: none;\n\t\t\ttransition: opacity 0.1s;\n\t\t}\n\n\t\t.fractils-tooltip .fractils-hotkey {\n\t\t\tfilter: contrast(1.1);\n\t\t\tbackground: var(--fractils-hotkey_background, #1118);\n\t\t\tbackground: var(--fractils-hotkey_background, color-mix(in sRGB, var(--bg-c) 66%, transparent));\n\t\t\tcolor: var(--fractils-hotkey_color, var(--fg-a, #fff));\n\t\t\tpadding: 0px 3px;\n\t\t\tborder-radius: 2px;\n\t\t\tbox-shadow: 0 0 2px rgba(0, 0, 0, 0.33);\n\t\t}\n\n\t\t:root[theme='dark'] .fractils-tooltip .fractils-hotkey {\n\t\t\tbackground: var(--fractils-hotkey_background, color-mix(in sRGB, var(--bg-d) 100%, transparent));\n\t\t}\n\t`\n}\n\n/**\n * A wrapper function that creates a new {@link Tooltip} instance and returns\n * an object with `update` and `destroy` methods, compatible with Svelte actions.\n *\n * @example Vanilla\n * ```js\n * import { tooltip } from 'lib/actions/tooltip'\n *\n * const el = document.querySelector('div')\n * const tip = tooltip(el, { text: 'Hello, world!', placement: 'top' })\n * ```\n *\n * @example Svelte\n * ```svelte\n * <script>\n * \timport { tooltip } from 'lib/actions/tooltip'\n * </script>\n *\n * <div use:tooltip={{ text: 'Hello, world!', placement: 'top' }}>\n * \tHover me!\n * </div>\n * ```\n */\nexport const tooltip = (node: HTMLElement, options?: Partial<TooltipOptions>) => {\n\tconst tt = new Tooltip(node, options)\n\n\treturn {\n\t\tupdate(opts: TooltipOptions) {\n\t\t\tObject.assign(tt.opts, opts)\n\t\t\ttt.refresh()\n\t\t},\n\t\tdestroy() {\n\t\t\ttt.dispose()\n\t\t},\n\t}\n}\n\n/**\n * A simple animation loop.  Return `true` to cancel.\n */\nexport function tickLoop(cb: () => boolean | undefined) {\n\trequestAnimationFrame(() => {\n\t\tif (!cb()) tickLoop(cb)\n\t})\n}\n"],"names":[],"mappings":"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"}