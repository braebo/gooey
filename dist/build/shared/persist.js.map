{"version":3,"file":"persist.js","sources":["../../../../src/shared/persist.ts"],"sourcesContent":["/**\n * Persists a value in localStorage.\n * @returns An object with a `get` and `set` method that syncs with localStorage.\n *\n * @example\n * ```ts\n * // Let's say 'foo' is already \"42\" in localStorage:\n *\n * const foo = persist('foo', 5) // initial value won't be used\n *\n * foo.value // 42\n * // or\n * foo.get() // 42\n *\n * foo.value = 123\n * // or\n * foo.set(123)\n *\n * localStorage.getItem('foo') // \"123\"\n * ```\n */\nexport function persist<T>(\n\t/**\n\t * The key to store the value under in local storage.\n\t */\n\tkey: string,\n\t/**\n\t * The initial value to store if the key is'nt found in local storage.\n\t * @default undefined\n\t */\n\tinitialValue: T | undefined = undefined,\n\t/**\n\t * Whether to print a warning if localStorage is not available.\n\t * @default false\n\t */\n\tquiet = false,\n) {\n\tconst bail = () => {\n\t\tif (typeof localStorage === 'undefined') {\n\t\t\tif (!quiet) console.warn(`localStorage is not available for key \"${key}\"`)\n\t\t\treturn true\n\t\t} else {\n\t\t\treturn false\n\t\t}\n\t}\n\n\treturn {\n\t\tget(): T {\n\t\t\tif (bail()) return initialValue!\n\t\t\tconst storedValue = localStorage.getItem(key)\n\t\t\treturn storedValue ? JSON.parse(storedValue) : initialValue\n\t\t},\n\t\tset(newValue: T) {\n\t\t\tif (bail()) return\n\t\t\tlocalStorage.setItem(key, JSON.stringify(newValue))\n\t\t},\n\t\tget value() {\n\t\t\treturn this.get()\n\t\t},\n\t\tset value(v) {\n\t\t\tthis.set(v)\n\t\t},\n\t}\n}\n"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;AAoBG;SACa,OAAO;AACtB;;AAEG;AACH,GAAW;AACX;;;AAGG;AACH,YAAA,GAA8B,SAAS;AACvC;;;AAGG;AACH,KAAK,GAAG,KAAK,EAAA;IAEb,MAAM,IAAI,GAAG,MAAK;AACjB,QAAA,IAAI,OAAO,YAAY,KAAK,WAAW,EAAE;AACxC,YAAA,IAAI,CAAC,KAAK;AAAE,gBAAA,OAAO,CAAC,IAAI,CAAC,0CAA0C,GAAG,CAAA,CAAA,CAAG,CAAC,CAAA;AAC1E,YAAA,OAAO,IAAI,CAAA;SACX;aAAM;AACN,YAAA,OAAO,KAAK,CAAA;SACZ;AACF,KAAC,CAAA;IAED,OAAO;QACN,GAAG,GAAA;AACF,YAAA,IAAI,IAAI,EAAE;AAAE,gBAAA,OAAO,YAAa,CAAA;YAChC,MAAM,WAAW,GAAG,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,CAAA;AAC7C,YAAA,OAAO,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,GAAG,YAAY,CAAA;SAC3D;AACD,QAAA,GAAG,CAAC,QAAW,EAAA;AACd,YAAA,IAAI,IAAI,EAAE;gBAAE,OAAM;AAClB,YAAA,YAAY,CAAC,OAAO,CAAC,GAAG,EAAE,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAA;SACnD;AACD,QAAA,IAAI,KAAK,GAAA;AACR,YAAA,OAAO,IAAI,CAAC,GAAG,EAAE,CAAA;SACjB;QACD,IAAI,KAAK,CAAC,CAAC,EAAA;AACV,YAAA,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAA;SACX;KACD,CAAA;AACF;;;;"}