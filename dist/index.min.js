var Ei=Object.defineProperty;var a=(s,t)=>Ei(s,"name",{value:t,configurable:!0});function O(s,t){let[e,...i]=s,{concatArrays:r=!0}=t??{};return i.reduce((n,o)=>{if(!o)return n;let c=Object.keys(o);for(let l=0;l<c.length;l++){let h=c[l],d=n[h],u=o[h];Array.isArray(d)&&Array.isArray(u)?r?n[h]=[...new Set([...d,...u])]:n[h]=u:d&&typeof d=="object"?u!==!0&&(u&&typeof u=="object"?typeof globalThis.window<"u"&&u instanceof Element?n[h]=u:n[h]=O([{...d},u],t):(u||u===!1)&&(n[h]=u)):u!==void 0&&(n[h]=u)}return n},{...e})}a(O,"deepMergeOpts");function z(s,t={}){let e=s.resolved?{}:{base:s.vars.color.base,dark:{"bg-a":s.vars.color.dark?.["bg-a"]||s.vars.color.base["dark-a"],"bg-b":s.vars.color.dark?.["bg-b"]||s.vars.color.base["dark-b"],"bg-c":s.vars.color.dark?.["bg-c"]||s.vars.color.base["dark-c"],"bg-d":s.vars.color.dark?.["bg-d"]||s.vars.color.base["dark-d"],"bg-e":s.vars.color.dark?.["bg-e"]||s.vars.color.base["dark-e"],"fg-a":s.vars.color.dark?.["fg-a"]||s.vars.color.base["light-a"],"fg-b":s.vars.color.dark?.["fg-b"]||s.vars.color.base["light-b"],"fg-c":s.vars.color.dark?.["fg-c"]||s.vars.color.base["light-c"],"fg-d":s.vars.color.dark?.["fg-d"]||s.vars.color.base["light-d"],"fg-e":s.vars.color.dark?.["fg-e"]||s.vars.color.base["light-e"],...s.vars.color.dark},light:{"bg-a":s.vars.color.light?.["bg-a"]||s.vars.color.base["light-a"],"bg-b":s.vars.color.light?.["bg-b"]||s.vars.color.base["light-b"],"bg-c":s.vars.color.light?.["bg-c"]||s.vars.color.base["light-c"],"bg-d":s.vars.color.light?.["bg-d"]||s.vars.color.base["light-d"],"bg-e":s.vars.color.light?.["bg-e"]||s.vars.color.base["light-e"],"fg-a":s.vars.color.light?.["fg-a"]||s.vars.color.base["dark-a"],"fg-b":s.vars.color.light?.["fg-b"]||s.vars.color.base["dark-b"],"fg-c":s.vars.color.light?.["fg-c"]||s.vars.color.base["dark-c"],"fg-d":s.vars.color.light?.["fg-d"]||s.vars.color.base["dark-d"],"fg-e":s.vars.color.light?.["fg-e"]||s.vars.color.base["dark-e"],...s.vars.color.light}};return{title:s.title,prefix:s.prefix||"fractils",vars:O([{color:e},t,s.vars]),resolved:!0}}a(z,"resolveTheme");var Et=z({title:"default",prefix:"fracgui",vars:{color:{base:{"theme-a":"#00bcd4","dark-a":"#0B0B11","dark-b":"#1b1d29","dark-c":"#46465e","dark-d":"#55566a","dark-e":"#787b89","light-a":"#ffffff","light-b":"#c9ccd7","light-c":"#a9adba","light-d":"#777D8F","light-e":"#5F6377"},dark:{},light:{}},core:{light:{"controller-dim_background":"color-mix(in sRGB, var(--fracgui-bg-a) 75%, transparent)"}}}});var _e=z({title:"scout",prefix:"fracgui",vars:{color:{base:{"theme-a":"#ff4221","theme-b":"#ff9215","theme-c":"#ff8bd3","dark-a":"#15161d","dark-b":"#282a36","dark-c":"#272d30","dark-d":"#3a3a44","dark-e":"#4d4d58","light-a":"#dfe1e9","light-b":"#c3c4c7","light-c":"#777d8f","light-d":"#5f6377","light-e":"#363945"},dark:{},light:{}},utility:{dark:{filter:"contrast(1.05) brightness(1.05)"}},core:{dark:{"folder-header_background":"color-mix(in sRGB, var(--fracgui-bg-a) 100%, transparent)"},light:{"controller-dim_background":"#96a09c"}}}});var we=z({title:"flat",prefix:"fracgui",vars:{color:{base:{"theme-a":"#00bcd4","theme-b":"#f8d2c9","theme-c":"#ba788a","dark-a":"#0B0B11","dark-b":"#15161D","dark-c":"#1F202D","dark-d":"#353746","dark-e":"#474A5B","light-a":"#ffffff","light-b":"#dfe1e9","light-c":"#BABECA","light-d":"#777D8F","light-e":"#5F6377"},dark:{},light:{}},core:{dark:{"input-number-range_outline":"1px solid color-mix(in sRGB, var(--fracgui-bg-c) 33%, transparent)"}}}});var xe=`@charset "UTF-8";
.fracgui-root {
  z-index: 0;
}

.fracgui-header {
  z-index: 2;
}

.fracgui-toolbar {
  z-index: 3;
}

.fracgui-root .fracgui-content,
.fracgui-root .fracgui-content-wrapper,
.fracgui-folder .fracgui-content,
.fracgui-folder .fracgui-content-wrapper {
  display: grid;
  grid-template-rows: 1fr;
  animation-name: open;
  animation-duration: 0.25s;
  animation-fill-mode: forwards;
  animation-timing-function: cubic-bezier(0.1, 1, 0.1, 1);
}
.fracgui-root .fracgui-header,
.fracgui-folder .fracgui-header {
  height: var(--fracgui-header_height);
  max-height: var(--fracgui-header_height);
}
.fracgui-root.closed .fracgui-content,
.fracgui-root.closed .fracgui-content-wrapper,
.fracgui-folder.closed .fracgui-content,
.fracgui-folder.closed .fracgui-content-wrapper {
  animation-name: close;
  animation-duration: 0.25s;
  animation-fill-mode: forwards;
  animation-timing-function: cubic-bezier(0.05, 1, 0.2, 1);
}
.fracgui-root.closed .fracgui-folder .fracgui-header,
.fracgui-folder.closed .fracgui-folder .fracgui-header {
  max-height: 0;
}
.fracgui-root.instant .fracgui-content-wrapper,
.fracgui-folder.instant .fracgui-content-wrapper {
  grid-template-rows: 1fr;
  animation: none;
}
.fracgui-root.instant .fracgui-folder .fracgui-header,
.fracgui-folder.instant .fracgui-folder .fracgui-header {
  height: var(--fracgui-header_height);
  max-height: var(--fracgui-header_height);
}

.fracgui-root.closed .fracgui-content {
  transition: opacity 0.1s;
  transition-delay: 0.1s;
  opacity: 0 !important;
}
.fracgui-root.closed .fracgui-content.instant {
  transition: none;
}

.fracgui-root.animating .fracgui-content,
.fracgui-root.animating .fracgui-content-wrapper, .fracgui-root.closed .fracgui-content,
.fracgui-root.closed .fracgui-content-wrapper,
.fracgui-folder.animating .fracgui-content,
.fracgui-folder.animating .fracgui-content-wrapper,
.fracgui-folder.closed .fracgui-content,
.fracgui-folder.closed .fracgui-content-wrapper {
  will-change: transform;
  backface-visibility: hidden;
  transform: translateZ(0);
  overflow: hidden;
}
.fracgui-root.animating .fracgui-content::-webkit-scrollbar-thumb,
.fracgui-root.animating .fracgui-content-wrapper::-webkit-scrollbar-thumb, .fracgui-root.closed .fracgui-content::-webkit-scrollbar-thumb,
.fracgui-root.closed .fracgui-content-wrapper::-webkit-scrollbar-thumb,
.fracgui-folder.animating .fracgui-content::-webkit-scrollbar-thumb,
.fracgui-folder.animating .fracgui-content-wrapper::-webkit-scrollbar-thumb,
.fracgui-folder.closed .fracgui-content::-webkit-scrollbar-thumb,
.fracgui-folder.closed .fracgui-content-wrapper::-webkit-scrollbar-thumb {
  transition: none !important;
  background: transparent !important;
}
@-moz-document url-prefix() {
  .fracgui-root.animating .fracgui-content,
  .fracgui-root.animating .fracgui-content-wrapper, .fracgui-root.closed .fracgui-content,
  .fracgui-root.closed .fracgui-content-wrapper,
  .fracgui-folder.animating .fracgui-content,
  .fracgui-folder.animating .fracgui-content-wrapper,
  .fracgui-folder.closed .fracgui-content,
  .fracgui-folder.closed .fracgui-content-wrapper {
    transition: none !important;
    scrollbar-color: transparent transparent;
  }
}

@keyframes reveal {
  from {
    grid-template-rows: 0fr;
  }
  to {
    grid-template-rows: 1fr;
  }
}
@keyframes open {
  from {
    grid-template-rows: 0fr;
  }
  to {
    grid-template-rows: 1fr;
  }
}
@keyframes close {
  from {
    grid-template-rows: 1fr;
  }
  to {
    grid-template-rows: 0fr;
  }
}
.fracgui-folder {
  contain: content;
  height: fit-content;
}
.fracgui-folder.hidden {
  display: none;
}
.fracgui-folder:not(.fracgui-root) {
  position: relative;
}

.fracgui-folder .fracgui-header {
  contain: strict;
  position: relative;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  width: 100%;
  padding-left: var(--fracgui-folder-header_padding-left);
  outline-offset: -1px;
  color: var(--fracgui-folder-header-dim_color);
  background: var(--fracgui-folder-header_background);
  outline: var(--fracgui-folder-header_outline, 1px solid color-mix(in sRGB, var(--fracgui-bg-b) 50%, transparent));
  box-shadow: var(--fracgui-folder-header_box-shadow, 0 0 0.1rem #000 inset);
  transition: opacity var(--fracgui-transition-duration);
  cursor: pointer;
}
.fracgui-folder .fracgui-header .fracgui-title {
  contain: layout style paint;
  position: relative;
  width: fit-content;
  font-size: calc(var(--fracgui-font-size) * 0.9);
  font-weight: var(--fracgui-folder-header_font-weight);
  letter-spacing: var(--fracgui-folder-header_letter-spacing);
  font-variation-settings: "wght" var(--fracgui-folder-header_font-weight), "wdth" 100;
  transition: color var(--fracgui-transition-duration);
}
.fracgui-folder .fracgui-header .fracgui-folder-icon-container {
  contain: strict;
  width: 1.1rem !important;
  height: 1.1rem !important;
  color: var(--fracgui-fg-c);
  backface-visibility: hidden;
}
.fracgui-folder .fracgui-header .fracgui-folder-icon-container .fracgui-folder-icon {
  transition: opacity var(--fracgui-transition-duration);
  contain: strict;
  backface-visibility: hidden;
}

.fracgui-connector-svg {
  contain: strict;
  display: flex;
  position: absolute;
  top: 0;
  left: 0;
  width: 20px;
  height: 100%;
  pointer-events: none;
  overflow: hidden;
  z-index: 10;
  backface-visibility: hidden;
}

.fracgui-folder {
  contain: content;
}
.fracgui-folder .fracgui-content {
  contain: content;
  display: flex;
  flex-direction: column;
  width: 100%;
  border-left: var(--fracgui-folder-content_padding-left) solid var(--fracgui-folder-header_background);
}

.fracgui-folder:hover:not(.fracgui-root) > .fracgui-header {
  color: var(--fracgui-folder-header_color);
}
.fracgui-folder:hover:not(.fracgui-root) > .fracgui-content {
  opacity: 1;
}

.fracgui-root {
  contain: content;
  position: absolute;
  display: flex;
  flex-direction: column;
  inset: 0;
  width: var(--fracgui-root_width);
  min-width: var(--fracgui-root_min-width);
  max-width: var(--fracgui-root_max-width);
  height: fit-content;
  background: var(--fracgui-folder_background);
  border-radius: var(--fracgui-radius-md);
  filter: var(--fracgui-filter);
  font-family: var(--fracgui-font-family);
  font-weight: var(--fracgui-folder-content_font-weight);
  user-select: none;
  z-index: 99;
}

.fracgui-root > .fracgui-header {
  contain: strict;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: space-around;
  gap: 0.5rem;
  width: 100%;
  min-height: var(--fracgui-root-header_height);
  color: var(--fracgui-fg-c);
  background: var(--fracgui-bg-a);
  border-radius: var(--fracgui-radius-md);
  border-bottom-left-radius: var(--fracgui-radius-xs);
  border-bottom-right-radius: var(--fracgui-radius-xs);
  cursor: pointer;
  cursor: grab;
}
.fracgui-root > .fracgui-header .fracgui-title {
  contain: layout style paint;
  position: relative;
  width: fit-content;
  height: var(--fracgui-root-header_height);
  font-size: var(--fracgui-font-size);
  font-weight: var(--fracgui-root-header_font-weight);
  font-variation-settings: "wght" var(--fracgui-root-header_font-weight), "wdth" 100;
  letter-spacing: var(--fracgui-root-header_letter-spacing);
  line-height: var(--fracgui-root-header_height);
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
  pointer-events: none;
}

.fracgui-root > .fracgui-content-wrapper > .fracgui-content {
  display: flex;
  flex-direction: column;
  width: 100%;
  margin: 0;
  max-height: var(--fracgui-root_max-height);
  border-radius: var(--fracgui-radius-md);
  border-top-left-radius: var(--fracgui-radius-sm);
  border-top-right-radius: var(--fracgui-radius-sm);
  background: var(--fracgui-root-content_background);
  backdrop-filter: var(--fracgui-backdrop-filter);
  outline-offset: -1px;
  box-shadow: 0 0 4.5px 0.5px hsla(0, 10%, var(--fracgui-shadow-lightness), var(--fracgui-shadow-opacity)) inset;
  overflow-y: scroll;
  overflow-x: hidden;
  scrollbar-gutter: stable;
  backface-visibility: hidden;
}
@-moz-document url-prefix() {
  .fracgui-root > .fracgui-content-wrapper > .fracgui-content {
    transition: none !important;
    scrollbar-color: var(--fracgui-bg-b) var(--fracgui-bg-a);
    scrollbar-width: thin;
    scrollbar-gutter: auto;
  }
}
.fracgui-root > .fracgui-content-wrapper > .fracgui-content::-webkit-scrollbar {
  width: 5px;
  height: 0px;
}
.fracgui-root > .fracgui-content-wrapper > .fracgui-content::-moz-scrollbar {
  width: 5px;
  height: 0px;
}
.fracgui-root > .fracgui-content-wrapper > .fracgui-content::-webkit-scrollbar-thumb {
  background: var(--fracgui-controller_background);
  border: none;
}
.fracgui-root > .fracgui-content-wrapper > .fracgui-content::-moz-scrollbar-thumb {
  background: var(--fracgui-controller_background);
  border: none;
}
.fracgui-root > .fracgui-content-wrapper > .fracgui-content::-webkit-scrollbar-track {
  background: var(--fracgui-folder-header_background);
  border-bottom-right-radius: var(--fracgui-radius-sm);
}
.fracgui-root > .fracgui-content-wrapper > .fracgui-content::-moz-scrollbar-track {
  background: var(--fracgui-folder-header_background);
  border-bottom-right-radius: var(--fracgui-radius-sm);
}

@-moz-document url-prefix() {
  .fracgui-root.animating > .fracgui-content-wrapper > .fracgui-content {
    overflow: hidden;
  }
}

.fracgui-controller,
.fracgui-controller-text,
.fracgui-controller-switch,
.fracgui-controller-button {
  color: var(--fracgui-controller-dim_color);
  background: var(--fracgui-controller-dim_background);
}
.fracgui-controller.disabled,
.fracgui-controller-text.disabled,
.fracgui-controller-switch.disabled,
.fracgui-controller-button.disabled {
  opacity: 0.75;
  filter: brightness(0.75);
  color: var(--fracgui-bg-e);
  pointer-events: none;
}

.fracgui-controller {
  contain: layout style;
  width: 100%;
  box-shadow: var(--fracgui-controller_box-shadow);
  border-radius: var(--fracgui-controller_border-radius);
  outline: var(--fracgui-controller_outline);
  transition-duration: var(--fracgui-transition-duration);
  transition-property: color, background, opacity;
}
.fracgui-controller:hover:not(:disabled), .fracgui-controller:focus-visible:not(:disabled), .fracgui-controller:active:not(:disabled) {
  opacity: 1;
  color: var(--fracgui-controller_color);
  background: var(--fracgui-controller_background);
}

.fracgui-controller-button {
  contain: strict;
  cursor: pointer;
  height: 1.5rem;
  margin: 0;
  padding: 0;
  border: none;
  border-radius: var(--fracgui-controller_border-radius);
  outline: var(--fracgui-controller_outline);
  outline-offset: -1px;
  box-shadow: 1px 2px 6px var(--fracgui-shadow-color), 1px -1px 1px hsla(250, 10%, calc(var(--fracgui-shadow-lightness)), calc(var(--fracgui-shadow-opacity))) inset, 1px -1px 1px hsla(250, 10%, calc(var(--fracgui-shadow-lightness)), calc(var(--fracgui-shadow-opacity))) inset, -0.5px 0.5px 0.5px hsla(250, 10%, 50%, calc(var(--fracgui-shadow-opacity))) inset;
  font-family: var(--fracgui-controller_font-family);
  font-size: calc(var(--fracgui-font-size) * 0.85);
  font-variation-settings: "wght" 400;
  text-align: center;
  transform: scale(1);
  backface-visibility: hidden;
  transition-duration: var(--fracgui-transition-duration);
  transition-property: background, color, transform, box-shadow;
}
.fracgui-controller-button svg {
  width: 100%;
  height: 100%;
}
.fracgui-root[mode=dark] .fracgui-controller-button {
  outline: none;
}

.fracgui-controller-button:hover:not(:disabled), .fracgui-controller-button:active:not(:disabled) {
  background: var(--fracgui-controller_background);
  color: var(--fracgui-controller_color);
}
.fracgui-controller-button:active {
  transform: scale(0.975);
  color: var(--fracgui-theme-a);
  box-shadow: 0px 0px 3px var(--fracgui-shadow-color), 0px 0px 5px hsla(250, 10%, calc(var(--fracgui-shadow-lightness) / 3), calc(var(--fracgui-shadow-opacity) / 1)) inset, 0px 0px 10px hsla(250, 10%, calc(var(--fracgui-shadow-lightness) / 2), calc(var(--fracgui-shadow-opacity) / 2)) inset, 0px 0px 20px hsla(250, 10%, calc(var(--fracgui-shadow-lightness) / 1), calc(var(--fracgui-shadow-opacity) / 2)) inset;
}
.fracgui-controller-button:disabled {
  opacity: 0.5;
  cursor: default;
  pointer-events: none;
}

.fracgui-controller-select-container {
  contain: content;
  position: relative;
  outline: none;
  border: none;
}
.fracgui-controller-select-container[contenteditable=true] .fracgui-controller-select-selected {
  cursor: text;
  outline: 1px solid var(--fracgui-theme-a);
}

.fracgui-controller-select-selected {
  border-radius: var(--fracgui-radius-xs);
  outline: 1px solid color-mix(in sRGB, var(--fracgui-bg-d) 0%, transparent);
  text-align: center;
  letter-spacing: var(--fracgui-folder-content_letter-spacing);
  overflow: hidden;
  transition-duration: var(--fracgui-transition-duration);
  transition-property: background, color, filter;
  cursor: pointer;
}
.fracgui-controller-select-selected.active, .fracgui-controller-select-selected:hover, .fracgui-controller-select-selected:focus-visible, .fracgui-controller-select-selected:active {
  filter: contrast(1.1) brightness(1.25);
}

@keyframes dropdown {
  from {
    transform: translateY(0rem);
  }
  to {
    transform: translateY(0.25rem);
  }
}
.fracgui-controller-select-dropdown {
  contain: layout style;
  backface-visibility: hidden;
  display: none;
  position: absolute;
  display: flex;
  flex-direction: column;
  width: 0px;
  height: 0px;
  padding: 0;
  margin: 0;
  background: color-mix(in sRGB, var(--fracgui-folder-header_background) calc(var(--fracgui-opacity) / 4 * 100%), transparent);
  color: var(--fracgui-controller-dim_color);
  backdrop-filter: var(--fracgui-backdrop-filter);
  outline: 1px solid var(--fracgui-bg-b);
  border-radius: var(--fracgui-radius);
  box-shadow: 0px 0.3px 0.3px hsla(var(--fracgui-shadow-lightness), 0.49), -0.1px 2.1px 2.2px -0.6px hsla(var(--fracgui-shadow-lightness), 0.47), -0.2px 4.6px 4.9px -1.2px hsla(var(--fracgui-shadow-lightness), 0.45), -0.4px 9.2px 9.8px -1.7px hsla(var(--fracgui-shadow-lightness), 0.42), -0.7px 17.4px 18.5px -2.3px hsla(var(--fracgui-shadow-lightness), 0.4), -1.2px 30.6px 32.6px -2.9px hsla(var(--fracgui-shadow-lightness), 0.38);
  z-index: 100;
  transition: opacity 0.2s cubic-bezier(0.23, 1, 0.32, 1), transform 0.2s cubic-bezier(0.23, 1, 0.32, 1);
  opacity: 0;
  pointer-events: none;
  transform: translate(0, 0) scaleY(0);
  transform-origin: top center;
}
.fracgui-controller-select-dropdown.expanded {
  contain: content;
  display: block;
  width: fit-content;
  height: fit-content;
  padding: 0.1rem;
  opacity: 1;
  transform: translate(0, 0.5rem) scaleY(1);
  animation: dropdown 0.15s forwards;
}

.fracgui-controller-select-option {
  contain: content;
  padding: 0.1rem 0.75rem;
  line-height: 1.5rem;
  font-family: var(--fracgui-font, var(--font-d));
  font-size: calc(var(--fracgui-font-size) * 0.8);
  letter-spacing: 0.5px;
  color: var(--fracgui-fg-d);
  transition-duration: 0.15s;
  transition-property: background, color, filter;
  cursor: pointer;
}
.fracgui-controller-select-option:hover, .fracgui-controller-select-option:focus-visible {
  color: var(--fracgui-controller_color);
  background: color-mix(in sRGB, var(--fracgui-controller_background) 50%, var(--fracgui-folder_background));
}
.fracgui-controller-select-option:first-of-type {
  border-top-left-radius: var(--fracgui-radius-sm);
  border-top-right-radius: var(--fracgui-radius-sm);
}
.fracgui-controller-select-option:last-of-type {
  border-bottom-left-radius: var(--fracgui-radius-sm);
  border-bottom-right-radius: var(--fracgui-radius-sm);
}
.fracgui-controller-select-option.selected, .fracgui-controller-select-option:hover {
  color: var(--fracgui-fg-a);
}

.fracgui-wrapper[mode=light] .fracgui-controller-select-option.selected, .fracgui-wrapper[mode=light] .fracgui-controller-select-option:hover {
  background: var(--fracgui-folder-header_background);
}

.fracgui-toolbar {
  contain: content;
  backface-visibility: hidden;
  position: absolute;
  right: 0;
  top: 0;
  bottom: 0;
  width: 75%;
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 0.5rem;
  pointer-events: none;
}

.fracgui-toolbar-item svg {
  max-height: 1rem;
}

.fracgui-search-container {
  contain: content;
  backface-visibility: hidden;
  display: flex;
  align-items: center;
  justify-content: flex-end;
  gap: 0.25rem;
  padding: 0.25rem 0.1rem 0.25rem 0;
  cursor: pointer;
  pointer-events: all;
}

.fracgui-header:hover .fracgui-search-button {
  opacity: 1;
}

.fracgui-search-button {
  contain: strict;
  all: unset;
  display: flex;
  align-items: center;
  width: 1.5rem;
  height: 0.9rem;
  transition-duration: 0.5s;
  transition-property: color, opacity;
}
.fracgui-search-button svg {
  pointer-events: none;
}
.fracgui-search-button svg path {
  transform: translate(0, 0) scale(1);
  transform-origin: 50% 50%;
  transition-duration: 0.15s;
  transition: transform 0.15s;
}
.fracgui-search-button svg circle {
  fill: transparent;
  transform: translate(0, 0) scale(1);
  transition-duration: 0.15s;
  transition: transform 0.15s;
}

.fracgui-search-button {
  color: var(--fracgui-toolbar-icon-dim_color);
  opacity: 0;
}

.fracgui-search-button:hover {
  color: var(--fracgui-fg-e);
  opacity: 1;
  transition-duration: 0.15s;
}

.fracgui-search-button:active {
  transition-duration: 0.05s;
  background: transparent;
  color: var(--fracgui-fg-d);
  opacity: 1;
  scale: 0.9;
}

.fracgui-search-container.active .fracgui-search-button {
  color: var(--fracgui-bg-e);
  opacity: 1;
}
.fracgui-search-container.active .fracgui-search-button path {
  transform: translate(-10%, 10%) scale(0);
  transform-origin: 60% 60%;
}
.fracgui-search-container.active .fracgui-search-button circle {
  fill: var(--fracgui-bg-e);
  transform: translate(-10%, 20%) scale(0.75);
}

input.fracgui-search-input {
  contain: content;
  width: 6rem;
  height: 1rem;
  padding: 0 0.25rem;
  color: var(--fracgui-fg-c);
  background: var(--fracgui-bg-b);
  border-radius: var(--fracgui-radius-sm);
  box-shadow: 0 0 11px rgba(0, 0, 0, 0.2666666667) inset;
  outline: none;
  border: none;
  font-size: calc(var(--fracgui-font-size) * 0.75);
  caret-color: var(--fracgui-bg-e);
  caret-shape: block;
  line-height: 4px !important;
  transition-timing-function: cubic-bezier(0.23, 1, 0.32, 1);
}
.fracgui-root[mode=light] input.fracgui-search-input {
  box-shadow: 0 0 4px rgba(0, 0, 0, 0.0666666667) inset;
}

.fracgui-search-input {
  max-width: 0rem;
  opacity: 0;
  pointer-events: none;
  transition-duration: 1s;
}

.fracgui-search-container.active .fracgui-search-input {
  max-width: 6rem;
  opacity: 1;
  pointer-events: all;
  transition-duration: 0.33s;
}

.fracgui-settings-button {
  contain: content;
  display: flex;
  align-items: center;
  justify-content: flex-start;
  gap: 0.25rem;
  border: none;
  width: 1rem;
  margin: 0;
  padding: 0;
  margin-right: 0.5rem;
  color: var(--fracgui-toolbar-icon-dim_color);
  background: none;
  cursor: pointer;
  transition: color 0.15s;
  pointer-events: all;
}
.fracgui-settings-button:hover {
  color: var(--fracgui-toolbar-icon_color);
}
.fracgui-settings-button .gear,
.fracgui-settings-button .dot-left,
.fracgui-settings-button .dot-center,
.fracgui-settings-button .dot-right {
  transition-duration: 0.5s;
  transition-timing-function: cubic-bezier(0.16, 0.9, 0, 1.01);
  transition-property: opacity, transform;
  transform-origin: center;
  pointer-events: none;
}
.fracgui-settings-button .gear {
  transition: all 0.5s cubic-bezier(0.16, 0.9, 0, 1.01), transform 0.33s cubic-bezier(0, 1.07, 0.48, 1.27);
  opacity: 0;
  transform: scale(1.33) rotate(-180deg);
}
.fracgui-settings-button:hover .gear {
  transition: 0.5s cubic-bezier(0.16, 0.9, 0, 1.01);
}
.fracgui-settings-button.open .gear {
  transition: 0.33s cubic-bezier(0, 1.07, 0.48, 1.5);
}
.fracgui-settings-button .dot-left {
  opacity: 1;
  transform: translateX(0);
}
.fracgui-settings-button .dot-center {
  opacity: 1;
}
.fracgui-settings-button .dot-right {
  opacity: 1;
  transform: scale(1) translateX(0);
}
.fracgui-settings-button:hover .gear, .fracgui-settings-button.open .gear {
  opacity: 1;
  transform: scale(1) rotate(0deg);
}
.fracgui-settings-button:hover .dot-left, .fracgui-settings-button.open .dot-left {
  opacity: 0;
  transform: translateX(36%);
}
.fracgui-settings-button:hover .dot-center, .fracgui-settings-button.open .dot-center {
  transform: scale(1.25);
}
.fracgui-settings-button:hover .dot-right, .fracgui-settings-button.open .dot-right {
  opacity: 0;
  transform: scale(1.2) translateX(-36%);
}
.fracgui-settings-button.open .gear {
  opacity: 1;
  transform: scale(1) rotate(58deg);
}
.fracgui-settings-button:active {
  background: none;
}

.fracgui-folder .copy-button {
  contain: content;
  cursor: pointer;
  height: 2rem;
  padding: 10%;
  color: var(--fracgui-fg-a);
  background: color-mix(in sRGB, var(--fracgui-bg-a) 0%, transparent);
  outline: 1px solid transparent;
  border-radius: 0.2rem;
  transition-property: all, background, color;
  transition-delay: 0s, 1s, 0.75s;
  transition-duration: 0.25s, 0.5s;
  font-size: 0.8rem;
  font-family: var(--fracgui-font-family);
}
.fracgui-folder .copy-button:not(.active, .outro):hover {
  color: var(--fracgui-fg-b);
  background: color-mix(in sRGB, var(--fracgui-bg-a) 75%, transparent);
  transition-duration: 0.15s, 0.25s;
  transition-delay: 0s;
}
.fracgui-folder .copy-button:not(.active, .outro):active, .fracgui-folder .copy-button:not(.active, .outro):focus {
  color: var(--fracgui-fg-c);
  background: var(--fracgui-bg-c);
}
.fracgui-folder .copy-button.active, .fracgui-folder .copy-button.outro {
  color: var(--fracgui-fg-a);
  outline-color: transparent !important;
  background: color-mix(in sRGB, var(--fracgui-bg-a) 0%, transparent);
  opacity: 1 !important;
  transition-delay: 0s;
  transition-duration: 0.25s;
}
.fracgui-folder .copy-button-svg-container {
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
  grid-area: 1/1;
}
.fracgui-folder .copy-button-svg-container svg {
  overflow: visible;
  width: 100%;
  height: 100%;
}
.fracgui-folder .copy-button-svg-container svg .front,
.fracgui-folder .copy-button-svg-container svg .back,
.fracgui-folder .copy-button-svg-container svg .check {
  transform-origin: 50% 50%;
}
.fracgui-folder .copy-button-svg-container svg .front {
  transition-duration: 0.66s !important;
  transition-timing-function: cubic-bezier(0.175, 0.885, 0.32, 1.275);
  stroke: currentColor;
}
.fracgui-folder .copy-button-svg-container svg.active .front {
  transition-timing-function: cubic-bezier(0.2, 2, 0.2, 0.85);
  transition-duration: 0.2s;
  transform: scale(2);
  fill: #12a084 !important;
  stroke: #12a084 !important;
}
.fracgui-folder .copy-button-svg-container svg.outro .front {
  transition-duration: 0.5s !important;
}
.fracgui-folder .copy-button-svg-container svg .back {
  opacity: 1;
  transform: translate(0, 0);
  transition-duration: 0.33s;
  transition-timing-function: cubic-bezier(0.77, 0, 0.175, 1);
}
.fracgui-folder .copy-button-svg-container svg.active .back {
  opacity: 0;
  transform: translate(15%, 15%);
}
.fracgui-folder .copy-button-svg-container svg.outro .back {
  transition: opacity 0.25s 0.25s, transform 1s 0s;
}
.fracgui-folder .copy-button-svg-container svg .check {
  stroke: var(--fracgui-light-a);
  opacity: 0;
  transform: scale(0);
  transition: 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275) 0s;
}
.fracgui-folder .copy-button-svg-container svg.active .check {
  opacity: 1;
  transform: scale(1.25);
  transition: 0.3s cubic-bezier(0.2, 2, 0.2, 0.85) 0.1s;
}

.fracgui-input-drawer-toggle {
  contain: strict;
  right: 0.5rem;
  top: 0.5rem;
  min-width: 0.33rem;
  height: 75%;
  color: var(--fracgui-fg-c);
  background: var(--fracgui-drawer-toggle_background);
  transition: background var(--fracgui-transition-duration);
  box-shadow: -1px 0 1px 0.5px color-mix(in sRGB, var(--fracgui-bg-a) 50%, transparent) inset;
  border-top-right-radius: var(--fracgui-radius-sm);
  border-bottom-right-radius: var(--fracgui-radius-sm);
  cursor: pointer;
}
.fracgui-input-drawer-toggle:hover {
  background: var(--fracgui-bg-c);
}

@property --fracgui-resetbtn-gradstart {
  syntax: "<percentage>";
  inherits: false;
  initial-value: 0%;
}
@property --fracgui-resetbtn-gradend {
  syntax: "<percentage>";
  inherits: false;
  initial-value: 100%;
}
.fracgui-input-reset-btn {
  contain: strict;
  --fracgui-resetbtn-gradstart: 5%;
  --fracgui-resetbtn-gradend: 16%;
  position: absolute;
  right: 5px;
  top: 0;
  bottom: 0;
  width: 20px;
  height: 20px;
  margin: auto 0;
  transform: translateX(0);
  opacity: 0;
  border-radius: 50%;
  color: var(--fracgui-fg-c);
  background-image: radial-gradient(circle, var(--fracgui-theme-a) 0%, var(--fracgui-theme-a) var(--fracgui-resetbtn-gradstart), transparent var(--fracgui-resetbtn-gradend), transparent 100%);
  cursor: pointer;
  pointer-events: none;
  transition: opacity 0.25s cubic-bezier(0.215, 0.61, 0.355, 1), --fracgui-resetbtn-gradstart 0.25s cubic-bezier(0.215, 0.61, 0.355, 1), --fracgui-resetbtn-gradend 0.25s cubic-bezier(0.215, 0.61, 0.355, 1);
}
.fracgui-input-reset-btn:hover {
  --fracgui-resetbtn-gradStart: 37.5%;
  --fracgui-resetbtn-gradend: 45%;
}
.fracgui-input-reset-btn.dirty {
  opacity: 1;
  pointer-events: all;
}

.fracgui-input-title {
  position: relative;
  contain: content;
  max-width: var(--fracgui-input-section-1_width);
  min-width: var(--fracgui-input-section-1_width);
  text-wrap: balance;
  padding-left: 8px;
  font-size: calc(var(--fracgui-font-size) * 0.85);
  letter-spacing: var(--fracgui-folder-content_letter-spacing);
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
  transition-duration: var(--fracgui-transition-duration);
  transition-property: color;
}

.fracgui-input-container {
  position: relative;
  display: flex;
  align-items: center;
  width: 100%;
  height: 0%;
  min-height: var(--fracgui-input_height);
  color: var(--fracgui-input-container_color);
  outline: var(--fracgui-input-container_outline);
  box-shadow: var(--fracgui-input-container_box-shadow);
  transition: opacity 0.15s ease-in 0.2s;
}
.fracgui-input-container:first-of-type {
  border-top-left-radius: var(--fracgui-radius-sm);
  border-top-right-radius: var(--fracgui-radius-sm);
}
.fracgui-input-container:first-of-type::before {
  content: "";
  position: absolute;
  background-color: transparent;
  bottom: 1rem;
  width: 0.5rem;
  height: 1rem;
  border-top-left-radius: 0.25rem;
  box-shadow: 0 -0.5rem 0 0 var(--fracgui-folder-header_background);
  clip-path: inset(0 0 0 0);
  opacity: 1;
  transition: inherit;
}
.fracgui-input-container:first-of-type::after {
  content: "";
  position: absolute;
  background-color: transparent;
  right: 0;
  bottom: 1rem;
  width: 0.5rem;
  min-height: 1rem;
  border-top-right-radius: 0.25rem;
  box-shadow: 0 -0.5rem 0 0 var(--fracgui-folder-header_background);
  clip-path: inset(0 0 0 0);
  opacity: 1;
  transition: inherit;
}
.fracgui-folder:not(:last-of-type) .fracgui-input-container:last-of-type {
  border-bottom-left-radius: var(--fracgui-radius-sm);
  border-bottom-right-radius: var(--fracgui-radius-sm);
}
.fracgui-folder:not(:last-of-type) .fracgui-input-container:last-of-type::before {
  content: "";
  position: absolute;
  background-color: transparent;
  top: 1rem;
  height: 1rem;
  width: 0.5rem;
  border-bottom-left-radius: 0.25rem;
  box-shadow: 0 0.5rem 0 0 var(--fracgui-folder-header_background);
  clip-path: inset(0 0 0 0);
}
.fracgui-folder:not(:last-of-type) .fracgui-input-container:last-of-type::after {
  content: "";
  position: absolute;
  background-color: transparent;
  right: 0;
  top: 1rem;
  height: 1rem;
  width: 0.5rem;
  border-bottom-right-radius: 0.25rem;
  box-shadow: 0 0.5rem 0 0 var(--fracgui-folder-header_background);
  clip-path: inset(0 0 0 0);
}

.fracgui-input-container:hover {
  color: var(--fracgui-fg-b);
}
.fracgui-input-container:has(input:active) .fracgui-controller-number, .fracgui-input-container:has(.fracgui-controller:active) .fracgui-controller-number {
  opacity: 1;
  background: var(--fracgui-controller_background);
}
.fracgui-input-container:has(input:active) .fracgui-input-title, .fracgui-input-container:has(.fracgui-controller:active) .fracgui-input-title {
  color: var(--fracgui-theme-a);
}
.fracgui-input-container.fracgui-search-hit {
  min-height: var(--fracgui-input_height);
}
.fracgui-input-container.fracgui-search-hit .fracgui-input-title {
  color: var(--fracgui-theme-a);
}
.fracgui-input-container.fracgui-search-miss {
  min-height: 0rem;
  overflow: hidden;
}
.fracgui-input-container.fracgui-search-miss::after {
  opacity: 0;
  transition: inherit;
}
.fracgui-input-container.fracgui-search-miss::before {
  opacity: 0;
  transition: inherit;
}
.fracgui-input-container.expanded .fracgui-input-container {
  min-height: unset;
}
.fracgui-input-container .fracgui-input-content {
  contain: content;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: space-evenly;
  width: 100%;
  margin: 0;
  padding-right: 0.5rem;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-number-container {
  contain: content;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding-left: 1px;
  width: 100%;
  height: 90%;
  border-radius: var(--fracgui-radius-sm);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-number-container .fracgui-input-number-buttons-container {
  contain: strict;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: space-between;
  width: 2rem;
  height: 1.5rem;
  margin: 0;
  padding: 0;
  margin-left: 0.1rem;
  margin-right: 0.1rem;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-number-container .fracgui-input-number-buttons-container .fracgui-input-number-button {
  contain: strict;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 90%;
  height: 50%;
  outline: none;
  opacity: 0.5;
  border: none;
  border-radius: var(--fracgui-radius-xs);
  box-shadow: none;
  background: transparent;
  transition-duration: var(--fracgui-transition-duration);
  transition-property: color, background, box-shadow, opacity;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-number-container .fracgui-input-number-buttons-container .fracgui-input-number-button svg {
  width: 1rem;
  height: 1rem;
  color: var(--fracgui-fg-d);
  opacity: 0.1;
  scale: 1;
  transition-duration: var(--fracgui-transition-duration);
  transition-property: color, opacity;
  user-select: none;
  pointer-events: none;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-number-container .fracgui-input-number-buttons-container .fracgui-input-number-button:hover, .fracgui-input-container .fracgui-input-content .fracgui-input-number-container .fracgui-input-number-buttons-container .fracgui-input-number-button:active {
  opacity: 1;
  box-shadow: 0px 0px 1px 0px hsl(0, 0%, 0%) inset;
}
.fracgui-root[mode=light] .fracgui-input-container .fracgui-input-content .fracgui-input-number-container .fracgui-input-number-buttons-container .fracgui-input-number-button:hover, .fracgui-root[mode=light] .fracgui-input-container .fracgui-input-content .fracgui-input-number-container .fracgui-input-number-buttons-container .fracgui-input-number-button:active {
  box-shadow: 0px 0px 1px 0px hsl(0, 0%, 100%) inset;
}

.fracgui-input-container .fracgui-input-content .fracgui-input-number-container .fracgui-input-number-buttons-container .fracgui-input-number-button:hover svg, .fracgui-input-container .fracgui-input-content .fracgui-input-number-container .fracgui-input-number-buttons-container .fracgui-input-number-button:active svg {
  opacity: 1;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-number-container .fracgui-input-number-buttons-container .fracgui-input-number-button:active svg {
  color: var(--fracgui-theme-a);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-number-container .fracgui-input-number-buttons-container .fracgui-input-number-buttons-increment {
  border-top-left-radius: var(--fracgui-radius);
  border-top-right-radius: var(--fracgui-radius);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-number-container .fracgui-input-number-buttons-container .fracgui-input-number-buttons-decrement {
  border-bottom-left-radius: var(--fracgui-radius);
  border-bottom-right-radius: var(--fracgui-radius);
}
.fracgui-input-container .fracgui-input-content input.fracgui-input-number-range {
  contain: layout style size;
  -webkit-appearance: none;
  appearance: none;
  width: 100%;
  height: 0.5rem;
  accent-color: var(--fracgui-input-number-range_color);
  background: var(--fracgui-input-number-range_background);
  border-radius: var(--fracgui-radius-xs);
  box-shadow: var(--fracgui-input-number-range_box-shadow);
  outline: var(--fracgui-input-number-range_outline);
  opacity: 0.7;
  transition: 0.15s;
  overflow: visible;
  min-width: 1rem;
}
.fracgui-input-container .fracgui-input-content input.fracgui-input-number-range:hover {
  opacity: 1;
}
.fracgui-input-container .fracgui-input-content input.fracgui-input-number-range:active {
  background: color-mix(in lch, var(--fracgui-theme-a), var(--fracgui-input-number-range_background));
}
.fracgui-input-container .fracgui-input-content input.fracgui-input-number-range::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 0.5rem;
  height: 1rem;
  background: var(--fracgui-input-number-range_color);
  border-radius: var(--fracgui-radius-xs);
  border: none;
  transition: 0.15s;
  cursor: pointer;
  z-index: 10;
}
.fracgui-input-container .fracgui-input-content input.fracgui-input-number-range::-moz-range-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 0.5rem;
  height: 1rem;
  background: var(--fracgui-input-number-range_color);
  border-radius: var(--fracgui-radius-xs);
  border: none;
  transition: 0.15s;
  cursor: pointer;
  z-index: 10;
}
.fracgui-input-container .fracgui-input-content input.fracgui-input-number-range:active::-webkit-slider-thumb {
  background: var(--fracgui-theme-a);
  box-shadow: 0 0 20px var(--fracgui-theme-a);
  opacity: 1;
}
.fracgui-input-container .fracgui-input-content input.fracgui-input-number-range:active::-moz-range-thumb {
  background: var(--fracgui-theme-a);
  box-shadow: 0 0 20px var(--fracgui-theme-a);
  opacity: 1;
}
.fracgui-input-container .fracgui-input-content input.fracgui-input-number-range::-moz-range-track {
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  border-radius: var(--fracgui-radius-sm);
  border: none;
  cursor: pointer;
  z-index: 9;
}
.fracgui-input-container .fracgui-input-content input.fracgui-input-number-range::-webkit-slider-runnable-track {
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  border-radius: var(--fracgui-radius-sm);
  border: none;
  cursor: pointer;
  z-index: 9;
}
.fracgui-input-container .fracgui-input-content .fracgui-controller-number,
.fracgui-input-container .fracgui-input-content .fracgui-controller-text {
  -webkit-appearance: textfield;
  -moz-appearance: textfield;
  appearance: textfield;
  width: 100%;
  min-width: 2rem;
  max-width: var(--fracgui-input-section-2_width);
  height: 1.25rem;
  border: none;
  outline: var(--fracgui-controller_outline);
  font-family: var(--fracgui-controller_font-family);
  font-size: calc(var(--fracgui-font-size) * 0.85);
  font-variation-settings: "wght" 400;
  text-align: center;
  transition-duration: var(--fracgui-transition-duration);
  transition-property: color, background, box-shadow;
  overflow: visible;
}
.fracgui-input-container .fracgui-input-content .fracgui-controller-number::-webkit-inner-spin-button, .fracgui-input-container .fracgui-input-content .fracgui-controller-number::-webkit-outer-spin-button,
.fracgui-input-container .fracgui-input-content .fracgui-controller-text::-webkit-inner-spin-button,
.fracgui-input-container .fracgui-input-content .fracgui-controller-text::-webkit-outer-spin-button {
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  display: none;
}
.fracgui-input-container .fracgui-input-content .fracgui-controller-number.dragging,
.fracgui-input-container .fracgui-input-content .fracgui-controller-text.dragging {
  outline: 1px solid color-mix(in sRGB, var(--fracgui-theme-a) 50%, transparent);
  box-shadow: 0 0 0.75rem color-mix(in sRGB, var(--fracgui-theme-a) 33%, transparent);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-text-container {
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: 0.25rem;
  width: 100%;
  height: 100%;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-text-container .fracgui-controller-text {
  width: 100%;
  max-width: unset;
  height: 1.25rem;
  border: none;
  outline: var(--fracgui-controller_outline);
  font-family: var(--fracgui-controller_font-family);
  font-size: calc(var(--fracgui-font-size) * 0.85);
  font-variation-settings: "wght" 400;
  text-align: center;
  text-align: start;
  padding-left: 0.5rem;
  transition: 0.1s;
  overflow: visible;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-text-container .fracgui-controller-text:hover {
  color: var(--fracgui-controller_color);
  background: var(--fracgui-controller_background);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container {
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  gap: 0.75rem;
  width: 100%;
  margin: 0.25rem 0;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-current-color-container {
  position: relative;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-current-color-container .copy-button {
  position: absolute;
  top: -5px;
  right: -7px;
  height: 1.15rem;
  padding: 3px;
  background: none !important;
  color: var(--fracgui-fg-d);
  filter: brightness(0.75) contrast(0.8);
  backdrop-filter: none;
  opacity: 0;
  z-index: 10;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-current-color-container .copy-button svg .back {
  fill: var(--fracgui-fg-d);
  stroke: var(--fracgui-fg-d);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-current-color-container .copy-button:hover {
  filter: brightness(1) contrast(1);
  backdrop-filter: none;
  color: var(--fracgui-fg-a);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-current-color-container .copy-button:hover svg .back {
  fill: var(--fracgui-fg-a);
  stroke: var(--fracgui-fg-a);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-current-color-container:hover .copy-button {
  opacity: 1;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-current-color-background {
  width: var(--fracgui-input-section-2_width);
  min-width: var(--fracgui-input-section-2_width);
  height: 1.5rem;
  background-image: linear-gradient(45deg, var(--fracgui-bg-a) 25%, transparent 25%), linear-gradient(-45deg, var(--fracgui-bg-a) 25%, transparent 25%), linear-gradient(45deg, transparent 75%, var(--fracgui-bg-a) 75%), linear-gradient(-45deg, transparent 75%, var(--fracgui-bg-a) 75%);
  background-size: 16px 16px;
  background-position: 0 0, 0 8px, 8px -8px, -8px 0px;
  border-radius: var(--fracgui-radius-sm);
  overflow: hidden;
  cursor: pointer;
  clip-path: xywh(0 12% 100% 72% round var(--fracgui-radius-sm));
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-current-color-display {
  height: 100%;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body {
  position: relative;
  display: flex;
  flex-direction: column;
  justify-content: center;
  min-width: 0;
  width: var(--fracgui-input-section-3_width);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-picker-container {
  position: relative;
  display: flex;
  flex-direction: column;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-picker-container .fracgui-input-color-picker-canvas {
  display: flex;
  width: 100%;
  height: 3rem;
  border-radius: var(--fracgui-radius);
  cursor: pointer;
  overflow: hidden;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-picker-container .fracgui-input-color-picker-handle {
  position: absolute;
  top: 0;
  left: 0;
  width: 0.5rem;
  height: 0.5rem;
  translate: -50% -50%;
  border-radius: 50%;
  border: 1px solid var(--fracgui-fg-a);
  box-shadow: 0 0 0.25rem 0rem var(--fracgui-bg-d);
  opacity: 0;
  transition-property: all, opacity;
  transition-delay: 0s, 0s;
  transition-duration: 0.2s, 0.33s;
  transition-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
  pointer-events: none;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-picker-container.expanded .fracgui-input-color-picker-handle {
  opacity: 1;
  transition-delay: 0s, 0.25s;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-picker-container .fracgui-input-color-picker-hue {
  appearance: none;
  width: 99%;
  border-radius: var(--fracgui-radius-sm);
  background: none;
  height: 0.5rem;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-picker-container .fracgui-input-color-picker-hue::-webkit-slider-thumb {
  appearance: none;
  width: 0.25rem;
  height: 0.5rem;
  padding: 0;
  background-color: var(--fracgui-input-number-range_color);
  border: none;
  transition: 0.15s;
  cursor: pointer;
  z-index: 10;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-picker-container .fracgui-input-color-picker-hue::-moz-range-thumb {
  appearance: none;
  width: 0.25rem;
  height: 0.5rem;
  padding: 0;
  background-color: var(--fracgui-input-number-range_color);
  border: none;
  transition: 0.15s;
  cursor: pointer;
  z-index: 10;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-picker-container .fracgui-input-color-picker-hue::-webkit-slider-runnable-track {
  appearance: none;
  background: linear-gradient(to right, hsl(0, 100%, 50%), hsl(60, 100%, 50%), hsl(120, 100%, 50%), hsl(180, 100%, 50%), hsl(240, 100%, 50%), hsl(300, 100%, 50%), hsl(0, 100%, 50%));
  border-radius: var(--fracgui-radius-sm);
  border: none;
  cursor: pointer;
  z-index: 1;
  background-color: none;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-picker-container .fracgui-input-color-picker-hue::-moz-range-track {
  appearance: none;
  background: linear-gradient(to right, hsl(0, 100%, 50%), hsl(60, 100%, 50%), hsl(120, 100%, 50%), hsl(180, 100%, 50%), hsl(240, 100%, 50%), hsl(300, 100%, 50%), hsl(0, 100%, 50%));
  border-radius: var(--fracgui-radius-sm);
  border: none;
  cursor: pointer;
  z-index: 1;
  background-color: none;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-picker-container .fracgui-input-color-picker-alpha {
  appearance: none;
  width: 99%;
  border-radius: var(--fracgui-radius-sm);
  background-color: transparent;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-picker-container .fracgui-input-color-picker-alpha::-webkit-slider-thumb {
  appearance: none;
  width: 0.25rem;
  height: 0.5rem;
  padding: 0;
  background-color: var(--fracgui-input-number-range_color);
  border: none;
  transition: 0.15s;
  cursor: pointer;
  z-index: 10;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-picker-container .fracgui-input-color-picker-alpha::-moz-range-thumb {
  appearance: none;
  width: 0.25rem;
  height: 0.5rem;
  padding: 0;
  background-color: var(--fracgui-input-number-range_color);
  border: none;
  transition: 0.15s;
  cursor: pointer;
  z-index: 10;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-picker-container .fracgui-input-color-picker-alpha::-webkit-slider-runnable-track {
  appearance: none;
  background: linear-gradient(to right, transparent, currentColor);
  border-radius: var(--fracgui-radius-sm);
  border: none;
  cursor: pointer;
  z-index: 1;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-picker-container .fracgui-input-color-picker-alpha::-moz-range-track {
  appearance: none;
  background: linear-gradient(to right, transparent, currentColor);
  border-radius: var(--fracgui-radius-sm);
  border: none;
  cursor: pointer;
  z-index: 1;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-components-container {
  display: grid;
  grid-template-columns: 2rem 1fr;
  align-items: center;
  gap: 0.75rem;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-components-container .fracgui-input-color-components-select-container {
  width: 2rem;
  grid-area: 1/1;
  color: var(--fracgui-fg-d);
  font-size: var(--fracgui-font-size);
}
.fracgui-root[mode=light] .fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-components-container .fracgui-input-color-components-select-container {
  color: var(--fracgui-bg-e);
}

.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-components-container .fracgui-input-color-components-select-container span {
  transition: 0.4s;
  text-shadow: 0 0 0 transparent;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-components-container .fracgui-input-color-components-select-container .fracgui-controller-select-selected {
  font-size: calc(var(--fracgui-font-size) * 0.8);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-components-container:has(input.a.hovering) .fracgui-input-color-components-select-container span.a {
  color: var(--fracgui-fg-a);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-components-container:has(input.a.dragging) .fracgui-input-color-components-select-container span.a {
  color: var(--fracgui-theme-a);
  text-shadow: 0 0 0.5rem var(--fracgui-theme-a);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-components-container:has(input.b.hovering) .fracgui-input-color-components-select-container span.b {
  color: var(--fracgui-fg-a);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-components-container:has(input.b.dragging) .fracgui-input-color-components-select-container span.b {
  color: var(--fracgui-theme-a);
  text-shadow: 0 0 0.5rem var(--fracgui-theme-a);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-components-container:has(input.c.hovering) .fracgui-input-color-components-select-container span.c {
  color: var(--fracgui-fg-a);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-components-container:has(input.c.dragging) .fracgui-input-color-components-select-container span.c {
  color: var(--fracgui-theme-a);
  text-shadow: 0 0 0.5rem var(--fracgui-theme-a);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-components-container:has(input.d.hovering) .fracgui-input-color-components-select-container span.d {
  color: var(--fracgui-fg-a);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-components-container:has(input.d.dragging) .fracgui-input-color-components-select-container span.d {
  color: var(--fracgui-theme-a);
  text-shadow: 0 0 0.5rem var(--fracgui-theme-a);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-components-container .fracgui-input-color-components-text {
  max-width: 5rem;
  grid-area: 1/2;
  opacity: 0;
  transform: translateX(-0.5rem);
  pointer-events: none;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-components-container .fracgui-input-color-components-text.visible {
  opacity: 1;
  transform: translateX(0);
  pointer-events: all;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-components-container .fracgui-input-color-components-numbers-container {
  grid-area: 1/2;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 0.25rem;
  width: 90%;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-components-container .fracgui-input-color-components-numbers-container .fracgui-controller-number {
  height: 1.25rem;
  max-width: unset;
  transition: 0.15s;
  overflow: visible;
  opacity: 0;
  transform: translateX(-0.5rem);
  pointer-events: none;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-color-container .fracgui-input-color-body .fracgui-input-color-components-container .fracgui-input-color-components-numbers-container .fracgui-controller-number.visible {
  opacity: 1;
  transform: translateX(0);
  pointer-events: all;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-button-container {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-switch-container {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: flex-start;
  gap: 0.5rem;
  width: 100%;
  height: 100%;
  height: var(--fracgui-input_height);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-switch-container .fracgui-controller-switch {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: space-between;
  height: 66%;
  width: calc(var(--fracgui-input-section-1_width) * 0.6);
  margin: 0;
  padding: 0;
  border-radius: var(--fracgui-radius-sm);
  overflow: hidden;
  border: none;
  outline: none;
  transition-duration: 0.25s;
  transition-timing-function: cubic-bezier(0.01, 1.06, 0.8, 1.01);
  box-shadow: -1px 1px 7px 0px hsla(250, 10%, var(--fracgui-shadow-lightness), 0.33) inset, -1px 1px 1px 0px hsla(250, 10%, var(--fracgui-shadow-lightness), 0.5) inset;
  background: var(--fracgui-input-number-range_background);
  background-image: radial-gradient(circle at 25% 50% in lab, var(--fracgui-theme-a) 0%, color-mix(in sRGB, var(--fracgui-theme-a) 50%, transparent) 3%, color-mix(in sRGB, var(--fracgui-theme-a) 20%, transparent) 10%, color-mix(in sRGB, var(--fracgui-theme-a) 15%, transparent) 20%, color-mix(in sRGB, var(--fracgui-theme-a) 10%, transparent) 30%, color-mix(in sRGB, var(--fracgui-theme-a) 10%, transparent) 50%, var(--fracgui-input-number-range_background) 100%);
  opacity: 0.7;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-switch-container .fracgui-controller-switch:hover:not(:disabled), .fracgui-input-container .fracgui-input-content .fracgui-input-switch-container .fracgui-controller-switch:focus-visible:not(:disabled) {
  color: var(--fracgui-controller_color);
}
.fracgui-root[mode=light] .fracgui-input-container .fracgui-input-content .fracgui-input-switch-container .fracgui-controller-switch {
  box-shadow: -1px 1px 7px 0px rgba(0, 0, 0, 0.1333333333) inset, -1px 1px 1px 0px rgba(0, 0, 0, 0.1333333333) inset;
  background-image: radial-gradient(circle at 25% 50% in lab, var(--fracgui-theme-a) 3%, color-mix(in sRGB, var(--fracgui-theme-a) 40%, transparent) 3%, color-mix(in sRGB, var(--fracgui-theme-a) 30%, transparent) 10%, color-mix(in sRGB, var(--fracgui-theme-a) 20%, transparent) 20%, color-mix(in sRGB, var(--fracgui-theme-a) 10%, transparent) 30%, color-mix(in sRGB, var(--fracgui-theme-a) 5%, transparent) 50%, var(--fracgui-input-number-range_background) 100%);
}

.fracgui-input-container .fracgui-input-content .fracgui-input-switch-container .fracgui-controller-switch:hover {
  opacity: 1;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-switch-container .fracgui-controller-switch:after {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: var(--fracgui-input-number-range_background);
  box-shadow: -1px 1px 7px 0px rgba(0, 0, 0, 0.8) inset, -1px 1px 1px 0px rgba(0, 0, 0, 0.8) inset;
  opacity: 1;
  transition: 0.33s;
}
.fracgui-root[mode=light] .fracgui-input-container .fracgui-input-content .fracgui-input-switch-container .fracgui-controller-switch:after {
  box-shadow: -1px 1px 7px 0px rgba(0, 0, 0, 0.1333333333) inset, -1px 1px 1px 0px rgba(0, 0, 0, 0.1333333333) inset;
}

.fracgui-input-container .fracgui-input-content .fracgui-input-switch-container .fracgui-controller-switch.active:after {
  opacity: 0;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-switch-container .fracgui-controller-switch .fracgui-controller-switch-thumb,
.fracgui-input-container .fracgui-input-content .fracgui-input-switch-container .fracgui-controller-switch .fracgui-controller-switch-left,
.fracgui-input-container .fracgui-input-content .fracgui-input-switch-container .fracgui-controller-switch .fracgui-controller-switch-right {
  transition-duration: 0.25s;
  transition-timing-function: cubic-bezier(0.01, 1.06, 0.8, 1.01);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-switch-container .fracgui-controller-switch .fracgui-controller-switch-thumb {
  display: flex;
  position: absolute;
  right: 0.25rem;
  width: 1.5rem;
  min-height: 66%;
  background: var(--fracgui-controller_background);
  border: 1px solid var(--fracgui-input-dim_color);
  border-radius: var(--fracgui-radius-xs);
  box-shadow: 0px 0px rgba(166, 167, 173, 0.4117647059), 1px -1px 0px rgba(0, 0, 0, 0.1333333333) inset;
  box-sizing: border-box;
  overflow: hidden;
  z-index: 2;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-switch-container .fracgui-controller-switch .fracgui-controller-switch-thumb {
  right: calc(100% - 1.5rem - 0.25rem);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-switch-container .fracgui-controller-switch.active .fracgui-controller-switch-thumb {
  right: 10%;
  box-shadow: -2px 0px rgba(0, 0, 0, 0.4117647059), -2px 0px color-mix(in sRGB, var(--fracgui-theme-a) 10%, transparent), 1px -1px 1px rgba(0, 0, 0, 0.1333333333) inset;
}
.fracgui-root[mode=light] .fracgui-input-container .fracgui-input-content .fracgui-input-switch-container .fracgui-controller-switch.active .fracgui-controller-switch-thumb {
  box-shadow: -2px 0px rgba(166, 167, 173, 0.4117647059), 1px -1px 1px rgba(0, 0, 0, 0.1333333333) inset;
}

.fracgui-input-container:has(.fracgui-input-buttongrid-container) {
  height: unset;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-buttongrid-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.2rem 2rem;
  width: 100%;
  padding: 0.25rem 0;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-buttongrid-container .fracgui-controller-buttongrid-row {
  display: flex;
  gap: 0.2rem 2rem;
  width: 100%;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-buttongrid-container .fracgui-controller-buttongrid-button.active {
  background: var(--fracgui-controller_background);
  color: var(--fracgui-controller_color);
  color: var(--fracgui-theme-a);
  font-variation-settings: "wght" 800;
}
.fracgui-root[mode=light] .fracgui-input-container .fracgui-input-content .fracgui-input-buttongrid-container .fracgui-controller-buttongrid-button {
  background: var(--fracgui-controller-dim_background);
  color: var(--fracgui-controller_color);
}
.fracgui-root[mode=light] .fracgui-input-container .fracgui-input-content .fracgui-input-buttongrid-container .fracgui-controller-buttongrid-button.active {
  color: var(--fracgui-theme-a);
  background: var(--fracgui-controller_background);
}

.fracgui-input-container:hover .fracgui-controller-number {
  background: var(--fracgui-controller_background);
}
.fracgui-input-container:hover .fracgui-input-number-container .fracgui-input-number-buttons-container .fracgui-input-number-button svg {
  opacity: 0.75;
}
.fracgui-input-container:hover .fracgui-controller-number {
  color: var(--fracgui-fg-b);
}
.fracgui-input-container:hover input.fracgui-input-number-range::-webkit-slider-thumb {
  background-color: var(--fracgui-bg-d);
  transition: 0.15s;
  opacity: 1;
}
.fracgui-input-container:hover input.fracgui-input-number-range::-webkit-slider-thumb:active {
  background-color: var(--fracgui-theme-a);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-select-container {
  contain: content;
  width: 100%;
  height: 100%;
  font-size: calc(var(--fracgui-font-size) * 0.8);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-select-container .fracgui-controller-select-selected {
  line-height: 1.25rem;
  height: 1.25rem;
  box-sizing: content-box;
  background: var(--fracgui-controller-dim_background);
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  filter: unset;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-select-container .fracgui-controller-select-selected::before {
  content: "\u276F";
  position: absolute;
  top: 0.1rem;
  right: 0.5rem;
  margin: auto;
  color: var(--fracgui-bg-d);
  transform: rotate(90deg) translateX(0);
  transition-duration: var(--fracgui-transition-duration);
  transition-property: color, transform, border-color;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-select-container .fracgui-controller-select-selected.active, .fracgui-input-container .fracgui-input-content .fracgui-input-select-container .fracgui-controller-select-selected:hover, .fracgui-input-container .fracgui-input-content .fracgui-input-select-container .fracgui-controller-select-selected:focus-visible, .fracgui-input-container .fracgui-input-content .fracgui-input-select-container .fracgui-controller-select-selected:active {
  background: var(--fracgui-controller_background);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-select-container .fracgui-controller-select-selected.active[contenteditable=true], .fracgui-input-container .fracgui-input-content .fracgui-input-select-container .fracgui-controller-select-selected:hover[contenteditable=true], .fracgui-input-container .fracgui-input-content .fracgui-input-select-container .fracgui-controller-select-selected:focus-visible[contenteditable=true], .fracgui-input-container .fracgui-input-content .fracgui-input-select-container .fracgui-controller-select-selected:active[contenteditable=true] {
  border-color: var(--fracgui-controller-dim_color);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-select-container .fracgui-controller-select-selected.active::before, .fracgui-input-container .fracgui-input-content .fracgui-input-select-container .fracgui-controller-select-selected:hover::before, .fracgui-input-container .fracgui-input-content .fracgui-input-select-container .fracgui-controller-select-selected:focus-visible::before, .fracgui-input-container .fracgui-input-content .fracgui-input-select-container .fracgui-controller-select-selected:active::before {
  color: var(--fracgui-bg-e);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-select-container .fracgui-controller-select-selected.active::before {
  color: var(--fracgui-fg-d);
  transform: rotate(90deg) translateX(2px);
}
.fracgui-input-container .fracgui-input-content .fracgui-input-select-container .fracgui-controller-select-selected[contenteditable=true] {
  cursor: text;
}
.fracgui-input-container .fracgui-input-content .fracgui-input-select-container .fracgui-controller-select-selected[contenteditable=true]:focus-visible, .fracgui-input-container .fracgui-input-content .fracgui-input-select-container .fracgui-controller-select-selected[contenteditable=true]:active {
  border-color: var(--fracgui-theme-a);
}`;var bt=a((s,t,e)=>{let{top:i,bottom:r,left:n,right:o}=t;if(s>0)for(let c=0;c<e.length;c++){let l=e[c].getBoundingClientRect();i>l.bottom||r<l.top||o>l.left||(s=Math.min(s,l.left-o))}else for(let c=0;c<e.length;c++){let l=e[c].getBoundingClientRect();i>l.bottom||r<l.top||n<l.right||(s=Math.max(s,l.right-n))}return s},"collisionClampX"),vt=a((s,t,e)=>{let{top:i,bottom:r,left:n,right:o}=t;if(s>0)for(let c=0;c<e.length;c++){let l=e[c].getBoundingClientRect();n>l.right||o<l.left||r>l.top||(s=Math.min(s,l.top-r))}else for(let c=0;c<e.length;c++){let l=e[c].getBoundingClientRect();n>l.right||o<l.left||i<l.bottom||(s=Math.max(s,l.bottom-i))}return s},"collisionClampY");function L(s=21){return crypto.getRandomValues(new Uint8Array(s)).reduce((t,e)=>t+=(e&=63)<36?e.toString(36):e<62?(e-26).toString(36).toUpperCase():e>62?"-":"_","")}a(L,"nanoid");var ee=a(()=>ke[Math.floor(Math.random()*ke.length)],"randomCSSColorName"),Ct=Object.freeze({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}),ke=Object.keys(Ct);var Se={reset:"\x1B[0m",black:"\x1B[30m",red:"\x1B[31m",green:"\x1B[32m",yellow:"\x1B[33m",blue:"\x1B[34m",magenta:"\x1B[35m",cyan:"\x1B[36m",white:"\x1B[37m",gray:"\x1B[90m",bgBlack:"\x1B[40m",bgRed:"\x1B[41m",bgGreen:"\x1B[42m",bgYellow:"\x1B[43m",bgBlue:"\x1B[44m",bgMagenta:"\x1B[45m",bgCyan:"\x1B[46m",bgWhite:"\x1B[47m",bold:"\x1B[1m",dim:"\x1B[2m",italic:"\x1B[3m",underline:"\x1B[4m"},Ci=a(s=>{let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(s);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null},"hexToRgb"),ie=a(s=>t=>{let e=Ci(s);return e?`\x1B[38;2;${e[0]};${e[1]};${e[2]}m${t}\x1B[0m`:t},"hex"),H=a(s=>t=>`${Se[s]}${t}${Se.reset}`,"color"),U=H("red"),Ee=H("green"),Ce=H("yellow"),$r=H("blue"),Pr=H("magenta"),F=H("cyan"),re=H("gray"),Tt=H("dim"),N=ie("#ff7f50");var Lt=a((s,t=0)=>JSON.stringify(s,Te([]),t),"stringify");function Te(s){let t=[];return function(e,i){if(typeof i>"u")return;if(typeof i=="function")return"[Function]";let r=s.indexOf(this);r!==-1?(s.length=r+1,t.length=r,t[r]=e):(s.push(this),t.push(e));let n=s.indexOf(i);return n!==-1?"[Circular ~"+t.slice(0,n).join(".")+"]":i instanceof Set?Array.from(i):i instanceof Map?Object.fromEntries(Array.from(i.entries()).map(([o,c])=>{let l=[...s];return[o,JSON.parse(JSON.stringify(c,Te(l)))]})):i instanceof Element?`${i.tagName}.${Array.from(i.classList).filter(o=>!o.startsWith("s-")).join(".")}#${i.id}`:(s.length>0&&s.push(i),i)}}a(Te,"serialize");var J=typeof globalThis.requestIdleCallback<"u"?globalThis.requestIdleCallback:typeof globalThis.requestAnimationFrame<"u"?globalThis.requestAnimationFrame:s=>setTimeout(s,0),Le=typeof globalThis?.cancelIdleCallback<"u"?globalThis.cancelIdleCallback:typeof globalThis.cancelAnimationFrame<"u"?globalThis.cancelAnimationFrame:globalThis.clearTimeout;function Ie(s,{maxDepth:t=2,maxLength:e=30,maxSiblings:i=4,preserveRootSiblings:r=!1,preserveFunctions:n=!1,preserveNumbers:o=!1}={}){return c(s);function c(l,h=0){let d=new WeakSet;if(l===null)return l;if(typeof l=="object"){if(d.has(l))return"[Circular]";d.add(l)}switch(typeof l){case"boolean":case"symbol":case"undefined":return l;case"function":return n?l:`[Function: ${l.name}]`;case"string":return l.length<e+3?l:l.slice(0,e)+"..";case"number":{let u=o?l.toString():l.toFixed(e);return u.length>e+3?+u.slice(0,e)+"..":+u}case"bigint":return+l.toString().slice(0,e);case"object":{let u=h>t;if(Array.isArray(l))return u?`[ ..${l.length} ]`:l.length<=i||h===0?l.map(y=>c(y,h+1)):[...l.slice(0,i).map(y=>c(y,h)),`..${l.length-i} more`];let m=Object.keys(l).length;return u?`{..${m} ${m===1?"entry":"entries"}}`:m<=i||r&&h===0?Object.fromEntries(Object.entries(l).map(([y,v])=>[y,c(v,h+1)])):Object.fromEntries(Object.entries(l).slice(0,i).concat([["..",`${m-i} more`]]).map(([y,v])=>[y,c(v,h+1)]))}}return l}}a(Ie,"tldr");var Ti=!1,b=class s{static{a(this,"Logger")}static _BYPASS_STYLES=!1;static _BYPASS_DEFER=!0;title="";options;color;#t;constructor(t,e){typeof t=="string"?(this.title=t,this.options=e??{}):(this.options=t,this.title=t.title??"");let i=e?.fg?.toLowerCase()??ee(),r=i in Ct?Ct[i]:i;return this.color=r,this.#t=s.createLogger(this.title,this.options),this}get deferred(){return!s._BYPASS_DEFER&&this.options?.deferred}log=a((...t)=>{this.#t(...t)},"log");dump=a((...t)=>{this.buffer.length?(t[0].match(/ⓘ|⚠|⛔|💀/)&&this.buffer.unshift(t.shift()),this.consolidateBuffer(),this.#t(...this.buffer,...t)):this.#t(...t),this.buffer=[]},"dump");debug(...t){return import.meta?.env?.VITE_FRACTILS_LOG_LEVEL==="debug"&&this.dump("\u{1F41E}",...t),this}i=ie("#426685")("\u24D8");info(...t){return this.dump(this.i,...t),this}warn(...t){return this.dump(Ce("\u26A0"),...t),this}error(...t){return this.dump(U("\u26D4"),...t),this}fatal(...t){return this.dump(U("\u{1F480}"),...t),this}group(t){let e=this.title+(t?`:${t}`:"");return this.deferred?J(()=>console.group(e)):console.group(e),this}groupCollapsed(t){let e=this.title+(t?`:${t}`:"");return this.deferred?J(()=>console.groupCollapsed(e)):console.groupCollapsed(e),this}groupEnd(){return this.deferred?J(()=>console.groupEnd()):console.groupEnd(),this}buffer=[];consolidateBuffer(){let t=new Map;for(let e of this.buffer)t.set(e,(t.get(e)??0)+1);this.buffer=Array.from(t).map(([e,i])=>i>1?`${e}x${Tt(`${i}`)}`:e)}fn(t,...e){return this.buffer.push(re(t)+Tt("(")+e.map(i=>re(typeof i=="object"?Lt(i):i)).join(", ")+Tt(")")),this}static createLogger(t,e){e??={};let i=e.browser??!0,r=e.server??!1;if(!1)return()=>{};if(!!1&&!r)return()=>{};let n=e.fg||ee(),o=e.bg||"transparent",c=e.css??"";e.styled??=!0;let l=e.styled&&!s._BYPASS_STYLES;e.deferred??=!0;let h=e.deferred&&!s._BYPASS_DEFER&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent);if(!Ti)return()=>{};let d,u="%c%s%c",[m,...y]=t.split(" "),v=[];if(y.length){for(let T of y)v.push(`color:#666;background:${o};padding:0.1rem;filter:saturate(0.25);${c}`,` ${T}`);let w=v.indexOf(v.at(-1)??"");w>=0&&(v[w]=`${v[w]}
`),u="%c%s".repeat(y.length)+`${u}`,t=m}else t=`${t}
`;let p=l?(...w)=>{let T=u;w.forEach(M=>{switch(typeof M){case"bigint":case"number":T+="%d ";break;case"string":T+="%s ";break;case"object":case"boolean":case"undefined":default:T+="%o "}}),console.log(T+"%c%s",`color:${n};background:${o};padding:0.1rem;${c}`,`${t}`,...v,`color:initial;background:${o};padding:0.1rem;${c}`,...w.map(M=>import.meta?.env?.VITEST?Ie(M,{maxDepth:1,maxSiblings:1}):M),`color:#666;background:${o};padding:0.1rem;${c};font-size:0.66rem;`,e?.callsite?`${d}`:"")}:(...w)=>{console.log(`| ${d} |
| ${t} |`,...w)};return h?(...w)=>J(()=>p(...w)):p}};function I(s,t){if(typeof window>"u")return[];if(s===void 0)return[];let e=Array.isArray(s)?s:[s];return t??=document.documentElement,e.flatMap(i=>{if(!i)return[];if(i instanceof HTMLElement)return[i];if(i instanceof Document)return[document.documentElement];if(typeof i=="string"){if(i==="document"||i==="window")return[document.documentElement];if(i.startsWith("#")){let n=document.getElementById(JSON.stringify(i).slice(1));return n?[n]:(!1,[])}}let r=t.querySelectorAll(i);return r.length===0?(!1,[]):Array.from(r)})}a(I,"select");function Li(s,t){return s!=s?t==t:s!==t||s!==null&&typeof s=="object"||typeof s=="function"}a(Li,"safe_not_equal");var At=a(()=>{},"noop");function Ii(s,t,e){if(s==null)return t(void 0),e&&e(void 0),At;let i=s.subscribe(t,e);return i.unsubscribe?()=>i.unsubscribe():i}a(Ii,"subscribe_to_store");var rt=[];function nt(s,t=At){let e=null,i=new Set;function r(c){if(Li(s,c)&&(s=c,e)){let l=!rt.length;for(let h of i)h[1](),rt.push(h,s);if(l){for(let h=0;h<rt.length;h+=2)rt[h][0](rt[h+1]);rt.length=0}}}a(r,"set");function n(c){r(c(s))}a(n,"update");function o(c,l=At){let h=[c,l];return i.add(h),i.size===1&&(e=t(r,n)||At),c(s),()=>{i.delete(h),i.size===0&&e&&(e(),e=null)}}return a(o,"subscribe"),{set:r,update:n,subscribe:o}}a(nt,"writable");function ne(s){let t;return Ii(s,e=>t=e)(),t}a(ne,"get");var Ae=a((s,t,e)=>{let i=t,r=e?.verbose??!1,{set:n,...o}=nt(t,()=>{if(e?.browserOverride||!1){y();let p=a(w=>{w.key===s&&y()},"updateFromStorageEvents");return window.addEventListener("storage",p),()=>window.removeEventListener("storage",p)}else return()=>{}}),c=JSON.stringify,l=JSON.parse,h=t instanceof Map?"Map":t instanceof Set?"Set":"";["Map","Set"].includes(h)&&(c=a(p=>JSON.stringify(Array.from(p.entries())),"serialize"),l=a(p=>{let w=JSON.parse(p);return Array.isArray(w)?t instanceof Map?new Map(w):t instanceof Set?new Set(w):w:(r&&console.error(`Failed to deserialize ${h} from localStorageStore:`,{parsed:w,value:p,initial:t,key:s,options:e}),p)},"deserialize"));let u=a(p=>{i=p,typeof p=="string"&&p.startsWith('"')&&p.endsWith('"')&&(p=l(p)),n(p),m(p),e?.onChange?.(p)},"set"),m=a(p=>{try{p=c(p),localStorage.setItem(s,p)}catch(w){r&&console.error("Failed to set localStorageStore value:",{error:w,key:s,value:p})}},"setItem");if(e?.defer){let p,w=m;m=a(T=>{Le(p),p=J(()=>{w(T)})},"setItem")}if(e?.debounce){let p=setTimeout??(()=>{}),w,T=m;m=a(M=>{clearTimeout(w),w=p(()=>{T(M)},e.debounce)},"setItem")}let y=a(()=>{let p=null;if(p=localStorage.getItem(s)??null,p===null)u(t);else try{let w=l(p);n(w),i=w}catch(w){r&&(console.error("Failed to parse localStorageStore value:",{key:s,localValue:p}),console.error(w))}},"getAndSetFromLocalStorage");return{...o,set:u,update:a(p=>{u(p(i))},"update")}},"localStorageStore");function _(s,t){let e=t?.key?Ae(t.key,s,{debounce:t?.debounce,onChange:t?.onChange}):nt(s);function i(r){r&&r(e)}return a(i,"enhanceStore"),Array.isArray(s)?i(r=>{r.push=n=>{r.update(o=>[...o,n])}}):s instanceof Map&&i(r=>{r.setKey=(n,o)=>{r.update(c=>(c.set(n,o),c))},r.deleteKey=n=>{r.update(o=>{let c=new Map(o);return c.delete(n),c})}}),i(r=>{s instanceof Set&&(r.add=n=>{r.update(o=>new Set(o).add(n))},r.delete=n=>{r.update(o=>{let c=new Set(o);return c.delete(n),c})})}),{...e,isState:!0,get value(){return ne(e)},set value(r){if(r===void 0)throw new Error("Cannot set state to undefined");e.set(r)},refresh(){e.set(ne(e))}}}a(_,"state");function P(s){return s.isState===!0}a(P,"isState");function se(s){return P(s)?s.value:s}a(se,"fromState");var x=a((s,t,e)=>Math.max(Math.min(s,e),t),"clamp");var oe={__type:"ResizableOptions",sides:["right","bottom"],corners:["bottom-right"],grabberSize:6,onResize:a(()=>{},"onResize"),localStorageKey:void 0,visible:!1,color:"var(--fg-d, #1d1d1d)",opacity:.75,borderRadius:"50%",obstacles:void 0,cursors:!0,classes:{default:"resize-grabber",active:"resize-grabbing"},bounds:"document",disabled:!1},Ot=class{static{a(this,"Resizable")}node;static type="Resizable";static initialized=!1;id;opts;disabled;bounds;obstacleEls;size;#t;#e;#i;#n;#s;constructor(t,e){this.node=t,this.id=L(8),this.#t=null,this.#e=[],this.#i=null,this.clickOffset={x:0,y:0},this.onGrab=n=>{if(this.disabled)return;this.node.setPointerCapture(n.pointerId),this.#t=n.currentTarget,this.#t.classList.add(this.opts.classes.active),document.body.classList.add(this.opts.classes.active),this.obstacleEls=I(this.opts.obstacles);let o=this.#t.dataset.side;o.match(/top/)&&(this.clickOffset.y=n.clientY-this.rect.top),o.match(/bottom/)&&(this.clickOffset.y=n.clientY-this.rect.bottom),o.match(/left/)&&(this.clickOffset.x=n.clientX-this.rect.left),o.match(/right/)&&(this.clickOffset.x=n.clientX-this.rect.right),n.preventDefault(),n.stopPropagation(),this.#i?.(),document.addEventListener("pointermove",this.onMove),this.#i=()=>document.removeEventListener("pointermove",this.onMove),this.#l(),document.addEventListener("pointerup",this.onUp,{once:!0})},this.#a=0,this.#c=0,this.#u=0,this.#o=0,this.#r={left:-1/0,top:-1/0,right:1/0,bottom:1/0},this.#l=()=>{let{minWidth:n,maxWidth:o,paddingLeft:c,paddingRight:l,borderLeftWidth:h,borderRightWidth:d,minHeight:u,maxHeight:m,paddingTop:y,paddingBottom:v,borderTopWidth:p,borderBottomWidth:w}=window.getComputedStyle(this.node),T=parseFloat(c)+parseFloat(l)+parseFloat(h)+parseFloat(d),M=parseFloat(y)+parseFloat(v)+parseFloat(p)+parseFloat(w);this.#a=Math.max((parseFloat(n)||0)+T,25),this.#c=Math.min(parseFloat(o)||1/0),this.#u=Math.max((parseFloat(u)||0)+M,25),this.#o=Math.min(parseFloat(m)||1/0),this.#r=this.bounds.getBoundingClientRect()},this.resizeX=(n,o)=>{let c;if(o){if(c=n-this.rect.left,c===0)return this;c=bt(c,this.rect,this.obstacleEls),this.#r&&(c=Math.max(c,this.#r.left-this.rect.left));let l=x(this.rect.width-c,this.#a,this.#c);l===this.#a&&(c=this.rect.width-l),this.translateX+=c,this.node.style.setProperty("translate",`${this.translateX}px ${this.translateY}px`),this.node.style.width=`${l}px`}else{if(c=n-this.rect.right,c===0)return this;c=bt(c,this.rect,this.obstacleEls),this.#r&&(c=Math.min(c,this.#r.right-this.rect.right));let l=x(this.rect.width+c,this.#a,this.#c);this.node.style.width=`${l}px`}return this},this.resizeY=(n,o)=>{let c;if(o){if(c=n-this.rect.top,c!=0){c=vt(c,this.rect,this.obstacleEls),this.#r&&(c=Math.max(c,this.#r.top-this.rect.top));let l=x(this.rect.height-c,this.#u,this.#o);l===this.#u&&(c=this.rect.height-l),this.translateY+=c,this.node.style.setProperty("translate",`${this.translateX}px ${this.translateY}px`),this.node.style.height=`${l}px`}}else if(c=n-this.rect.bottom,c!==0){c=vt(c,this.rect,this.obstacleEls),this.#r&&(c=Math.min(c,this.#r.bottom-this.rect.bottom));let l=x(this.rect.height+c,this.#u,this.#o);this.node.style.height=`${l}px`}return this},this.onMove=n=>{if(!this.#t){console.error("No active grabber");return}let o=n.clientX-this.clickOffset.x,c=n.clientY-this.clickOffset.y,{side:l}=this.#t.dataset;switch(this.#s.fn("onMove").debug(l),l){case"top-left":this.resizeY(c,!0).resizeX(o,!0);break;case"top-right":this.resizeY(c,!0).resizeX(o);break;case"bottom-right":this.resizeY(c).resizeX(o);break;case"bottom-left":this.resizeY(c).resizeX(o,!0);break;case"top":this.resizeY(c,!0);break;case"right":this.resizeX(o);break;case"bottom":this.resizeY(c);break;case"left":this.resizeX(o,!0);break}this.node.dispatchEvent(new CustomEvent("resize")),this.size.set({width:this.node.offsetWidth,height:this.node.offsetHeight}),this.opts.onResize({width:this.node.offsetWidth,height:this.node.offsetHeight})},this.onUp=()=>{this.#i?.(),document.body.classList.remove(this.opts.classes.active),this.#t?.classList.remove(this.opts.classes.active),this.node.dispatchEvent(new CustomEvent("release"))},this.opts=O([oe,e],{concatArrays:!1}),this.disabled=this.opts.disabled,this.#s=new b("resizable",{fg:"GreenYellow",deferred:!1}),this.#s.fn("constructor").info({opts:this.opts,this:this}),this.node.classList.add("fractils-resizable"),this.#n=this.opts.grabberSize*3,this.bounds=I(this.opts.bounds)[0]??globalThis.document?.documentElement,this.obstacleEls=I(this.opts.obstacles),this.generateStyles();let{offsetWidth:i,offsetHeight:r}=t;if(this.size=_({width:i,height:r},{key:this.opts.localStorageKey}),this.opts.localStorageKey){let{width:n,height:o}=this.size.value;n===0||o===0?this.size.set({width:this.node.offsetWidth,height:this.node.offsetHeight}):((this.opts.corners.length||this.opts.sides.some(c=>c.match(/left|right/)))&&(t.style.width=n+"px"),(this.opts.corners.length||this.opts.sides.some(c=>c.match(/top|bottom/)))&&(t.style.height=o+"px")),t.dispatchEvent(new CustomEvent("resize"))}if(this.createGrabbers(),+this.node.style.minWidth>this.boundsRect.width){console.error("Min width is greater than bounds width.");return}this.size.set({width:this.node.offsetWidth,height:this.node.offsetHeight})}get boundsRect(){return this.bounds.getBoundingClientRect()}createGrabbers(){for(let[t,e]of[...this.opts.sides.map(i=>[i,"side"]),...this.opts.corners.map(i=>[i,"corner"])]){let i=document.createElement("div");i.classList.add(`${this.opts.classes.default}-${this.id}`),i.classList.add(`${this.opts.classes.default}-${e}-${this.id}`),i.classList.add(`${this.opts.classes.default}-${t}-${this.id}`),i.dataset.side=t,i.addEventListener("pointerdown",this.onGrab),this.#e.push(()=>i.removeEventListener("pointerdown",this.onGrab)),this.node.appendChild(i)}}clickOffset;onGrab;get translateX(){return+this.node.dataset.translateX||0}set translateX(t){this.node.dataset.translateX=String(t)}get translateY(){return+this.node.dataset.translateY||0}set translateY(t){this.node.dataset.translateY=String(t)}get rect(){return this.node.getBoundingClientRect()}#a;#c;#u;#o;#r;#l;resizeX;resizeY;onMove;onUp;generateStyles(){this.#s.fn("generateStyles").debug("Generating global styles for",this);let t=`
			.resize-grabber-${this.id} {
				position: absolute;
				display: flex;

				opacity: ${this.opts.visible?this.opts.opacity:0};
				border-radius: ${this.opts.borderRadius};
				border-radius: inherit;

				transition: opacity 0.1s;
			}

			.fractils-resizable:not(.fractils-grabbing) .resize-grabber-${this.id}:hover {
				opacity: ${this.opts.opacity/2};
			}

			.resize-grabber-${this.id}:active {
				opacity: ${this.opts.opacity*.75};
			}
		`;this.opts.cursors&&(t+=`
				.resize-grabbing-${this.id} *, .resize-grabber-${this.id}:active {
					cursor: grabbing !important;
				}
			`);let e=a(d=>this.opts.cursors?`
				cursor: ${d};`:"","cursor"),i=this.opts.grabberSize/2,r=`transparent 20%, ${this.opts.color} 33%, ${this.opts.color} 66%, transparent 75%, transparent 100%`,n=98;this.opts.sides.includes("top")&&(t+=`
			.${this.opts.classes.default}-top-${this.id} {
				${e("ns-resize")}
				top: ${-i}px;
				left: ${50-n*.5}%;

				width: ${n}%;
				height: ${this.opts.grabberSize}px;

				background: linear-gradient(to bottom, ${r});
			}
		`),this.opts.sides.includes("right")&&(t+=`
			.${this.opts.classes.default}-right-${this.id} {
				${e("ew-resize")}
				right: ${-i}px;
				top: ${50-n*.5}%;

				width: ${this.opts.grabberSize}px;
				height: ${n}%;

				background: linear-gradient(to left, ${r});
			}
		`),this.opts.sides.includes("bottom")&&(t+=`
			.${this.opts.classes.default}-bottom-${this.id} {
				${e("ns-resize")}
				bottom: ${-i}px;
				left: ${50-n*.5}%;

				width: ${n}%;
				height: ${this.opts.grabberSize}px;

				background: linear-gradient(to top, ${r});
			}
		`),this.opts.sides.includes("left")&&(t+=`
				.${this.opts.classes.default}-left-${this.id} {
					${e("ew-resize")}
					left: ${-i}px;
					top: ${50-n*.5}%;

					width: ${this.opts.grabberSize}px;
					height: ${n}%;

					background: linear-gradient(to right, ${r});
				}
			`),t+=".fractils-grabbing .resize-grabber { cursor: default }";let o=this.#n,c={"top-left":"100% 100%","top-right":"0% 100%","bottom-left":"100% 0%","bottom-right":"0% 0%"},l=a((d,u)=>{if(!this.opts.corners.includes(d))return;let m=`${this.opts.classes.default}-${d}-${this.id}`,y=d.replace(this.opts.classes.default,"").split("-");t+=`
				.${m} {${e(u)}
					${y[0]}: 0px;
					${y[1]}: 0px;
					width: ${o}px;
					height: ${o}px;
				}
				.${m}::after {
					content: '';
					width: 100%;
					height: 100%;
					background: radial-gradient(farthest-corner at ${c[d]}, transparent 70%, ${this.opts.color} 86%);
					border-radius: 15%;
				}
			`},"corner");l("top-left","nwse-resize"),l("top-right","nesw-resize"),l("bottom-left","nesw-resize"),l("bottom-right","nwse-resize");let h=document.createElement("style");h.innerHTML=t,document.head.appendChild(h)}dispose(){for(let t of this.#e)t();this.#i?.()}};function Oe(s){return s!==void 0}a(Oe,"isDefined");function $t(s){return typeof s=="string"}a($t,"isString");function $e(s){return s instanceof HTMLElement}a($e,"isHTMLElement");var E=class{static{a(this,"EventManager")}_unlisteners=new Map;_handlers=new Map;_listenerGroups=new Map;_log=new b("EventManager",{fg:"beige"});constructor(t){t&&this.registerEvents([...t])}registerEvents(t){for(let e of t)this._handlers.set(e,new Map)}on(t,e){if(this._log.fn("on").debug(this),!this._handlers.has(t))return this._log.warn(`Event "${String(t)}" is not registered.`,this),"";this._log.debug("new listener:",{event:t,callback:e});let i=L();return this._handlers.get(t).set(i,e),i}emit(t,...e){this._log.fn("emit").debug({event:t});let i=this._handlers.get(t);if(i)for(let r of i.values())r(...e)}listen=a((t,e,i,r,n)=>{let o=L();return t.removeEventListener(e,i,r),t.addEventListener(e,i,r),this._unlisteners.set(o,()=>{t.removeEventListener(e,i,r)}),n&&this.group(n,o),o},"listen");add=a((t,e)=>{let i=L();return this._unlisteners.set(i,t),e&&this.group(e,i),i},"add");group(t,e){return this._listenerGroups.has(t)||this._listenerGroups.set(t,new Set),this._listenerGroups.get(t).add(e),this}unlisten(t){return this._unlisteners.get(t)?.(),this._unlisteners.delete(t)}clear(){for(let t of this._unlisteners.values())t();return this._unlisteners.clear(),this._listenerGroups.clear(),this.clearHandlers(),this}clearHandlers(){for(let t of this._handlers.values())t.clear();return this._handlers.clear(),this}clearGroup(t){let e=this._listenerGroups.get(t);if(e){for(let i of e){let r=this._unlisteners.get(i);r&&r(),this._unlisteners.delete(i)}this._listenerGroups.delete(t)}return this}dispose(){this.clear(),this.clearHandlers()}};var ae=a(s=>{if(typeof s!="object")throw new Error("element must be an object");if("computedStyleMap"in s)return s.computedStyleMap();{let t=getComputedStyle(s),e=new Map;for(let i=0;i<t.length;i++){let r=t[i],n=t.getPropertyValue(r);n&&e.set(r,n)}return e}},"getStyleMap"),Pt=a((s,t)=>ae(s).get(t),"getStyle");function Pe(s,t=void 0,e=!!1){let i=a(()=>typeof localStorage>"u"?(e||console.warn(`localStorage is not available for key "${s}"`),!0):!1,"bail");return{get(){if(i())return t;let r=localStorage.getItem(s);return r?JSON.parse(r):t},set(r){i()||localStorage.setItem(s,JSON.stringify(r))},get value(){return this.get()},set value(r){this.set(r)}}}a(Pe,"persist");function Rt(s,t="top-right",e){let{bounds:i,margin:r}=Object.assign({bounds:void 0,margin:10},e),n=typeof s=="string"?I(s)[0]?.getBoundingClientRect():s instanceof Element?s.getBoundingClientRect():s;if(!n)throw new Error("Invalid node: "+s);let o=i==="window"&&typeof window<"u"?{x:0,y:0,width:window.innerWidth,height:window.innerHeight}:typeof i=="string"?I(i)[0]?.getBoundingClientRect():i??{x:0,y:0,width:100,height:100};if(!o)throw new Error("Invalid bounds: "+i);let c=typeof r=="number"?{x:r,y:r}:r;if(!("x"in c)||!("y"in c))throw new Error("Invalid margin: "+JSON.stringify(c));switch(t){case"center":case"center-center":return{x:o.width/2-n.width/2,y:o.height/2-n.height/2};case"top-left":case"left-top":return{x:c.x,y:c.y};case"top-center":case"center-top":return{x:o.width/2-n.width/2,y:c.y};case"top-right":case"right-top":return{x:o.width-n.width-c.x,y:c.y};case"bottom-left":case"left-bottom":return{x:c.x,y:o.height-n.height-c.y};case"bottom-center":case"center-bottom":return{x:o.width/2-n.width/2,y:o.height-n.height-c.y};case"bottom-right":case"right-bottom":return{x:o.width-n.width-c.x,y:o.height-n.height-c.y};case"left-center":case"center-left":return{x:c.x,y:o.height/2-n.height/2};case"right-center":case"center-right":return{x:o.width-n.width-c.x,y:o.height/2-n.height/2};default:throw new Error("Invalid placement: "+t)}}a(Rt,"place");var Ai={default:"fractils-draggable",dragging:"fractils-dragging",dragged:"fractils-dragged",cancel:"fractils-cancel"},yt={__type:"DraggableOptions",bounds:"body",axis:"both",userSelectNone:!0,ignoreMultitouch:!1,disabled:!1,position:{x:0,y:0},placementOptions:{margin:0},cancel:void 0,handle:void 0,obstacles:void 0,classes:Ai,onDragStart:a(()=>{},"onDragStart"),onDrag:a(()=>{},"onDrag"),onDragEnd:a(()=>{},"onDragEnd"),onCollision:a(()=>{},"onCollision"),transform:void 0,localStorageKey:void 0},zt=class{static{a(this,"Draggable")}node;static initialized=!1;opts;#t;disabled;clickOffset;clientToNodeOffset;rect;#e;boundsEl;handleEls;cancelEls;obstacleEls;bounds;#i;#n;#s;#a;_storage;_position;get position(){return this._position}set position(t){this._position=t,this.moveTo(t),this.updateLocalStorage()}#c;eventTarget;positionStore;#u;#o;#r;#l;constructor(t,e){this.node=t,this.#t=!1,this.disabled=!1,this.clickOffset={x:0,y:0},this.clientToNodeOffset={x:0,y:0},this.rect={top:0,right:0,bottom:0,left:0},this.#e="",this.bounds={left:-1/0,top:-1/0,right:1/0,bottom:1/0},this.#i=-1/0,this.#n=-1/0,this.#s=1/0,this.#a=1/0,this._position={x:0,y:0},this.#u=new Set,this.#o=new E,this.#r=()=>{},this.dragStart=r=>{if(this.disabled||r.button===2||this.opts.ignoreMultitouch&&!r.isPrimary||r.composedPath().some(u=>u.classList?.contains(this.opts.classes.cancel)))return;if(this.obstacleEls=I(this.opts.obstacles),!1)for(let u of this.obstacleEls)u.dataset.outline=u.style.outline,u.style.outline="2px dotted #f007";if($t(this.opts.handle)&&$t(this.opts.cancel)&&this.opts.handle===this.opts.cancel)throw new Error("`handle` selector can't be same as `cancel` selector");if(this.#g(this.handleEls))throw new Error("Element being dragged can't be a child of the element on which `cancel` is applied");let n=r.composedPath()[0];if(!this.handleEls.some(u=>u.contains(n)||u.shadowRoot?.contains(n))||this.#g([n]))return;this.#l.fn("dragStart").debug("Dragging initiated."),r.stopPropagation(),this.eventTarget=this.handleEls.length===1?this.node:this.handleEls.find(u=>u.contains(n)),this.#t=!0,this.canMoveX&&(this.clickOffset.x=r.clientX-this.x),this.canMoveY&&(this.clickOffset.y=r.clientY-this.y);let{top:o,right:c,bottom:l,left:h}=this.node.getBoundingClientRect();this.rect={top:o,right:c,bottom:l,left:h},this.bounds&&(this.clientToNodeOffset={x:r.clientX-h,y:r.clientY-o}),this.positionStore.set({x:this.x,y:this.y}),this.#c(),this.#d(),this.node.dispatchEvent(new CustomEvent("grab"));let{cursor:d}=getComputedStyle(this.node);this.node.setPointerCapture(r.pointerId),this.node.style.cursor="grabbing",this.#r=()=>{this.node.style.cursor=d},this.#p(),this.#h()},this.drag=r=>{if(!this.#t)return;r.preventDefault(),r.stopPropagation(),this.node.classList.add(this.opts.classes.dragging),this.node.classList.add(this.opts.classes.dragged);let n=r.clientX-this.clickOffset.x,o=r.clientY-this.clickOffset.y,c={x:n,y:o};this.moveTo(c),this.#b()},this.dragEnd=()=>{if(this.#t){if(!1)for(let r of this.obstacleEls)r.style.outline=r.dataset.outline??"none";this.node.classList.remove(this.opts.classes.dragging),this.opts.userSelectNone&&(document.body.style.userSelect=this.#e),this.clickOffset={x:0,y:0},this.clientToNodeOffset={x:0,y:0},this._position={x:this.x,y:this.y},this.#t=!1,this.#r(),this.node.dispatchEvent(new CustomEvent("release")),setTimeout(()=>this.node.classList.remove(this.opts.classes.dragged),0),this.#m(),this.updateLocalStorage()}},this.resize=()=>{this.#c(),this.#d(),this.moveTo(this.position)},this.#d=()=>{let r=parseFloat(this.node.style.left)||0;this.#i=-r,this.#s=this.bounds.right-this.bounds.left-(this.rect.right-this.rect.left)-r;let n=parseFloat(this.node.style.top)||0;if(this.#n=-n,this.#a=this.bounds.bottom-this.bounds.top-n-(this.rect.bottom-this.rect.top),this.boundsEl){let o=ae(this.boundsEl);this.#i-=parseFloat(o.get("padding-left")),this.#s-=parseFloat(o.get("padding-right")),this.#n-=parseFloat(o.get("padding-top")),this.#a-=parseFloat(o.get("padding-bottom"))}},this.updateLocalStorage=()=>{this.opts.localStorageKey&&(this.#l.fn("updateLocalStorage").debug("Updating position in localStorage:",`{ x: ${this._position.x}, y: ${this._position.y} }`,this),this._storage&&this._storage.set(this._position))},this.clearLocalStorage=()=>{this._storage&&this.opts.localStorageKey&&localStorage.removeItem(this.opts.localStorageKey)},this.#g=r=>this.cancelEls.some(n=>r.some(o=>n.contains(o))),this.#f=(r,n)=>{let o=this.eventData;this.node.dispatchEvent(new CustomEvent(r,{detail:o})),n?.(o)},this.#p=()=>{this.#f("dragstart",this.opts.onDragStart)},this.#m=()=>{this.#f("dragend",this.opts.onDragEnd)},this.#b=()=>{this.#f("drag",this.opts.onDrag)},this.#h=()=>{this.node.dispatchEvent(new CustomEvent("update",{detail:this}))},this.opts=Object.assign({},yt,e),this.#l=new b("draggable "+Array.from(this.node.classList).join("."),{fg:"SkyBlue"}),this.#c=this.#v(this.opts.bounds),this.opts.position=this.resolvePosition(this.opts.position),this.#l.fn("constructor").debug({opts:this.opts,this:this}),this.positionStore=nt(this.opts.position),this.node.classList.add(this.opts.classes.default);let i=this.opts.position;if(e?.localStorageKey){this._storage=Pe(e.localStorageKey,i);let r=this._storage.get();r&&(i.x=r.x,i.y=r.y)}if(this.x=i.x,this.y=i.y,this.node.style.setProperty("touch-action","none"),this.handleEls=this.opts.handle?I(this.opts.handle,this.node):[this.node],this.cancelEls=I(this.opts.cancel,this.node),this.obstacleEls=I(this.opts.obstacles),this.#o.listen(this.node,"pointerdown",this.dragStart),this.#o.listen(window,"pointerup",this.dragEnd),this.#o.listen(window,"pointermove",this.drag),this.#o.listen(window,"resize",this.resize),this.#o.add(this.positionStore.subscribe(({x:r,y:n})=>{this.node.style.setProperty("translate",`${r}px ${n}px 1px`)})),i!==yt.position){let{top:r,right:n,bottom:o,left:c}=this.node.getBoundingClientRect();this.rect={top:r,right:n,bottom:o,left:c},this.#c(),this.#d(),this.moveTo(i),this._position={x:this.x,y:this.y}}}get x(){return+this.node.dataset.translateX||0}set x(t){this.node.dataset.translateX=String(t)}get y(){return+this.node.dataset.translateY||0}set y(t){this.node.dataset.translateY=String(t)}get canMoveX(){return/(both|x)/.test(this.opts.axis)}get canMoveY(){return/(both|y)/.test(this.opts.axis)}get eventData(){return{x:this.x,y:this.y,rootNode:this.node,eventTarget:this.eventTarget}}get isControlled(){return!!this.opts.position}dragStart;drag;dragEnd;resize;#d;moveTo(t){if(this.#l.fn("moveTo").debug("Moving to:",t,this),this.canMoveX){this.bounds&&(t.x=x(t.x,this.#i,this.#s));let e=t.x-this.x;if(e!==0){let i=bt(e,this.rect,this.obstacleEls);this.rect.left+=i,this.rect.right+=i,this.x+=i}}if(this.canMoveY){this.bounds&&(t.y=x(t.y,this.#n,this.#a));let e=t.y-this.y;if(e!==0){let i=vt(e,this.rect,this.obstacleEls);this.rect.top+=i,this.rect.bottom+=i,this.y+=i}}if(!this.opts.transform)this.positionStore.set({x:this.x,y:this.y});else{let e=this.opts.transform?.({x:this.x,y:this.y,rootNode:this.node,eventTarget:this.eventTarget});if(e&&"x"in e&&"y"in e){let{x:i,y:r}=e;this.positionStore.set({x:i,y:r})}}this.#h()}update(t=this.position){this.#l.fn("update").debug("Updating position:",t,this),this.moveTo(t)}updateLocalStorage;clearLocalStorage;#v(t){if(!t)return()=>{};if(t&&typeof t=="object"&&("left"in t||"right"in t||"top"in t||"bottom"in t))return()=>{this.bounds={left:-1/0,right:1/0,top:-1/0,bottom:1/0,...this.opts.bounds}};let e=$e(t)?t:t==="body"?document.body:t==="parent"?this.node.offsetParent:$t(t)?I(t)[0]:Oe(t)?void 0:document.documentElement;if(!e)throw new Error("Invalid bounds option provided: "+t);this.boundsEl=e;let i=new ResizeObserver(()=>{this.resize(),this.#h()});return i.observe(e),this.#u.add(()=>i.disconnect()),this.#h(),()=>this.bounds=e.getBoundingClientRect()}resolvePosition(t){let e=yt.position;if(!t)return e;if(typeof t=="string")return Rt(this.node,t,{bounds:this.boundsEl?.getBoundingClientRect(),...this.opts.placementOptions});if(typeof t=="object"&&("x"in t||"y"in t))return{...e,...t};throw new Error("Invalid position: "+JSON.stringify(t),{cause:{defaultPos:e,pos:t}})}#g;#f;#p;#m;#b;#h;dispose(){this.#o.dispose()}};function st(s,t){return typeof s>"u"||s===!0?t:s===!1?!1:typeof s=="object"?O([t,s],{concatArrays:!1}):s}a(st,"resolveOpts");function Z(s){return typeof s=="object"&&s!==null}a(Z,"isObject");var Mt={__type:"WindowManagerStorageOptions",key:"window-manager",size:!0,position:!0,debounce:50},Ft={__type:"WindowManagerOptions",resizable:oe,draggable:yt,zFloor:10,preserveZ:!1,bounds:void 0,obstacles:void 0,localStorage:void 0},_t=class{static{a(this,"WindowManager")}windows=new Map;opts;_log=new b("WindowManager",{fg:"lightseagreen"});_evm=new E;constructor(t){t??=Ft,t.__type="WindowManagerOptions",this.opts=Object.freeze(this._resolveOptions(t)),this._log.fn("constructor").info({opts:this.opts,options:t,this:this})}add=a((t,e)=>{let i=new ce(this,t,e);this.windows.set(i.id,i);let r=this._evm.listen(t,"grab",this.select);return{destroy:a(()=>{i.dispose(),this.windows.delete(i.id),this._evm.unlisten(r)},"destroy")}},"add");update(){this.windows.forEach(({resizableInstance:t,draggableInstance:e})=>{e&&e.update(),t&&(t.size=t.size)})}applyZ(){let t=0;for(let e of this.windows.values())e.node.style.setProperty("z-index",String(this.opts.zFloor+t++));return this}select=a(t=>{let e=t.currentTarget,i=this.windows.get(e.id);if(!i)throw new Error("Unable to resolve instance from selected node: "+e.id);if(this.windows.size>1){let r=e.style.getPropertyValue("z-index");e.style.setProperty("z-index",String(this.opts.zFloor+this.windows.size)),e.dataset.keepZ==="true"||this.opts.preserveZ?addEventListener("pointerup",()=>e.style.setProperty("z-index",r),{once:!0}):(this.windows.delete(i.id),this.windows.set(i.id,i),this.applyZ())}return this},"select");_resolveOptions(t,e=Ft){let i={};return i.zFloor=t?.zFloor??e.zFloor,i.preserveZ=t?.preserveZ??e.preserveZ,i.draggable=st(t?.draggable,e.draggable),i.resizable=st(t?.resizable,e.resizable),i.obstacles=t?.obstacles??e.obstacles,i.bounds=t?.bounds??(Z(t?.draggable)?t.draggable.bounds:e.bounds),typeof t?.obstacles>"u"?i.obstacles&&(Z(i.draggable)&&(i.draggable.obstacles=i.obstacles),Z(i.resizable)&&(i.resizable.obstacles=i.obstacles)):Z(i.draggable)&&typeof i.draggable.obstacles>"u"&&(i.draggable.obstacles=t.obstacles),i.bounds&&(i.draggable&&(Z(t?.draggable)&&t?.draggable.bounds&&(i.draggable.bounds=t.draggable.bounds),i.draggable.bounds=i.bounds),i.resizable&&(i.resizable.bounds=i.bounds)),typeof t?.localStorage<"u"&&(t.localStorage===!0?i.localStorage=Mt:typeof t.localStorage=="object"&&(i.localStorage=Object.assign({},Mt,t.localStorage),Z(i.draggable)&&(i.localStorage.position===!1?i.draggable.localStorageKey=void 0:i.draggable.localStorageKey=i.localStorage.key),Z(i.resizable)&&(i.resizable.localStorageKey=i.localStorage.key))),i}dispose(){this._log.fn("dispose").info(this),this._evm?.dispose();for(let t of this.windows.values())t?.dispose();this.windows.clear()}},ce=class{static{a(this,"WindowInstance")}manager;node;draggableInstance;resizableInstance;id;position;size;constructor(t,e,i){this.manager=t,this.node=e,this.position=_({x:0,y:0}),this.size=_({width:0,height:0}),this.id=e.id||i?.id||`wm-instance-${L(8)}`,e.id||=this.id;let r=t._resolveOptions(i,t.opts),n=r.draggable,o=r.resizable;if(i?.localStorage===!1)n&&(n.localStorageKey=void 0),o&&(o.localStorageKey=void 0);else{if(typeof n=="object"&&n.localStorageKey!==void 0){let c=[];typeof n.localStorageKey>"u"?typeof t.opts.localStorage=="object"?c.push(t.opts.localStorage.key):c.push(Mt.key):n.localStorageKey&&c.push(n.localStorageKey),c.push("wm",`${this.manager.windows.size}`,"position"),n.localStorageKey=c.join("::")}if(typeof o=="object"&&o.localStorageKey!==void 0){let c=[];typeof o.localStorageKey>"u"?typeof t.opts.localStorage=="object"?c.push(t.opts.localStorage.key):c.push(Mt.key):o.localStorageKey&&c.push(o.localStorageKey),c.push("wm",`${this.manager.windows.size}`,"size"),o.localStorageKey=c.join("::")}}this.draggableInstance=new zt(e,n||{disabled:!0}),this.resizableInstance=new Ot(e,o||{disabled:!0}),r?.preserveZ&&(e.dataset.keepZ="true")}dispose(){this.resizableInstance?.dispose(),this.draggableInstance?.dispose()}};function C(s){if(typeof s!="object"||s===null)throw console.error("Error: Invalid object",s),new Error("`entries()` util called with invalid object: "+s);return Object.entries(s)}a(C,"entries");function Re(s){if(typeof s!="object"&&s===null)throw console.error("Error: Invalid object",s),new Error("`keys()` util called with invalid object.");return Object.keys(s)}a(Re,"keys");function Bt(s){if(typeof s!="object"&&s===null)throw console.error("Error: Invalid object",s),new Error("`values()` util called with invalid object.");return Object.values(s)}a(Bt,"values");function k(s){return typeof s=="function"?s:()=>s}a(k,"toFn");function Oi(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var c=s.length-1;c>=0;c--)(o=s[c])&&(n=(r<3?o(n):r>3?o(t,e,n):o(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n}a(Oi,"_ts_decorate");function ze(s,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,t)}a(ze,"_ts_metadata");var Dt={__type:"TooltipOptions",text:"",placement:"top",anchor:"node",delay:250,delayOut:0,offsetX:"0%",offsetY:"0%",animation:{duration:300,durationOut:150,easing:"cubic-bezier(0.23, 1, 0.320, 1)"},style:void 0,hideOnClick:!1},$=class{static{a(this,"Tooltip")}node;__type;element;parent;showing;opts;_text;_evm;_animPositions;_delayInTimer;_delayOutTimer;constructor(t,e){this.node=t,this.__type="Tooltip",this.showing=!1,this._evm=new E,this.show=()=>{this.showing||this.text&&(clearTimeout(this._delayInTimer),clearTimeout(this._delayOutTimer),this._delayInTimer=setTimeout(async()=>{this.element&&this.parent?.appendChild(this.element),this.showing=!0,this.element?.animate([{opacity:"0",transform:this._animPositions.from},{opacity:"1",transform:this._animPositions.to}],{duration:this.opts.animation.duration,easing:this.opts.animation.easing,fill:"forwards"}),this._updatePosition(),this._maybeWatchAnchor()},this.opts.delay))},this.hide=()=>{clearTimeout(this._delayInTimer),clearTimeout(this._delayOutTimer),this._delayOutTimer=setTimeout(async()=>{this.showing&&(this.showing=!1,this._watcherId&&this._evm.unlisten(this._watcherId),await this.element?.animate([{opacity:"1",transform:this._animPositions.to},{opacity:"0",transform:this._animPositions.from}],{duration:this.opts.animation.durationOut,easing:this.opts.animation.easing,fill:"forwards"}).finished,this.unmount())},this.opts.delayOut)},this._mounted=!1,this._updatePosition=r=>{if(!this.element)return;let n=this.element.getBoundingClientRect();this.element.innerHTML!==this.text&&(this.element.innerHTML=String(this.text)),r?.type==="pointermove"&&(this._mouse={x:r.clientX,y:r.clientY});let o=this._getAnchorRects();if(!o)return;let c=0,l=0,h=4;switch(this.element.classList.add("fractils-tooltip-"+this.placement),this.placement){case"top":c=o.x.left+window.scrollX+o.x.width/2-n.width/2,l=o.y.top+window.scrollY-n.height-h;break;case"bottom":c=o.x.left+window.scrollX+o.x.width/2-n.width/2,l=o.y.top+window.scrollY+o.y.height+h;break;case"left":c=o.x.left+window.scrollX-n.width-h,l=o.y.top+window.scrollY+o.y.height/2-n.height/2;break;case"right":c=o.x.left+window.scrollX+o.x.width+h,l=o.y.top+window.scrollY+o.y.height/2-n.height/2;break}let d=this.parent?.getBoundingClientRect();d&&(this.element.style.left=`calc(${c-d.left}px + ${this.opts.offsetX})`,this.element.style.top=`calc(${l-d.top}px + ${this.opts.offsetY})`)},this._mouse={x:0,y:0},this._watchingAnchor=!1,this._watchingFinished=!1,this._watchTimeout=void 0;let i=O([Dt,e]);if(this.opts=i,this.placement=i.placement,this._text=k(i.text),this.parent=e?.parent??document.getElementById("svelte")??document.body,this.element=f("div",{classes:["fractils-tooltip"],innerHTML:String(this._text()),style:e?.style}),i.style)for(let[r,n]of C(i.style))r&&n&&this.element?.style.setProperty(r,n);this._evm.listen(t,"pointerenter",this.show),this._evm.listen(t,"pointerleave",this.hide),this._evm.listen(t,"pointermove",this._updatePosition),this._evm.listen(t,"click",()=>{i.hideOnClick?this.hide():this.refresh()})}refresh(){this.element&&(this.element.innerHTML=String(this.text),setTimeout(()=>this._updatePosition(),0),this._maybeWatchAnchor(),clearTimeout(this._delayInTimer),clearTimeout(this._delayOutTimer))}get text(){return this._text()}set text(t){this._text=k(t),this.element&&(this.element.innerHTML=String(this._text()))}get placement(){return this.opts.placement}set placement(t){switch(this.opts.placement=t,t){case"top":this._animPositions={from:"translateY(4px)",to:"translateY(0)"};break;case"bottom":this._animPositions={from:"translateY(-4px)",to:"translateY(0)"};break;case"left":this._animPositions={from:"translateX(4px)",to:"translateX(0)"};break;case"right":this._animPositions={from:"translateX(-4px)",to:"translateX(0)"}}}get offsetX(){return this.opts.offsetX}set offsetX(t){this.opts.offsetX=t,this._updatePosition()}get offsetY(){return this.opts.offsetY}set offsetY(t){this.opts.offsetY=t,this._updatePosition()}show;hide;_mounted;mount(){this._mounted||(this._mounted=!0,this.element&&this.parent?.appendChild(this.element))}unmount(){this._mounted&&(this._mounted=!1,this.element&&this.parent?.removeChild(this.element))}_updatePosition;_mouse;_getAnchorRects(){let t=a(i=>{if(!i)return this.node?.getBoundingClientRect();switch(typeof i){case"string":switch(i){case"node":return this.node?.getBoundingClientRect();case"mouse":return{left:this._mouse.x+window.scrollX,top:this._mouse.y+window.scrollY,width:0,height:0};default:{let r=document.querySelector(i);return r?r.getBoundingClientRect():(!1,this.node?.getBoundingClientRect())}}case"object":return i&&"x"in i&&"y"in i?"separate":i instanceof HTMLElement?i.getBoundingClientRect():(!1,this.node?.getBoundingClientRect());default:return!1,this.node?.getBoundingClientRect()}},"getRect"),e=t(this.opts.anchor);if(e==="separate"){let i=t(this.opts.anchor.x),r=t(this.opts.anchor.y);return!i||!r?void 0:{x:i,y:r}}if(e)return{x:e,y:e}}_watcherId;_maybeWatchAnchor(){let t=a(i=>{if(!i)return;let r=i instanceof HTMLElement?i:this.node?.querySelector(i)??document.querySelector(i),n=a(()=>{r&&this._watch(r)},"watchAnchor");r&&(this._watcherId&&this._evm.unlisten(this._watcherId),this._watcherId=this._evm.listen(r,"transitionrun",n,{},"anchor"))},"maybeWatch"),e=a(i=>i instanceof HTMLElement?i:typeof i=="string"?i==="node"?this.node:i==="mouse"?null:i:null,"getAnchor");if(this.opts.anchor&&typeof this.opts.anchor=="object"&&"x"in this.opts.anchor&&"y"in this.opts.anchor){let i=e(this.opts.anchor.x),r=e(this.opts.anchor.y);i===r?t(i):(t(i),t(r))}else t(e(this.opts.anchor))}_watchingAnchor;_watchingFinished;_watchTimeout;_watch(t){if(this._watchingAnchor)return;this._watchingFinished=!1,this._watchingAnchor=!0;let e=a(()=>{this._watchingFinished=!0,this._watchingAnchor=!1,this.element?.style.setProperty("transition-duration","0.1s"),i&&t.removeEventListener("transitionend",i)},"complete"),i=a(()=>{this._watchingFinished||e()},"timeout");if(!this.showing){e();return}clearTimeout(this._watchTimeout),this._watchTimeout=setTimeout(()=>{this._watchingFinished||e()},500),t.removeEventListener("transitionend",i),t.addEventListener("transitionend",i),this._watchingFinished||(this.node?.style.setProperty("transition-duration","0s"),Me(()=>this._watchingFinished?!0:(this._updatePosition(),!1)))}dispose(){this._watchTimeout&&clearTimeout(this._watchTimeout),this._evm.dispose(),this.element?.remove()}static style=`
		.fractils-tooltip {
			position: absolute;

			min-width: 3rem;
			max-width: auto;
			min-height: auto;
			max-height: auto;
			padding: 4px 8px;

			opacity: 0;
			color: var(--fg-a, #fff);
			background-color: var(--bg-a, #000);
			border-radius: var(--radius-sm, 4px);
			box-shadow: var(--shadow, 0rem 0.0313rem 0.0469rem hsl(var(--shadow-color) / 0.02),
				0rem 0.125rem 0.0938rem hsl(var(--shadow-color) / 0.02),
				0rem 0.1563rem 0.125rem hsl(var(--shadow-color) / 0.025),
				0rem 0.1875rem 0.1875rem hsl(var(--shadow-color) / 0.05),
				0rem 0.3125rem 0.3125rem hsl(var(--shadow-color) / 0.05),
				0rem 0.4375rem 0.625rem hsl(var(--shadow-color) / 0.075));

			text-align: center;
			font-size: var(--font-size-sm, 12px);

			z-index: 1000;
			pointer-events: none;
			transition: opacity 0.1s;
		}

		.fractils-tooltip .fractils-hotkey {
			filter: contrast(1.1);
			background: var(--fractils-hotkey_background, #1118);
			background: var(--fractils-hotkey_background, color-mix(in sRGB, var(--bg-c) 66%, transparent));
			color: var(--fractils-hotkey_color, var(--fg-a, #fff));
			padding: 0px 3px;
			border-radius: 2px;
			box-shadow: 0 0 2px rgba(0, 0, 0, 0.33);
		}

		:root[theme='dark'] .fractils-tooltip .fractils-hotkey {
			background: var(--fractils-hotkey_background, color-mix(in sRGB, var(--bg-d) 100%, transparent));
		}
	`};$=Oi([B,ze("design:type",Function),ze("design:paramtypes",[Object,typeof Partial>"u"?Object:Partial])],$);var le=a((s,t)=>{let e=new $(s,t);return{update(i){Object.assign(e.opts,i),e.refresh()},destroy(){e.dispose()}}},"tooltip");function Me(s){requestAnimationFrame(()=>{s()||Me(s)})}a(Me,"tickLoop");function f(s,t){let e=globalThis?.document?.createElement(s);if(t){if(t.classes&&e.classList.add(...t.classes),t.id&&(e.id=t.id),t.innerHTML&&(e.innerHTML=t.innerHTML),t.textContent&&(e.textContent=t.textContent),t.innerText&&(e.innerText=t.innerText),t.cssText&&(e.style.cssText=t.cssText),t.dataset&&Object.assign(e.dataset,t.dataset),t.value&&e instanceof HTMLInputElement&&(e.value=t.value),t.type&&e.setAttribute("type",t.type),t.min&&e.setAttribute("min",String(t.min)),t.max&&e.setAttribute("max",String(t.max)),t.step&&e.setAttribute("step",String(t.step)),t.attributes)for(let[i,r]of C(t.attributes))e.setAttribute(i,r);if(t.style)for(let[i,r]of C(t.style))e.style[i]=String(r);if(t.variables)for(let[i,r]of C(t.variables))e.style.setProperty(i,String(r));if(t.parent&&t.parent.appendChild(e),t.tooltip&&(e.tooltip={},t.tooltipInstance?e.tooltip=t.tooltipInstance:e.tooltip=new $(e,t.tooltip)),t.children)for(let i of t.children??[]){if(e===null)throw new Error("This should never happen");i&&e.appendChild(i)}t.onclick&&e.addEventListener("click",t.onclick)}if(!1){let i=new Error().stack;$i(i,e)}return e}a(f,"create");function $i(s,t){let e=Ri(s);e&&t.addEventListener("contextmenu",i=>{i.metaKey&&i.altKey&&(i.preventDefault(),i.stopPropagation(),console.log(i.target),Pi(e))},{capture:!1})}a($i,"maybeAddOpenInEditorEventListener");function Pi(s){let t="/__open-in-editor?file="+s;fetch(t).then(e=>{console.log(e.status,t)}).catch(e=>{console.error("Failed to open file in editor:",e)})}a(Pi,"openFileInEditor");function Ri(s){let t=s?.split(`
`)[2].trim(),e=/http:\/\/[^ )]+/,i=/\?t=\d+/,r=t?.match(e)?.[0]?.replace(i,"");if(r)try{return new URL(r).pathname.slice(1)}catch(n){console.error("Failed to parse file from stack:",n)}return null}a(Ri,"parseFileFromStack");function B(s){return class extends s{static initialized=!1;static stylesheet;constructor(...t){if(super(...t),typeof globalThis.document<"u"){let e=this.constructor;if(!e.style||e.initialized)return;e.initialized=!0,e.stylesheet??=f("style",{parent:document.head,innerHTML:e.style})}else throw new Error("@styled components can only be used in the browser")}}}a(B,"styled");function zi(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var c=s.length-1;c>=0;c--)(o=s[c])&&(n=(r<3?o(n):r>3?o(t,e,n):o(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n}a(zi,"_ts_decorate");function Fe(s,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,t)}a(Fe,"_ts_metadata");var ot=class{static{a(this,"RenameSVG")}class="fracgui-icon-rename";element;classes=[this.class,"fracgui-icon"];constructor(){this.element=f("div",{classes:this.classes,innerHTML:`
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" >
                    <path class="cursor top" fill="none" stroke="currentColor" d="M5 4h1a3 3 0 0 1 3 3 3 3 0 0 1 3-3h1" vector-effect="non-scaling-stroke"></path>
                    <path class="cursor bottom"fill="none" stroke="currentColor" d="M13 20h-1a3 3 0 0 1-3-3 3 3 0 0 1-3 3H5" vector-effect="non-scaling-stroke"></path>
                    <rect class="box full" fill="currentColor" stroke="none" x="1" y="8" width="18" height="8" rx="2" vector-effect="non-scaling-stroke"></rect>
                    <path class="cursor middle"fill="none" stroke="currentColor" d="M9 7v10" vector-effect="non-scaling-stroke"></path>
                </svg>
            `.replaceAll(/\t|\n/g,"")})}static style=`
        .fracgui-icon-rename {
            width: 1.5rem;
            height: 1.5rem;

            margin-right: 0.5rem;
            padding: 0.125rem;

            color: var(--fracgui-controller-dim_color);
            opacity: 0.5;

            transition: opacity 0.15s;

            z-index: 1;
            cursor: pointer;

            pointer-events: all;
        }

        .fracgui-icon-rename:hover {
            opacity: 1;
        }

        .fracgui-icon-rename svg {
            width: 100%;
            height: 100%;

            pointer-events: none;
        }

        .fracgui-icon-rename path {
            color: var(--fracgui-controller-dim_color);
            /* stroke: var(--fracgui-controller-dim_color); */
        }
        .fracgui-icon-rename .cursor {
            transform: translate(2px, 0) scale(1, 0.9);

            transition: 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            transition-delay: 0s;
            transition-property: opacity, transform;
            transform-origin: center;
        }
        .fracgui-icon-rename:hover .cursor, .fracgui-icon-rename.active .cursor {
            transform: translate(0, 0);
            transform: translate(0, 0) scale(1, 0.9);
        }
        .fracgui-icon-rename.active .cursor {
            color: var(--fracgui-theme-a);
            animation: blink 1.5s infinite;
            animation-delay: 0.5s;
        }

        @keyframes blink {
            0%, 45%, 80% {
                opacity: 1;
            }
            50%, 75% {
                opacity: 0;
            }
        }

        .fracgui-icon-rename .box {
            color: var(--fracgui-folder-dim_color);

            opacity: 0;
            transform: scale(0);

            transition: 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            transition-property: opacity, transform;
            transform-origin: center;
        }
        .fracgui-icon-rename:hover .box, .fracgui-icon-rename.active .box {
            opacity: 0.25;
            transform: scale(1.1);
            color: var(--fracgui-controller_color);
        }
        .fracgui-icon-rename:hover .box {
            transform: scale(1);
        }
        
        .fracgui-icon-rename.disabled {
            opacity: 0;
            pointer-events: none;
            cursor: default;
        }
    `};ot=zi([B,Fe("design:type",Function),Fe("design:paramtypes",[])],ot);function ue(s,t){return typeof s!="object"||s===null||["object","function"].includes(t)?typeof s===t:"__type"in s&&s.__type===t}a(ue,"isType");function Mi(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var c=s.length-1;c>=0;c--)(o=s[c])&&(n=(r<3?o(n):r>3?o(t,e,n):o(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n}a(Mi,"_ts_decorate");function Be(s,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,t)}a(Be,"_ts_metadata");var at=class{static{a(this,"SaveSVG")}element;constructor(){this.element=f("div",{classes:["fracgui-icon-save","fracgui-icon"],innerHTML:`
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                    <g class="Frame">
                        <path class="back-group" fill="currentColor" fill-rule="evenodd" d="M6.127 21A3.496 3.496 0 0 0 9 22.5h10a3.5 3.5 0 0 0 3.5-3.5V9c0-1.19-.593-2.24-1.5-2.873V7.5c.314.418.5.937.5 1.5v10a2.5 2.5 0 0 1-2.5 2.5H9a2.489 2.489 0 0 1-1.5-.5H6.127Z" class="Subtract" clip-rule="evenodd"/>
                        <rect width="16" height="16" x="3" y="3" fill="currentColor" stroke-width="1.5" class="front" rx="2"/>
                        <g class="plus">
                            <path stroke="currentColor" stroke-linecap="round" stroke-width="1.5" d="M11 8v7" class="vertical"/>
                            <path stroke="currentColor" stroke-linecap="round" stroke-width="1.5" d="M14.5 11.5h-7" class="horizontal"/>
                        </g>
                    </g>
                </svg>
            `.replaceAll(/\t|\n/g,"")})}static style=`
        .fracgui-icon-save {
            width: 1.5rem;
            height: 1.5rem;

            color: var(--fracgui-controller-dim_color);
            margin-right: 0.25rem;
            opacity: 0.5;

            transition: opacity 0.15s;

            z-index: 1;
            cursor: pointer;
        }

        .fracgui-icon-save:hover {
            opacity: 1;
        }

        .fracgui-icon-save .back-group {
            transition: 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            transition-property: opacity, transform;
            transition-delay: 0s;
            
            opacity: 0;
            transform: translate(-0.25rem, -0.25rem);
        }
        .fracgui-icon-save:hover .back-group {
            opacity: 1;
            transition-delay: 0.25s;
            transform: translate(0, 0);
        }

        .fracgui-icon-save .plus {
            transition: 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            transition-property: color, transform;
            transform-origin: center;

            transform: scale(1.5);
        }
        .fracgui-icon-save:hover .plus {
            transform: scale(1);
            color: var(--fracgui-bg-a);
        }

        .fracgui-icon-save .front {
            transition: 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            transition-property: transform, opacity;

            transform: scale(1.25);
            opacity: 0;
        }
        .fracgui-icon-save:hover .front {
            transform: scale(1);
            opacity: 1;
        }

        .fracgui-icon-save svg {
            width: 100%;
            height: 100%;
        }
    `};at=Mi([B,Be("design:type",Function),Be("design:paramtypes",[])],at);var Nt=class{static{a(this,"PresetManager")}gui;parentFolder;__type;__version;defaultPreset;activePreset;presets;folder;_defaultPresetId;_defaultPresetTitle;_presetSnapshot;_presetsInput;_manageInput;_renamePresetButton;_initialized;_log;constructor(t,e,i){this.gui=t,this.parentFolder=e,this.__type=Object.freeze("PresetManager"),this.__version=Object.freeze("1.0.0"),this._defaultPresetId="fracgui-default-preset",this._defaultPresetTitle="default",this._initialized=!1,this._toggleRename=()=>{this._presetsInput.select.elements.selected.getAttribute("contenteditable")?this._handleRename():this._enableRename()},this._blurLatch=!1,this._enableRename=(r=!0)=>{this._log.fn("_enableRename").debug({this:this});let n=this._presetsInput.select.elements.selected;if(n.classList.contains("disabled")){this._log.warn("Cannot rename default preset.");return}if(this._blurLatch){this._blurLatch=!1,clearTimeout(this._blurLatchTimer);return}this._renamePresetButton.element.classList.add("active"),this._presetsInput.select.disableClicks=!0,n.setAttribute("contenteditable","true"),n.focus();let o=document.createRange();o.selectNodeContents(n),r&&o.collapse(!1);let c=window.getSelection();c?.removeAllRanges(),c?.addRange(o),this.folder.evm.listen(n,"blur",this._handleRename,{},"preset-manager-rename"),this.folder.evm.listen(window,"keydown",this._handleKeydown,{},"preset-manager-rename")},this._handleRename=r=>{if(this._log.fn("_disableRename").debug({e:r,this:this}),this._presetsInput.select.disableClicks=!1,this._presetsInput.select.elements.selected.removeAttribute("contenteditable"),this._renamePresetButton.element.classList.remove("active"),this.folder.evm.clearGroup("preset-manager-rename"),r?.type==="blur"){this._blurLatch=!0,clearTimeout(this._blurLatchTimer),setTimeout(()=>{this._blurLatch=!1},300);let n=r.target?.textContent??"";n!==this.activePreset.value.title&&this._renamePreset(n)}},this._handleKeydown=r=>{this._log.fn("_handleKeydown").debug({key:r.key,e:r,this:this}),r.key==="Enter"&&(r.preventDefault(),this._handleRename()),r.key==="Escape"&&this._handleRename()},this._log=new b(`PresetManager ${t.folder.title}`,{fg:"slateblue"}),this._log.fn("constructor").debug({options:i,this:this}),this.opts=i,this.opts.localStorageKey??="fracgui::presets",this.activePreset=_(this.opts.defaultPreset??{},{key:this.opts.localStorageKey+"::active"}),this.presets=_(this.opts.presets??[],{key:this.opts.localStorageKey}),this.opts.autoInit!==!1&&this.init(),Object.keys(this.activePreset.value).length&&this.activePreset.value.id!==this._defaultPresetId&&Promise.resolve().then(()=>{console.log("loading active preset",this.activePreset.value),this.gui.load(this.activePreset.value),this.gui._undoManager.clear()})}opts;get defaultPresetIsActive(){return this.activePreset.value.id===this._defaultPresetId}async init(){if(this.opts.disabled){this._log.debug("Aborting initialization: disabled by options.");return}return this._initialized=!0,this.folder=await this.addGui(this.parentFolder,this.opts.defaultPreset),this}set(t){this._log.fn("set").debug({value:t,this:this}),this.activePreset.set(t)}_renamePreset(t){if(this._log.fn("_renamePreset").debug({this:this,title:t}),!this._isInitialized())throw new Error("PresetManager not initialized.");let e=this.activePreset.value;this.presets.update(i=>{if(!e)throw new Error("No preset found.");if(e.id===this._defaultPresetId)throw new Error("Cannot rename default preset.");return e.title=t,this.activePreset.set(e),i.map(r=>r.id===e.id?e:r)}),this._refresh()}_resolveUnusedTitle(t){if(this._log.fn("resolveUnusedTitle").debug({this:this,title:t}),!this._isInitialized())throw new Error("PresetManager not initialized.");let e=this.presets.value,i=0,r=t;for(;e.some(n=>n.title===r);)i++,r=t+` (${i})`;return r}_resolveDefaultPreset(t){if(!this._isInitialized())throw new Error("PresetManager not initialized.");return t??=this.presets.value.find(e=>e.id===this._defaultPresetId),t||(t=this.gui.save(this._defaultPresetTitle,this._defaultPresetId),this.presets.push(t)),t}async addGui(t,e){if(this._log.fn("add").debug({this:this,parentFolder:t,defaultPreset:e}),!this._isInitialized())throw new Error("PresetManager not initialized.");await new Promise(l=>setTimeout(l,0));let i=t.addFolder("presets",{closed:!1,hidden:!1,children:[]});if(i.on("mount",()=>{i.graphics?.connector?.svg.style.setProperty("filter","saturate(0.1)"),i.graphics?.icon.style.setProperty("filter","saturate(0)")}),this.defaultPreset=e??this._resolveDefaultPreset(),Object.keys(this.activePreset.value).length||this.activePreset.set(this.defaultPreset),!this.activePreset.value)throw new Error("No active preset.");if(!this.activePreset.value.id)throw new Error("No active preset id.");let r=a(l=>{let h=Array.isArray(l)?this.gui.folder.title+" presets":l.title,d=new Blob([JSON.stringify(l,null,2)],{type:"application/json"}),u=URL.createObjectURL(d),m=document.createElement("a");m.href=u,m.download=`${h}.json`,m.click(),URL.revokeObjectURL(u)},"download"),n=a(()=>{let l=document.createElement("input");l.type="file",l.accept=".json",l.onchange=async h=>{let d=h.target.files?.[0];if(!d)return;let u=new FileReader;u.onload=async m=>{let y=m.target?.result,v=JSON.parse(y);if(Array.isArray(v))for(let p of v)ue(p,"GuiPreset")?this.put(p):console.warn("Invalid preset:",p);else ue(v,"GuiPreset")?this.put(v):console.warn("Invalid preset:",v);this._refresh()},u.readAsText(d)},l.click()},"upload"),o=a((l,h)=>`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" class="fracgui-icon fracgui-icon-${l}">${h}</svg>`,"createIcon");this._manageInput=i.addButtonGrid({value:[[{text:"update",id:"update",onClick:a(()=>{let{id:l,title:h}=this.activePreset.value,d=this.gui.save(h,l);this.put(d)},"onClick"),disabled:a(()=>this.defaultPresetIsActive,"disabled")},{text:"delete",onClick:a(()=>{let l;this.presets.update(h=>(l=h.findIndex(d=>d.id===this.activePreset.value.id),h.splice(l,1),h)),this.activePreset.set(this.presets.value[l??0]??this.defaultPreset),this._refresh()},"onClick"),disabled:a(()=>this.defaultPresetIsActive,"disabled")},{text:o("copy",'<rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path>'),id:"copy",tooltip:{text:"Copy",delay:0,placement:"bottom",hideOnClick:!0},style:{maxWidth:"1.5rem",padding:"0.3rem"},onClick:a(()=>{navigator.clipboard?.writeText(JSON.stringify(this.activePreset.value,null,2))},"onClick"),disabled:a(()=>this.defaultPresetIsActive,"disabled")},{text:o("paste",'<rect width="8" height="4" x="8" y="2" rx="1" ry="1"></rect><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>'),id:"paste",tooltip:{text:"Paste",delay:0,placement:"bottom",hideOnClick:!0},style:{maxWidth:"1.5rem",padding:"0.3rem"},onClick:a(async({button:l})=>{l.disabled=!0;try{let h=await navigator.clipboard.readText();if(console.log(h),h){let d=JSON.parse(h);typeof d=="object"&&d.__type==="GuiPreset"&&this.put(d)}}catch(h){console.error(h)}l.disabled=!1},"onClick"),disabled:a(()=>this.defaultPresetIsActive,"disabled")},{text:o("download",'<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" x2="12" y1="15" y2="3"></line></svg>'),id:"download",tooltip:{text:"Download",delay:0,placement:"bottom",hideOnClick:!0},style:{maxWidth:"1.5rem",padding:"0.3rem"},onClick:a(()=>{r(this.activePreset.value)},"onClick"),disabled:a(()=>this.defaultPresetIsActive,"disabled")},{text:o("download-all",'<path stroke-linecap="round" stroke-linejoin="round" d="M21 14v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" /><path stroke-linecap="round" stroke-linejoin="round" d="M21 11v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" /><path stroke-linecap="round" stroke-linejoin="round" d="M21 17v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" /><path stroke-linecap="round" stroke-linejoin="round" d="m7 8 5 5 5-5" /><path  stroke-linecap="round" stroke-linejoin="round" d="M12 13V1" />'),id:"download-all",tooltip:{text:"Download All",delay:0,placement:"bottom",hideOnClick:!0},style:{maxWidth:"1.5rem",padding:"0.3rem"},onClick:a(()=>{r(this.presets.value)},"onClick"),disabled:a(()=>this.presets.value.length<=1,"disabled")},{id:"upload",text:o("upload",'<path stroke-linecap="round" stroke-linejoin="round" d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" /><path stroke-linecap="round" stroke-linejoin="round" d="m17 8-5-5-5 5" /><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v12" />'),tooltip:{text:"Upload",delay:0,placement:"bottom",hideOnClick:!0},style:{maxWidth:"1.5rem",padding:"0.3rem"},onClick:a(()=>{n()},"onClick")}]],order:1,resettable:!1,disabled:a(()=>this.defaultPresetIsActive&&this.presets.value.length===1,"disabled")}),this._presetsInput=i.addSelect({__type:"SelectInputOptions",options:this.presets.value,labelKey:"title",order:-1,value:this.activePreset.value,resettable:!1,disabled:a(()=>this.defaultPresetIsActive&&this.presets.value.length===1,"disabled")}),this._presetsInput.on("change",({value:l})=>{this._log.fn("_presetsInput.on(change)").debug({value:l,this:this}),this.gui.load(l),this.activePreset.set(l),this._refreshInputs()}),this._presetsInput.on("open",()=>{this._log.fn("_presetsInput.on(open)").debug(),this._presetSnapshot=this.gui.save("__snapshot__")}),this._presetsInput.on("cancel",()=>{this._log.fn("_presetsInput.on(cancel)").debug(),this._presetSnapshot&&(this.gui.load(this._presetSnapshot),this._refreshInputs())});let c=new at;return c.element.tooltip=new $(c.element,{text:"Save",delay:0,placement:"bottom",hideOnClick:!0}),this._presetsInput.listen(c.element,"click",()=>{this._log.fn("newPresetButton.on(click)").debug(),this.put()}),this._renamePresetButton=new ot,this._renamePresetButton.element.tooltip=new $(this._renamePresetButton.element,{delay:0,placement:"bottom",hideOnClick:!0,text:a(()=>this._renamePresetButton.element.classList.contains("active")?"":this.defaultPresetIsActive?"Can't rename default preset":"Rename","text")}),this._presetsInput.listen(this._renamePresetButton.element,"click",this._toggleRename),this._presetsInput.elements.content.prepend(this._renamePresetButton.element),this._presetsInput.elements.content.prepend(c.element),this._refreshInputs(),i}put(t){if(this._log.fn("saveNewPreset"),!this._isInitialized())throw new Error("PresetManager not initialized.");if(!this._presetsInput)throw new Error("No select input.");t??=this.gui.save(this._resolveUnusedTitle("preset"),L());let e=this.presets.value.find(i=>i.id===t.id);e?(this._log.debug("preset exists. replacing with:",{preset:t,existing:e}),this.presets.update(i=>{let r=i.findIndex(n=>n.id===t.id);return i[r]=t,i})):(this._log.debug("pushing preset:",{preset:t,existing:e}),this.presets.push(t)),this.set(t),this._refresh(),this._enableRename()}delete(t){if(this._log.fn("deletePreset").debug({this:this,preset:t}),!this._isInitialized())throw new Error("PresetManager not initialized.");let e=typeof t=="string"?t:t.id;this.presets.update(i=>{let r=i.findIndex(n=>n.id===e);if(r===-1)throw new Error(U("Error deleting preset:")+" Preset not found.");return i.splice(r,1),i}),this.activePreset.set(this.presets.value[0]??this.defaultPreset)}_isInitialized(){return this._initialized}_toggleRename;_blurLatch;_blurLatchTimer;_enableRename;_handleRename;_handleKeydown;_refreshInputs(){let t=this.defaultPresetIsActive;this._renamePresetButton.element.classList.toggle("disabled",t),this._renamePresetButton.element.toggleAttribute("disabled",t),this._manageInput.refresh(),this._log.fn("_refreshInputs").debug({disableRename:t,this:this})}_refresh(){this._log.fn("_refresh").debug("Refreshing options and setting input.",{this:this}),this._presetsInput.options=this.presets.value.map(e=>({label:e.title,value:e}));let t=this.activePreset.value;this._presetsInput.set({label:t.title,value:t}),this._refreshInputs()}dispose(){this._initialized=!1,this._presetsInput.dispose(),this._renamePresetButton.element.tooltip.dispose(),this._renamePresetButton.element.remove}};var Gt=z({title:"default",prefix:"themer",vars:{color:{base:{"theme-a":"#00bcd4","dark-a":"#0B0B11","dark-b":"#1b1d29","dark-c":"#46465e","dark-d":"#55566a","dark-e":"#787b89","light-a":"#ffffff","light-b":"#c9ccd7","light-c":"#a9adba","light-d":"#777D8F","light-e":"#5F6377"},dark:{},light:{}}}});function De(s,t){let e=[],i=[];for(let r of s)t(r)?e.push(r):i.push(r);return[e,i]}a(De,"partition");function Ne(s){let t=parseInt(s.replace("#",""),16),e=t>>16&255,i=t>>8&255,r=t&255;return[e,i,r].join(", ")}a(Ne,"hexToRgb");var Fi={autoInit:!0,persistent:!0,theme:Gt,themes:[],mode:"system",localStorageKey:"fractils::themer",vars:{}},jt=class{static{a(this,"Themer")}node;theme;themes;activeThemeTitle;mode;wrapper;_initialized=!1;_persistent;_key;_unsubs=[];_targets=new Set;_log;constructor(t="document",e){let i=O([Fi,e]);this._key=String(i.localStorageKey),i.wrapper&&(this.wrapper=i.wrapper),this.node=t==="document"?document.documentElement:typeof t=="string"?I(t)[0]??document.documentElement:t,this._log=new b(`themer ${this.node.classList[0]}`,{fg:"DarkCyan"}),this._log.fn(Ee("constructor")).info({node:t,opts:i,this:this}),this.theme=_(z(i.theme,i.vars)),this.themes=_(i.themes.map(n=>z(n,i.vars))),this.activeThemeTitle=_(i.theme.title,{key:this._key+"::activeTheme"});let r=this.activeThemeTitle.value;if(i.theme.title!==r){let n=this.themes.value.find(o=>o.title===r);n&&this.theme.set(n)}this.mode=_(i.mode,{key:this._key+"::mode"}),this._persistent=i.persistent??!0,this.#t(this.theme,n=>{this._log.fn(N("theme.subscribe")).debug({v:n,this:this}),this._initialized&&(this.activeThemeTitle.set(n.title),this.applyTheme())}),this.#t(this.mode,n=>{if(this._log.fn(N("mode.subscribe")).debug("v",n,{this:this}),typeof n>"u")throw new Error("Mode is undefined.");this._initialized&&this.applyTheme()}),this._targets.add(this.wrapper??this.node.parentElement??this.node),i.autoInit&&this.init()}#t(t,e){this._unsubs.push(t.subscribe(i=>e(i)))}init(){let t=this.themes.value,e=this.theme.value;if(this._log.fn(F("init")).debug({theme:this.theme,this:this}),!(typeof document>"u"))return this._initialized?this:(this._initialized=!0,t.find(i=>i.title===e.title)||this.create(e,{overwrite:!0,save:!1}),this.load()?.applyTheme(),this)}get modeColors(){return this.theme.value.vars.color[this.activeMode]}get baseColors(){return this.theme.value.vars.color.base}get allColors(){return{...this.baseColors,...this.modeColors}}get activeMode(){let t=this.mode.value,e=typeof t=="object"&&"value"in t?t.value:t;return e==="system"?this.#e:e}get#e(){return window.matchMedia("(prefers-color-scheme: light)").matches?"light":(window.matchMedia("(prefers-color-scheme: dark)").matches,"dark")}create=a((t,e)=>{this._log.fn(F("addTheme")).debug({newTheme:t,options:e,this:this});let i=structuredClone(t),r=e?.overwrite??!1,n=e?.save??!0,[o,c]=De(this.themes.value,h=>h.title===i.title),l=o.length>0;if(!r&&l){c.push(structuredClone(o[0]));let h=0;for(;;){let d=`${i.title} (${h++})`;if(!c.some(u=>u.title===d)){i.title=d;break}if(h>100){this._log.fn(F("addTheme")).debug(U("Runaway loop detected.")+" Aborting.",{this:this});break}}}return n&&this.save(),this},"create");delete(t){this._log.fn(F("deleteTheme")).debug({themeOrTitle:t,this:this});let e=typeof t=="string"?t:t.title,i=this.themes.value,r=i.find(c=>c.title===e);if(!r)throw this._log.error("`themeTitle` not found in `themes` array.",{themeTitle:e,this:this}),new Error("Theme not found.");let n=i.indexOf(r)-1,o=this.theme.value.title===e;return this.themes.set(this.themes.value.filter(c=>c.title!==e)),o&&this.theme.set(i[n]??i.at(-1)),this.save(),this}getTheme(t){return this.themes.value.find(e=>e.title===t)}applyTheme=a(t=>{if(this._log.fn(F("applyTheme")).debug({theme:this.theme.value.title,targets:this._targets,this:this}),!("document"in globalThis))return;let e=this.theme.value;if(!e)throw this._log.error("theme not found").debug({theme:e,this:this}),new Error("Theme not found.");return this.#i(e,t),this.node.setAttribute("theme",e.title),this.node.setAttribute("mode",this.activeMode),this.wrapper?.setAttribute("theme",e.title),this.wrapper?.setAttribute("mode",this.activeMode),this},"applyTheme");fromJSON(t){let e=this.theme.value.title!==t.activeTheme,i=t.themes.find(r=>r.title===t.activeTheme);if(i??=this.themes.value.find(r=>r.title===t.activeTheme),!i)throw this._log.error("`activeTheme` not found in `themes` array.",{activeTheme:t.activeTheme,json:t,this:this}),new Error("Theme not found.");this.themes.set(t.themes),this.mode.set(t.mode),e&&this.applyTheme()}toJSON(){return{themes:this.themes.value,activeTheme:this.theme.value.title,mode:this.mode.value}}load=a(()=>{if(this._log.fn(F("load")).debug({this:this}),this._persistent&&"localStorage"in globalThis){let t=localStorage.getItem(this._key+"::themer");t&&this.fromJSON(JSON.parse(t))}return this},"load");save(){if(this._log.fn(F("save")).debug({this:this}),!("localStorage"in globalThis)||!this._persistent)return;let t=this.toJSON(),e=`${this._key}themer`in localStorage;try{e&&JSON.parse(JSON.stringify(t))===JSON.parse(localStorage.getItem(`${this._key}themer`)||"")||localStorage.setItem(`${this._key}themer`,JSON.stringify(t))}catch(i){throw console.error(U("Error")+": Failed to save to localStorage.",{error:i,this:this}),new Error("Failed to save to localStorage.")}return t}clear(){this._log.fn(F("clear")).debug({this:this}),"localStorage"in globalThis&&(localStorage.removeItem(`${this._key}themer`),this.themes.set([Gt]),this.theme.set(Gt),this.mode.set("system"))}addTarget(t){this._targets.add(t),this.applyTheme([t])}#i=a((t,e=this._targets)=>{let i=t;this._log.fn(F("applyStyleProps")).debug({config:i,this:this});let r=i.vars.color[this.activeMode];if(!r)throw this._log.error("`theme` not found in `config`.",{theme:r,config:i,"this.activeMode":this.activeMode,this:this}),new Error("Theme not found.");let n=new Map;for(let o of e){for(let[c,l]of C(i.vars))if(c==="color")for(let[h,d]of[...C(l.base),...C(l[this.activeMode])])o.style.setProperty(`--${i.prefix}-${h}`,d),o.style.setProperty(`--${i.prefix}-${h}-rgb`,Ne(d));else{let h=i.vars[c];for(let[d,u]of C(h))if(d==="base")for(let[m,y]of C(u))n.set(m,y);else if(d===this.activeMode)for(let[m,y]of C(u))n.set(m,y)}for(let[c,l]of n)o.style.setProperty(`--${i.prefix}-${c}`,l)}},"#applyStyleProps");dispose(){for(let t of this._unsubs)t()}};var Ge=`<svg class="settings-icon fracgui-cancel" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 26 26">
  <path class="gear" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4.7c.2-.2.5-.3.7-.3l2.7.2h.4l.3-.1.2-.4 1.1-2.3.6-.5a13 13 0 0 1 6 0l.6.5 1.1 2.3.2.4.3.1h.4l2.7-.2c.2 0 .5.1.7.3 1.4 1.4 2.4 3 3 5 0 .2 0 .5-.2.7l-1.4 2-.3.5v.2l.3.4 1.4 2.1c.2.2.2.5.2.8-.6 1.8-1.6 3.5-3 4.9a1 1 0 0 1-.7.3l-2.7-.2h-.4l-.3.1-.2.4-1.1 2.3a1 1 0 0 1-.6.5 13 13 0 0 1-6 0 1 1 0 0 1-.6-.5l-1.1-2.3-.2-.4-.3-.1h-.4l-2.7.2a1 1 0 0 1-.7-.3c-1.4-1.4-2.4-3-3-5 0-.2 0-.5.2-.7l1.4-2L3 13l-.3-.4-1.4-2.1a.9.9 0 0 1-.2-.8c.6-1.8 1.6-3.5 3-4.9Z" />
  <circle fill="currentColor" class="dot-right" cx="22" cy="13" r="3" />
  <circle class="dot-left" fill="currentColor" cx="4" cy="13" r="3" />
  <circle class="dot-center" fill="currentColor" cx="13" cy="13" r="3" />
</svg>`;function Ht(s,t){let e={};function i(r,n=""){for(let[o,c]of C(r))typeof c=="object"?i(c,`${n?n+"-":""}${o}`):e[`${n?n+"_":""}${o}`]=c}return a(i,"destructure"),i(s),e}a(Ht,"destructureVars");var g="fracgui",Bi={base:{"font-family":"'fredoka', sans-serif","font-size":"clamp(0.75rem, 3vw, 1rem)","shadow-lightness":"0%","shadow-opacity":"0.2","shadow-color":`hsla(250, 10%, var(--${g}-shadow-lightness), var(--${g}-shadow-opacity))`,"radius-xs":"0.125rem","radius-sm":"0.1875rem",radius:"0.3125rem","radius-md":"0.4375rem",filter:"none",opacity:"0.95","transition-duration":"75ms","backdrop-filter":"blur(10px)"},dark:{},light:{"shadow-lightness":"50%","shadow-opacity":"0.1"}},he={base:{root:{width:"30rem","min-width":"25rem","max-width":"35rem","max-height":"90vh",opacity:"0.5","backdrop-filter":"blur(0.5rem)",header:{height:"1.75rem"}},header:{height:"1.75rem"},folder:{background:`color-mix(in sRGB, color-mix(in sRGB, var(--${g}-bg-a) 50%, var(--${g}-bg-b)) calc(var(--${g}-opacity) * 100%), transparent)`,header:{"padding-left":"0.25rem",color:`var(--${g}-fg-c)`,dim:{color:`var(--${g}-fg-d)`},background:`var(--${g}-bg-a)`,outline:"none","box-shadow":"none","font-size":`var(--${g}-font-size)`,"font-weight":"350","letter-spacing":"0.75px"},content:{"padding-left":"0.33rem","font-weight":"350","letter-spacing":"0.5px"}},toolbar:{icon:{color:`var(--${g}-bg-d)`,dim:{color:`var(--${g}-bg-c)`}}},controller:{"font-family":"'inconsolata', 'Comic Mono', 'Fira Code', monospace","font-size":"clamp(0.75rem, 3vw, 0.9rem)","border-radius":`var(--${g}-radius-sm)`,"box-shadow":`-1px 1px 2px hsla(250, 10%, var(--${g}-shadow-lightness), calc(0.7 * var(--${g}-shadow-opacity))), -1px 2px 5px hsla(250, 10%, var(--${g}-shadow-lightness), var(--${g}-shadow-opacity))`,background:`var(--${g}-bg-c)`,outline:`1px solid color-mix(in sRGB, var(--${g}-bg-d) 40%, transparent)`,color:`var(--${g}-fg-b)`,dim:{color:`var(--${g}-fg-c)`,background:`color-mix(in sRGB, color-mix(in sRGB, var(--${g}-bg-c) 75%, var(--${g}-bg-b)) calc(var(--${g}-opacity) * 100%), transparent)`}},input:{height:"2rem","section-1":{width:"clamp(6rem, 30%, 12rem)"},"section-2":{width:"4rem"},"section-3":{width:"100%"},"font-size":"'clamp(0.75rem, 3vw, 0.9rem)'",container:{color:`var(--${g}-fg-d)`,outline:`1px solid color-mix(in sRGB, var(--${g}-bg-a) 20%, transparent)`,"box-shadow":`-0.15px 0.1px 1px hsla(220, 10%, 2%, calc(0.8 * var(--${g}-shadow-opacity))) inset, -2px 2px 15px hsla(220, 10%, 2%, calc(0.075 * var(--${g}-shadow-opacity))) inset, -3.0px 3px 25px hsla(220, 10%, 2%, calc(0.05 * var(--${g}-shadow-opacity))) inset, -10.0px 10px 50px hsla(220, 10%, 2%, calc(0.025 * var(--${g}-shadow-opacity))) inset`,background:`color-mix(in sRGB, var(--${g}-bg-a) calc(var(--${g}-opacity) * 100%), transparent)`},number:{range:{color:`var(--${g}-bg-c)`,background:`var(--${g}-bg-a)`,outline:`1px solid color-mix(in sRGB, var(--${g}-bg-c) 0%, transparent)`,"box-shadow":"-2px 2px 2.5px hsla(230, 20%, 0%, 0.2), 2px 2px 5px hsla(230, 20%, 0%, 0.2), 2px 3px 10px hsla(230, 20%, 0%, 0.2), 2px 4px 4px hsla(230, 25%, 0%, 0.2)"}}}},dark:{},light:{controller:{outline:`1px solid color-mix(in sRGB, var(--${g}-bg-d) 10%, transparent)`,background:`color-mix(in sRGB, var(--${g}-bg-a) calc(var(--${g}-opacity) * 100%), transparent)`,color:`var(--${g}-fg-a)`,dim:{background:`color-mix(in sRGB, var(--${g}-bg-a) calc(var(--${g}-opacity) * 100%), transparent)`,color:`var(--${g}-fg-c)`}},input:{number:{range:{background:`var(--${g}-bg-b)`,color:`var(--${g}-bg-d)`,"box-shadow":"-2px 2px 2px hsla(230, 20%, 30%, 0.1), 2px 2px 3px hsla(230, 20%, 30%, 0.1), 2px 2px 7px hsla(230, 20%, 30%, 0.1)"}}}}},de={color:Et.vars.color,utility:Bi,core:{base:Ht(he.base,g),dark:Ht(he.dark,g),light:Ht(he.light,g)}};var Ut=class{static{a(this,"UndoManager")}pointer=-1;maxHistory=50;stack=[];lockedExternally=!1;_lockedInternally=!1;constructor(){}commit(t,e=100){if(this._lockedInternally||this.lockedExternally){this._lockedInternally=!1;return}let i=this.pointer+1-this.stack.length;i<0&&(this.stack=this.stack.slice(0,i)),this.pointer++,this.stack.push(t),this.stack.length>this.maxHistory&&(this.stack.shift(),this.pointer--)}undo=a(()=>{if(this.pointer===-1)return;this._lockedInternally=!0;let t=this.stack[this.pointer];t.setter?t.setter(t.from):t.target.set(t.from),this.pointer--},"undo");redo=a(()=>{if(this.pointer+1>this.stack.length-1)return;this._lockedInternally=!0;let t=this.stack[this.pointer+1];t.setter?t.setter(t.to):t.target.set(t.to),this.pointer++},"redo");clear(){this.stack=[],this.pointer=-1}};var Di={__type:"ButtonControllerOptions",text:a(()=>"click me","text"),onClick:a(()=>{},"onClick"),id:void 0,disabled:!1,style:void 0,tooltip:void 0,active:!1,element:void 0,parent:void 0},q=class s{static{a(this,"ButtonController")}__type="ButtonController";static is(t){return t?.__type==="ButtonController"&&t instanceof s}_text;_active=a(()=>!1,"_active");_disabled=a(()=>!1,"_disabled");element;_evm=new E(["change","refresh","click"]);on=this._evm.on.bind(this._evm);_log=new b("ButtonController",{fg:"coral"});parent;constructor(t){let e=Object.assign({},Di,t);this._log.fn("constructor").debug({opts:e,this:this}),this.element=e.element?e.element:f("button",{id:e.id??L(8),classes:["fracgui-controller","fracgui-controller-button"],parent:e.parent}),this.text=e.text,this.active=e.active,typeof e.disabled<"u"&&(this.disabled=e.disabled),this._evm.listen(this.element,"click",this.click),e.onClick&&this._evm.on("click",e.onClick)}get text(){return this._text()}set text(t){this._text=k(t),this.element.innerHTML=this._text()}get active(){return this._active()}set active(t){typeof t>"u"||(this._active=k(t),this.element.classList.toggle("active",this._active()))}get disabled(){return this._disabled()}set disabled(t){typeof t>"u"||(this._disabled=k(t),this._disabled()?this.disable():this.enable())}set(t){Object.assign(this,t),this._evm.emit("change",this),this.refresh()}click=a(t=>{this._log.fn("click").debug({this:this}),this._evm.emit("click",{e:t,button:this}),this.refresh()},"click");enable=a(()=>this.disabled?this.disabled=!1:(this.element.classList.remove("disabled"),this.element.removeAttribute("disabled"),this),"enable");disable=a(()=>this.disabled?(this.element.classList.add("disabled"),this.element.setAttribute("disabled","true"),this):this.disabled=!0,"disable");refresh=a(()=>(this.element.toggleAttribute("disabled",this.disabled),this.element.classList.toggle("disabled",this.disabled),this.element.innerHTML=this.text,this.element.classList.toggle("active",this.active),this._evm.emit("refresh"),this),"refresh");dispose(){this.element.remove(),this._evm.dispose()}};var fe=Object.freeze({InputText:"TextInputOptions",InputTextArea:"TextAreaInputOptions",InputNumber:"NumberInputOptions",InputColor:"ColorInputOptions",InputSelect:"SelectInputOptions",InputButton:"ButtonInputOptions",InputButtonGrid:"ButtonGridInputOptions",InputSwitch:"SwitchInputOptions"}),Fo=Object.freeze(Re(fe)),Bo=Object.freeze(Bt(fe)),A=class{static{a(this,"Input")}folder;opts;id;bound;elements;bubble;_title;_index;_disabled;_hidden;_undoLock;lockCommit;_dirty;_evm;listen;on;__log;constructor(t,e){this.folder=e,this.bound=!1,this.elements={controllers:{}},this.bubble=!1,this._title="",this._undoLock=!1,this.lockCommit={},this._evm=new E(["change","refresh"]),this.listen=this._evm.listen.bind(this._evm),this.on=this._evm.on.bind(this._evm),this.lock=(i=this.state.value)=>{this._undoLock=!0,this.lockCommit.from=i,this.__log.fn(N("lock")).debug("lockCommit:",this.lockCommit)},this.unlock=i=>{this.__log.fn(N("unlock")).debug("commit",{commit:i,lockCommit:this.lockCommit}),i??={},i.target??=this,i.to??=this.state.value,i.from??=this.lockCommit.from,this._undoLock=!1,this.commit(i)},this.opts=t,this.opts.saveable??=!0,this.opts.resettable??=!0,this.id=this.opts.presetId??`${e.presetId}_${this.opts.title}__${this.opts.__type}`,this.__log=new b(`SuperInput${this.opts.__type.replaceAll(/Options|Input/g,"")} ${this.opts.title}`,{fg:"skyblue"}),this.__log.fn("super constructor").debug({options:t,this:this}),this._title=this.opts.title??"",this._disabled=k(this.opts.disabled??!1),this._hidden=k(this.opts.hidden??!1),this._index=this.opts.order??this.folder.inputs.size,this._index+=1,this._dirty=()=>this.value!==this.initialValue,this.elements.container=f("div",{classes:["fracgui-input-container"],parent:this.folder.elements.content}),this.title||this.element.style.setProperty("--fracgui-input-section-1_width","0px"),this.elements.drawerToggle=f("div",{classes:["fracgui-input-drawer-toggle"],parent:this.elements.container}),this.elements.title=f("div",{classes:["fracgui-input-title"],parent:this.elements.container,textContent:this.title}),this.elements.content=f("div",{classes:["fracgui-input-content"],parent:this.elements.container}),this.elements.resetBtn=f("div",{classes:["fracgui-input-reset-btn"],parent:this.elements.title,tooltip:{text:"Reset",placement:"left",delay:0},onclick:a(()=>{this.__log.fn("reset").debug("resetting to initial value",this.initialValue),this.set(this.initialValue)},"onclick")}),this.elements.drawer=f("div",{classes:["fracgui-input-drawer"],parent:this.elements.content}),this._evm.listen(this.elements.drawerToggle,"click",()=>{console.warn("todo")}),"onChange"in t&&this._evm.on("change",t.onChange),Promise.resolve().then(()=>{this.index=this.index})}get value(){return this.state.value}get title(){return this._title}set title(t){this._title=t,this.elements.title.textContent=t}get element(){return this.elements.container}get index(){return this._index}set index(t){this._index=t,this.elements.container.style.order=t.toString()}get undoManager(){return this.folder.gui?._undoManager}get disabled(){return this._disabled()}set disabled(t){this._disabled=k(t),this._disabled()?this.disable():this.enable()}get hidden(){return this.elements.container.classList.contains("hidden")}set hidden(t){this._hidden=k(t),this.elements.container.classList.toggle("hidden",this._hidden())}get dirty(){return this._dirty()}resolveState(t){if(t.binding){let e=_(t.binding.target[t.binding.key]);return this._evm.add(e.subscribe(i=>{t.binding.target[t.binding.key]=i})),e}else return _(t.value)}resolveInitialValue(t){let e=t.binding?t.binding.target[t.binding.key]:t.value;return P(e)?e.value:e}_emit(t,e=this.state.value){return this.opts.resettable&&this.elements.resetBtn.classList.toggle("dirty",this._dirty()),this._evm.emit(t,e),t==="change"&&this.folder.evm.emit("change",this),this}lock;unlock;commit(t){if(t.from??=this.state.value,t.target??=this,this._undoLock){this.__log.fn("commit").debug("prevented commit while locked");return}this.__log.fn("commit").debug("commited",t),this.undoManager?.commit(t)}enable(){return this._disabled=k(!1),this}disable(){return this._disabled=k(!0),this}refresh(t=this.state.value){if(this.opts.resettable)return this.opts.binding&&this.state.set(this.opts.binding.target[this.opts.binding.key]),this.elements.resetBtn.classList.toggle("dirty",this._dirty()),this._evm.emit("refresh",t),this}save(t={}){if(this.opts.saveable!==!0)throw new Error("Attempted to save unsaveable Input: "+this.title);let e={__type:fe[this.__type],title:this.title,value:this.state.value,disabled:this.disabled,presetId:this.id,hidden:this.hidden,order:this.index,resettable:this.opts.resettable??!0};return this.__log.fn("save").debug(e),Object.assign(e,t)}load(t){let e=typeof t=="string"?JSON.parse(t):t;this.id=e.presetId,this.disabled=e.disabled,this.hidden=e.hidden,this.initialValue=e.value,this.set(e.value)}dispose(){this.__log.fn("dispose").debug(this),this._evm.dispose();let t=a(e=>{if(e instanceof HTMLElement||e instanceof SVGElement)e.remove();else if(typeof e=="object")for(let i in e)t(e[i])},"rm");t(this.elements)}};var Ni={__type:"ButtonGridInputOptions",value:[[{text:"",onClick:a(()=>{},"onClick")}]],style:{gap:"0.5em"},activeOnClick:!1,resettable:!1},wt=class extends A{static{a(this,"InputButtonGrid")}__type="InputButtonGrid";initialValue={};state=_({});buttons=new Map;buttonGrid;_log;constructor(t,e){let i=Object.assign({},Ni,t);super(i,e),this._evm.registerEvents(["click"]),this.initialValue=i.value,this._log=new b(`InputButtonGrid ${i.title}`,{fg:"cyan"}),this._log.fn("constructor").debug({opts:i,this:this});let r=f("div",{classes:["fracgui-input","fracgui-input-buttongrid-container"],parent:this.elements.content});this.elements.controllers={container:r,buttonGrid:[]},this.buttonGrid=this.toGrid(this.initialValue),this.refresh()}onClick(t){this._evm.on("click",()=>t(this.state.value))}toGrid(t){let e=[],i=t.length,r=Math.max(...t.map(n=>n.length));for(let{element:n}of this.buttons.values())n.remove();this.buttons.clear();for(let n=0;n<i;n++){let o=f("div",{classes:["fracgui-controller-buttongrid-row"],parent:this.elements.controllers.container,style:{gap:"0.5em"}});e[n]=[];for(let c=0;c<r;c++){let l=t[n]?.[c];if(l){let h=this.addButton(l,l.id??L(8),n,c);o.appendChild(h.element),e[n][c]=h}}}return this.elements.container.style.setProperty("height",Pt(this.elements.controllers.container,"height")),e}addButton(t,e,i,r){let n=k(t.text),o=t.tooltip?Object.assign({placement:"top",delay:1e3},t.tooltip):void 0;t.element=f("button",{id:e,classes:["fracgui-controller","fracgui-controller-button","fracgui-controller-buttongrid-button"],innerHTML:n(),dataset:{id:e,row:String(i),col:String(r)},style:{...t.style,width:"100%"},tooltip:o});let c=new q(t);return typeof t.active!="function"&&this.opts.activeOnClick&&(c.active=()=>this.state.value===c),c.on("click",({button:l})=>{this.set(l)}),this.buttons.set(e,c),c}set(t){this.state.set(t),this._emit("click",t),this.refresh()}refresh(){this._log.fn("refresh").debug({this:this});for(let t of this.buttons.values())t.refresh();return super.refresh(),this}enable(){for(let t of this.buttons.values())t.enable();return super.enable(),this}disable(){for(let t of this.buttons.values())t.disable();return super.disable(),this}dispose(){for(let t of this.buttons.values())t.dispose();this.buttons.clear(),super.dispose()}};var Gi={__type:"SwitchInputOptions",value:!0,labels:{true:{state:"on",verb:"Enable"},false:{state:"off",verb:"Disable"}}},ct=class extends A{static{a(this,"InputSwitch")}__type="InputSwitch";state;initialValue;#t;constructor(t,e){let i=Object.assign({},Gi,t);super(i,e),this.#t=new b(`InputSwitch ${i.title}`,{fg:"cyan"}),this.#t.fn("constructor").debug({opts:i,this:this}),i.binding?(this.initialValue=i.binding.target[i.binding.key],this.state=_(!!this.initialValue),this._evm.add(this.state.subscribe(l=>{i.binding.target[i.binding.key]=l}))):(this.initialValue=i.value,this.state=_(!!i.value));let r=f("div",{classes:["fracgui-input-switch-container"],parent:this.elements.content}),n=f("button",{classes:["fracgui-controller","fracgui-controller-switch"],parent:r,tooltip:{text:a(()=>(this.state.value?i.labels?.false.verb:i.labels?.true.verb)||"","text"),anchor:".fracgui-controller-switch-thumb",delay:750}}),o=f("div",{classes:["fracgui-controller-switch-thumb"],parent:n}),c=f("div",{classes:["fracgui-controller-switch-state-text"],parent:r,innerText:this.state.value?i.labels?.true.state:i.labels?.false.state,style:{opacity:"0.75"}});this.elements.controllers={container:r,input:n,thumb:o,stateText:c},this._evm.listen(this.elements.controllers.input,"click",()=>this.set()),this._evm.add(this.state.subscribe(this.refresh.bind(this)))}set(t=!this.state.value){if(this.#t.fn("set").debug({v:t,this:this}),typeof t=="boolean")this.undoManager?.commit({target:this,from:this.state.value,to:t}),this.state.set(t);else throw new Error(`InputBoolean.set() received an invalid value: ${JSON.stringify(t)} (${typeof t})`);return this._emit("change",t),this}refresh(t=this.state.value){return this.#t.fn("refresh").debug({v:t,this:this}),this.disabled?this:(this.elements.controllers.input.classList.toggle("active",t),this.elements.controllers.input?.tooltip?.refresh(),this.elements.controllers.stateText.innerText=(this.state.value?this.opts.labels?.true.state:this.opts.labels?.false.state)??"",this._emit("refresh",t),this)}enable(){return this.elements.controllers.input.disabled=!1,super.enable(),this}disable(){return this.elements.controllers.input.disabled=!0,super.disable(),this}dispose(){super.dispose()}};var ji={__type:"ButtonInputOptions",text:a(()=>"click me","text")},lt=class extends A{static{a(this,"InputButton")}__type="InputButton";initialValue={};state=_({});onClick=a(()=>{},"onClick");button;_log;constructor(t,e){let i=Object.assign({},ji,t,{__type:"ButtonInputOptions"});super(i,e),this._evm.registerEvents(["change","refresh","click"]),this._log=new b(`InputButton ${i.title}`,{fg:"cyan"}),this._log.fn("constructor").debug({opts:i,this:this}),i.value?this.onClick=i.value:i.onClick?this.onClick=i.onClick:!1;let r=f("div",{classes:["fracgui-input-button-container"],parent:this.elements.content});this.button=new q({text:i.text,onClick:i.onClick,parent:r}),this.elements.controllers={container:r,button:this.button.element},this._evm.listen(this.elements.controllers.button,"click",this.click.bind(this)),this._evm.add(this.state.subscribe(this.refresh.bind(this)))}get text(){return this.button.text}set text(t){this.button.text=t}click(){this.button.click({...new MouseEvent("click"),target:this.button.element})}enable(){return this.button.enable(),super.enable(),this}disable(){return this.button.disable(),super.disable(),this}set=a(t=>{q.is(t)&&this.state.set(t)},"set");refresh(){return this.button.refresh(),super.refresh(),this}dispose(){this.button.dispose(),super.dispose()}};function V(s){let t=a(()=>!1,"disabled");return class extends s{get disabled(){return t()}set disabled(e){t=k(e),t()?this.disable():this.enable()}}}a(V,"disableable");var Hi=a(s=>{if(!(s instanceof HTMLElement||s instanceof SVGElement))return!1;let t=getComputedStyle(s);return["overflow","overflow-x","overflow-y"].some(e=>{let i=t.getPropertyValue(e);return i==="auto"||i==="scroll"})},"isScrollable"),je=a(s=>{let t=s.parentElement;for(;t;){if(Hi(t))return t;t=t.parentElement}return document.scrollingElement||document.documentElement},"getScrollParent");function Ui(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var c=s.length-1;c>=0;c--)(o=s[c])&&(n=(r<3?o(n):r>3?o(t,e,n):o(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n}a(Ui,"_ts_decorate");function He(s,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,t)}a(He,"_ts_metadata");var K=class{static{a(this,"Select")}__type="Select";element;_opts;elements;options;optionMap=new Map;expanded=!1;initialValue;initialOptions;disableClicks=!1;bubble=!0;_selected;_currentSelection;_scrollParent;_evm=new E(["change","refresh","cancel","open","close"]);on=this._evm.on.bind(this._evm);_log;constructor(t){let e={...t,selected:X(t.selected?t.selected:t.options[0]),options:t.options.map(o=>X(o)),selectOnHover:t.selectOnHover??!0};this._opts=e,t?.title?this._log=new b(`Select ${t.title}`,{fg:"burlywood"}):this._log=new b("Select",{fg:"blueviolet"}),this._selected=this._currentSelection=this.initialValue=this._opts.selected,this.options=this.initialOptions=this._opts.options;let i=f("div",{classes:["fracgui-controller-select-container"],parent:t.container});this.element=i;let r=f("div",{classes:["fracgui-controller-select-selected"],parent:i,textContent:String(this.getLabel(this.selected))});this._evm.listen(r,"click",()=>{this.disableClicks||this.toggle()});let n=f("div",{classes:["fracgui-controller-select-dropdown"]});this.elements={container:i,selected:r,dropdown:n,options:[]};for(let o of this.options)this.add(o);this.disabled=this._opts.disabled,this._log.fn("constructor").debug({opts:this._opts,this:this})}get selected(){return this._selected}set selected(t){this._log.fn("set selected").debug(t);let e=P(t)?X(t.value):X(t);if(this._selected=e,this.elements.selected.innerHTML=e.label,!this.bubble){this.bubble=!0;return}this._evm.emit("change",this.selected)}getLabel(t){return P(t)?t.value.label:t.label}add(t){let e=X(t),i=f("div",{classes:["fracgui-controller-select-option"],parent:this.elements.dropdown,innerText:e.label}),r=this._evm.listen(i,"click",this.select);return i.dataset.optionId=r,this.optionMap.set(r,{option:e,element:i}),this.elements.options.push(i),this._log.fn("add").debug({option:t,added:this.optionMap.get(r),id:r,this:this}),this}remove(t,e=!1){let i=this.optionMap.get(t);if(!i)throw console.error({this:this}),new Error("No option found in map for id: "+t);let r=i;if(this._log.fn("remove").debug({btn:r,id:t,this:this}),e&&JSON.stringify(this.selected.value)===JSON.stringify(r.option.value)){let n=this.options.indexOf(r.option)+1,o=this.options[n%this.options.length];this._log.fn("remove").debug("Auto-selecting fallback btn",{fallback:o,btn:r,id:t,this:this}),this.select(o,!1)}this.elements.options=this.elements.options.filter(n=>n!==r.element),r.element.remove(),this.options=this.options.filter(n=>n.label!==r.option.label),this.optionMap.delete(t)}clear(){this._log.fn("clear").debug({this:this});for(let t of this.optionMap.keys())this.remove(t,!1);this.options=[],this.optionMap.clear()}select=a((t,e=!0)=>{if(this.disabled)return this;if(this._log.fn("select").debug("v",t,{this:this}),t instanceof Event){let i=t.target,r=i.dataset.optionId;if(typeof r!="string")throw console.error({target:i}),new Error("No option id found on select click");let n=this.optionMap.get(r);if(!n)throw console.error({target:i}),new Error("No option found in map");for(let[,{element:o}]of this.optionMap)o.classList.toggle("selected",o===n.element);this.close(),this.selected=n.option}else{let i=X(t);if(P(i))this.selected=i.value;else if(R(i))this.bubble=e,this.selected=i;else throw new Error("Invalid value: "+i)}return this},"select");refresh=a(()=>(this._log.fn("refresh").debug({this:this}),this.elements.selected.innerHTML=this.selected.label,this),"refresh");toggle=a(()=>{this._log.fn("toggle").debug({this:this}),this.expanded?(this._evm.emit("cancel"),this.close()):this.open()},"toggle");open=a(()=>{if(this.expanded=!0,this._opts.input.folder.gui.wrapper.appendChild(this.elements.dropdown),this.elements.dropdown.classList.add("expanded"),this.elements.selected.classList.add("active"),this.updatePosition(),this._scrollParent??=je(this.elements.selected),this._scrollParent?.addEventListener("scroll",this.updatePosition),this._evm.listen(window,"keydown",this._closeOnEscape,{},"dropdown"),this._evm.listen(window,"click",this._clickOutside,{},"dropdown"),this._opts.selectOnHover){this._currentSelection=this.selected;for(let[,{option:t,element:e}]of this.optionMap){e.classList.toggle("selected",t.label===this.selected.label);let i=a(()=>{this._log.fn("on(mouseenter)").debug("currentSelection",{option:t,element:e,this:this}),this.select(t)},"select");this._evm.listen(e,"mouseenter",i,{},"dropdown")}}this._evm.emit("open"),setTimeout(()=>{this.elements.dropdown.style.pointerEvents="all"},200)},"open");updatePosition=a(()=>{if(!this.expanded)return;this.elements.dropdown.style.setProperty("width","unset"),this.elements.dropdown.style.setProperty("top","unset");let{dropdown:t,selected:e}=this.elements,i=this._opts.input.folder.root.elements.content.scrollTop,{top:r,left:n}=e.getBoundingClientRect();this.elements.dropdown.style.setProperty("width",`${Math.max(e.offsetWidth,t.offsetWidth)}px`),this.elements.dropdown.style.setProperty("top",`${r+e.offsetHeight-i}px`),this.elements.dropdown.style.setProperty("left",`${n+e.offsetWidth/2-t.offsetWidth/2}px`)},"updatePosition");close=a(()=>{this.expanded=!1,this.elements.dropdown.classList.remove("expanded"),this.elements.selected.classList.remove("active"),this.elements.dropdown.style.pointerEvents="none",this._evm.clearGroup("dropdown"),this._evm.emit("close"),setTimeout(()=>{this.elements.dropdown.remove()},200)},"close");_closeOnEscape=a(t=>{t.key==="Escape"&&this._cancel()},"_closeOnEscape");_clickOutside=a(t=>{let e=t.composedPath();!e.includes(this.elements.selected)&&!e.includes(this.elements.dropdown)&&this._cancel()},"_clickOutside");_cancel(){this.close(),this._opts.selectOnHover&&this.select(this._currentSelection),this._evm.emit("cancel")}enable(){return this.elements.selected.classList.remove("disabled"),this.elements.selected.removeAttribute("disabled"),this}disable(){return this.elements.selected.classList.add("disabled"),this.elements.selected.setAttribute("disabled","true"),this}dispose(){for(let t of Bt(this.elements))Array.isArray(t)?t.forEach(e=>e.remove()):t.remove();this._scrollParent?.removeEventListener("scroll",this.updatePosition),removeEventListener("click",this._clickOutside),this._evm.dispose()}};K=Ui([V,He("design:type",Function),He("design:paramtypes",[typeof SelectInputOptions>"u"?Object:SelectInputOptions])],K);function R(s){return typeof s=="object"&&Object.keys(s).length===2&&"label"in s&&"value"in s}a(R,"isLabeledOption");function X(s){if(R(s))return s;if(["string","number"].includes(typeof s))return{label:String(s),value:s};if(P(s))return R(s.value)?s.value:{label:String(s.value),value:s};if(s&&typeof s=="object")return{label:JSON.stringify(s),value:s};throw console.error("Invalid option:",s,". Please provide a named option ({ label: string, value: T })and place your value in the `value` property."),new Error("Missing label:"+JSON.stringify(s),{cause:{v:s}})}a(X,"toLabeledOption");function ge(s){function t(e){return e}if(a(t,"rtrn"),R(s))return s.value;if(P(s)){let e=s.value;return R(e)?e.value:e}return s}a(ge,"fromLabeledOption");function Vi(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var c=s.length-1;c>=0;c--)(o=s[c])&&(n=(r<3?o(n):r>3?o(t,e,n):o(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n}a(Vi,"_ts_decorate");function Ue(s,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,t)}a(Ue,"_ts_metadata");var Xi={__type:"SelectInputOptions",options:[]},W=class extends A{static{a(this,"InputSelect")}__type="InputSelect";initialValue;state;#t;set options(t){this._log.fn("set options").debug(t),this.#t=k(t),this.select.clear();for(let e of this.#t())this.select.add(e)}get options(){return this.resolveOptions(this.#t)}select;#e=!0;labeledSelection;_log;constructor(t,e){let i=Object.assign({},Xi,t,{__type:"SelectInputOptions"});super(i,e),this._evm.registerEvents(["preview","open","close","cancel"]),this._log=new b(`InputSelect ${i.title}`,{fg:"slategrey"}),this._log.fn("constructor").debug({opts:i,this:this}),i.value??=i.binding?.initial??se(this.targetValue),this.initialValue=this.resolveInitialValue(i),this.labeledSelection={value:ge(this.initialValue),label:this.resolveInitialLabel(this.initialValue,i)},this.#t=this.opts.options,this.state=_(this.initialValue);let r=f("div",{classes:["fracgui-input-select-container"],parent:this.elements.content});this.select=new K({input:this,container:r,options:this.options,selected:this.labeledSelection,title:this.title}),this.elements.controllers={container:r,select:this.select.elements},this.disabled=i.disabled??!1,this._evm.add(this.state.subscribe(n=>{if(this.select.bubble){if(this.targetObject&&(P(this.targetValue)?(this._log.fn("updating binding").debug({from:this.targetValue.value,to:n.value}),this.targetValue.set(n.value)):this.targetValue=n.value),this.#e){this.#e=!1,this._log.fn("state.subscribe").debug("Stopped propagation.  Subscribers will not be notified.");return}this.set(n)}})),t.onChange&&this._evm.on("change",n=>{this._log.fn("calling options onChange").debug(n),t.onChange?.(X(n))}),this.select.on("change",n=>{this._log.fn("select.onChange").debug(n),!this.#e&&(this.#e=!0,this.set(n))}),this.listen(this.select.element,"preview",()=>{this._emit("preview")}),this.listen(this.select.element,"open",()=>{this._emit("open")}),this.listen(this.select.element,"close",()=>{this._emit("close")}),this.listen(this.select.element,"cancel",()=>{this._emit("cancel")}),this._dirty=()=>this.value.label!==this.initialValue.label,this._log.fn("constructor").debug({this:this})}resolveOptions(t){function e(r){return R(r[0])}a(e,"isLabeledOptionsArray");let i=k(t)();if(!e(i)){if(!this.opts.labelKey)throw new Error("Recieved unlabeled options with no `labelKey` specified.  Please label your options or provide the `labelKey` to use as a label.");return i.map(r=>({label:r[this.opts.labelKey],value:r}))}return i}resolveInitialValue(t){let e=t.binding?t.binding.target[t.binding.key]:t.value,i=se(e);if(!R(i)){if(!t.labelKey)throw new Error("Cannot resolve initial value.  Please provide a `labelKey` or use labeled options.");return{label:i[t.labelKey],value:i}}return i}resolveInitialLabel(t,e){let i=P(t)?t.value:t;return R(i)?i.label:e.labelKey?t[e.labelKey]:Lt(i)}get targetObject(){return this.opts.binding?.target}get targetKey(){return this.opts.binding?.key}get targetValue(){return this.targetObject?.[this.targetKey]}set targetValue(t){if(R(t)&&(t=ge(t)),this._log.fn("set targetValue").debug(t),typeof t>"u")throw console.error("Cannot set target value to undefined"),console.error("this",this),new Error("Cannot set target value to undefined");let e=this.targetObject,i=this.targetKey;e&&i&&(P(e[i])?e[i].set(t):e[i]=t)}set(t){return this._log.fn("set").debug(t),this.#e=!0,this.select.select(t,!1),this.state.set(t),this._emit("change",t),this}enable(){return this._log.fn("enable").debug(),this.select.enable(),super.enable(),this}disable(){return this._log.fn("disable").debug(),this.select.disable(),super.disable(),this}refresh=a(()=>{let t=this.state.value;if(this._log.fn("refresh").debug({v:t,this:this}),!this.labeledSelection)throw new Error("Failed to find labeled selection.");let e=this.options.filter(i=>!this.select.options.some(r=>r.label===i.label));console.log(e);for(let i of e)this.select.add(i);return this.select.select(this.labeledSelection,!1),super.refresh(),this},"refresh");dispose(){super.dispose()}};W=Vi([V,Ue("design:type",Function),Ue("design:paramtypes",[typeof Partial>"u"?Object:Partial,typeof Folder>"u"?Object:Folder])],W);var Vt=a(()=>{let s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.setAttribute("width","24"),s.setAttribute("height","24"),s.setAttribute("viewBox","-2 -2 28 28"),s.setAttribute("stroke","currentColor"),s.setAttribute("fill","none"),s.setAttribute("stroke-width","2"),s.setAttribute("stroke-linecap","round"),s.setAttribute("stroke-linejoin","round");let t=document.createElementNS("http://www.w3.org/2000/svg","path");return t.setAttribute("d","m18 15-6-6-6 6"),s.appendChild(t),s},"svgChevron");var Xt=class{static{a(this,"NumberButtonsController")}input;opts;parent;elements;constructor(t,e,i){this.input=t,this.opts=e,this.parent=i,this.elements={},this.elements.container=f("div",{classes:["fracgui-input-number-buttons-container"],parent:i}),this.elements.increment=f("div",{classes:["fracgui-controller","fracgui-input-number-button","fracgui-input-number-buttons-increment"],parent:this.elements.container}),this.elements.increment.appendChild(Vt()),t.listen(this.elements.increment,"pointerdown",this.rampChangeUp.bind(this)),this.elements.decrement=f("div",{classes:["fracgui-controller","fracgui-input-number-button","fracgui-input-number-buttons-decrement"],parent:this.elements.container});let r=Vt();r.setAttribute("style","transform: rotate(180deg)"),this.elements.decrement.appendChild(r),t.listen(this.elements.decrement,"pointerdown",this.rampChangeDown.bind(this))}rampChange(t=1){let e="step"in this.opts?this.opts.step:1,i=300,r=!1,n=0,o,c=a(()=>{clearTimeout(o),!r&&(n+=i,n>1e3&&(i/=2,n=0),this.input.set(this.input.state.value+e*t),o=setTimeout(c,i))},"change"),l=a(()=>{r=!0,window.removeEventListener("pointerup",l),window.removeEventListener("pointercancel",l)},"stopChanging");window.addEventListener("pointercancel",l,{once:!0}),window.addEventListener("pointerup",l,{once:!0}),c()}rampChangeUp(){this.rampChange(1)}rampChangeDown(){this.rampChange(-1)}};function Ki(s){return typeof globalThis.navigator>"u"&&!s&&console.error("Error getting user-agent: Request object is required on the server, but was not provided."),s?.headers.get("user-agent")||globalThis.navigator?.userAgent}a(Ki,"getUserAgent");function Kt(s,t){return!!Ki(t)?.match(s)}a(Kt,"isPlatform");function pe(s){return Kt(/mac/i,s)&&!Wi(s)}a(pe,"isMac");function Ve(s){return pe(s)||Xe(s)||xt(s)||Yi(s)||xt(s)}a(Ve,"isApple");function Wi(s){return Ji(s)||Xe(s)||xt(s)}a(Wi,"isMobile");function Xe(s){return Kt(/iphone/i,s)}a(Xe,"isIOS");function Yi(s){return xt(s)}a(Yi,"isIPadOS");function xt(s){return Kt(/ipad/i,s)}a(xt,"isIPad");function Ji(s){return Kt(/android/i,s)}a(Ji,"isAndroid");function We(s){return pe()?s.metaKey:s.ctrlKey}a(We,"modKey");function Ye(){return Ve()?Ke.metaKey.mac.icon:Ke.ctrlKey.windows.icon}a(Ye,"modIcon");var Ke={metaKey:{mac:{icon:"\u2318",name:"command",key:"meta"},windows:{icon:"\u229E Win",name:"windows",key:"win"},linux:{icon:"Super",name:"super",key:"meta"}},altKey:{mac:{icon:"\u2325",name:"option",key:"alt"},windows:{icon:"Alt",name:"alt",key:"alt"},linux:{icon:"Alt",name:"alt",key:"alt"}},shiftKey:{mac:{icon:"\u21E7",name:"shift",key:"shift"},windows:{icon:"Shift",name:"shift",key:"shift"},linux:{icon:"Shift",name:"shift",key:"shift"}},ctrlKey:{mac:{icon:"\u2303",name:"control",key:"ctrl"},windows:{icon:"Ctrl",name:"control",key:"ctrl"},linux:{icon:"Ctrl",name:"control",key:"ctrl"}}};var G=class{static{a(this,"NumberController")}input;opts;parent;element;dragEnabled;dragging;hovering;delta;_log;constructor(t,e,i){this.input=t,this.opts=e,this.parent=i,this.dragEnabled=!1,this.dragging=!1,this.hovering=!1,this.delta=0,this.hoverStart=r=>{this._log.fn("hoverStart").debug(r),this.hovering=!0,this.element.classList.add("hovering"),this.maybeEnableDrag(r),this.element.removeEventListener("pointerleave",this.hoverEnd),this.element.addEventListener("pointerleave",this.hoverEnd),document.removeEventListener("keydown",this.maybeEnableDrag),document.addEventListener("keydown",this.maybeEnableDrag)},this.hoverEnd=r=>{this._log.fn("hoverEnd").debug(r),this.hovering=!1,this.element.classList.remove("hovering"),this.cancelDrag(r),this.element.removeEventListener("pointerleave",this.hoverEnd),document.removeEventListener("keydown",this.maybeEnableDrag)},this.dragKeyHeld=r=>We(r),this.cancelDrag=r=>{this._log.fn("cancelDrag").debug(r),this.dragEnabled=r.type==="keyup"?this.dragKeyHeld(r):!1,document.removeEventListener("keyup",this.cancelDrag),this.element.removeEventListener("pointerleave",this.cancelDrag),this.element.removeEventListener("pointerdown",this.maybeDragStart),this.dragEnabled||(this.element.style.cursor=this.element.dataset.cursor??"text",this.dragging&&this.dragEnd())},this.maybeEnableDrag=r=>{this._log.fn("maybeEnableDrag").debug(r),this.dragKeyHeld(r)&&(this.dragEnabled=!0,document.removeEventListener("keyup",this.cancelDrag),document.addEventListener("keyup",this.cancelDrag),this.element.removeEventListener("pointerleave",this.cancelDrag),this.element.addEventListener("pointerleave",this.cancelDrag),this.element.removeEventListener("pointerdown",this.maybeDragStart),this.element.addEventListener("pointerdown",this.maybeDragStart),this.element.dataset.cursor=Pt(this.element,"cursor"),this.element.style.cursor="ns-resize")},this.maybeDragStart=()=>{this.hovering&&this.dragEnabled&&this.dragStart()},this.dragStart=async()=>{this._log.fn("dragStart").debug(),this.dragging=!0,this.element.dispatchEvent(new Event("dragStart")),this.element.tooltip.hide(),this.element.removeEventListener("pointermove",this.drag),this.element.addEventListener("pointermove",this.drag),document.removeEventListener("pointerup",this.dragEnd),document.addEventListener("pointerup",this.dragEnd),this.element.classList.add("dragging"),await this.element.requestPointerLock(),this.element.blur()},this.dragEnd=()=>{this._log.fn("dragEnd").debug(),this.dragging=!1,this.element.classList.remove("dragging"),this.element.removeEventListener("pointermove",this.drag),document.removeEventListener("pointerup",this.dragEnd),document.exitPointerLock(),this.element.dispatchEvent(new Event("dragEnd"))},this.drag=r=>{if(!this.dragging)return;let n=r.shiftKey?4:r.altKey?.1:1,o=Math.sign(r.movementY);if(this.delta+=Math.abs(r.movementY),this.delta>+this.element.step){let c=+this.element.step*n*-o;this.element.value=String(this.element.valueAsNumber+c),o===-1?this.element.stepUp(+this.element.step*n):this.element.stepDown(+this.element.step*n),this.delta=0,this.element.dispatchEvent(new Event("input"))}},this._log=new b(`NumberController ${this.input.title}`,{fg:"darkgoldenrod"}),this.element=f("input",{type:"number",classes:["fracgui-controller","fracgui-controller-number"],value:String(t.state.value),parent:i,tooltip:{text:`Hold <span class="fractils-hotkey">${Ye()}</span> to drag`,placement:"top",delay:1500,parent:i,styles:{background:"var(--fracgui-bg-a)",color:"var(--fracgui-fg-a)","--fractils-hotkey_background":"var(--fracgui-bg-b)","--fractils-hotkey_color":"var(--fracgui-fg-a)"}}}),"step"in e&&(this.element.step=String(e.step)),t.listen(this.element,"pointerenter",this.hoverStart)}hoverStart;hoverEnd;dragKeyHeld;cancelDrag;maybeEnableDrag;maybeDragStart;dragStart;dragEnd;drag;dispose(){this.element.removeEventListener("pointerenter",this.hoverStart),this.element.removeEventListener("pointerleave",this.hoverEnd),this.element.removeEventListener("pointermove",this.drag),document.removeEventListener("keydown",this.maybeEnableDrag),document.removeEventListener("keyup",this.cancelDrag),this.element.removeEventListener("pointerleave",this.cancelDrag),this.element.removeEventListener("pointerdown",this.maybeDragStart),document.removeEventListener("pointerup",this.dragEnd),this.element.tooltip.dispose(),this.element.remove()}};var Je=a((s,t,e)=>{let i=f("input",{type:"range",classes:["fracgui-controller","fracgui-input-number-range"],value:String(s.state.value),parent:e});return"min"in t&&(i.min=String(t.min)),"max"in t&&(i.max=String(t.max)),"step"in t&&(i.step=String(t.step)),s.listen(i,"input",s.set.bind(s)),i},"rangeController");var Zi={__type:"NumberInputOptions"},ut=class extends A{static{a(this,"InputNumber")}__type="InputNumber";_log;initialValue;state;dragEnabled=!1;numberController;numberButtonsController;constructor(t,e){let i=Object.assign({},Zi,t,{__type:"NumberInputOptions"}),r=i.binding?.initial??i.value??1;i.value??=r,i.min??=r<=0?r*2:0,i.max??=r<=0?r*-2:r*2;let n=r/100;i.step??=n<=.1?.001:.1,super(i,e),this._log=new b(`InputNumber ${i.title}`,{fg:"cyan"}),this._log.fn("constructor").debug({opts:i,this:this}),this.initialValue=this.resolveInitialValue(i),this.state=this.resolveState(i);let o=f("div",{classes:["fracgui-input-number-container"],parent:this.elements.content});this.numberController=new G(this,i,o),this.numberButtonsController=new Xt(this,i,o),this.elements.controllers={container:o,input:this.numberController.element,buttons:this.numberButtonsController.elements,range:Je(this,i,o)},this._evm.add(this.state.subscribe(this.refresh)),this._evm.listen(this.elements.controllers.range,"pointerdown",this.lock),this._evm.listen(this.elements.controllers.range,"pointerup",()=>this.unlock()),this._evm.listen(this.elements.controllers.input,"input",this.set),this._evm.listen(this.elements.controllers.input,"dragStart",this.lock),this._evm.listen(this.elements.controllers.input,"dragEnd",()=>this.unlock())}set=a(t=>{if(this._log.fn("set").debug(t),typeof t>"u")return;let e=t;return t instanceof Event&&t?.target&&"valueAsNumber"in t.target&&(e=t.target.valueAsNumber),this.commit({to:e}),this.state.set(e),this._emit("change",e),this},"set");enable(){return this._log.fn("enable").debug(),this.elements.controllers.input.disabled=!1,super.enable(),this}disable(){return this._log.fn("disable").debug(),this.elements.controllers.input.disabled=!0,super.disable(),this}refresh=a(()=>{let t=this.state.value;return this._log.fn("refresh").debug(t),this.elements.controllers.range.value=String(t),this.elements.controllers.input.value=String(t),super.refresh(t),this},"refresh");dispose(){this._log.fn("dispose").debug(),super.dispose()}};var qi="[-\\+]?\\d+%?",Qi="[-\\+]?\\d*\\.\\d+%?",Q="(?:"+Qi+")|(?:"+qi+")",Ze="[\\s|\\(]+("+Q+")[,|\\s]+("+Q+")[,|\\s]+("+Q+")\\s*\\)?",qe="[\\s|\\(]+("+Q+")[,|\\s]+("+Q+")[,|\\s]+("+Q+")[,|\\s]+("+Q+")\\s*\\)?",Qe=new RegExp("rgb"+Ze),ti=new RegExp("rgba"+qe),ei=new RegExp("hsl"+Ze),ii=new RegExp("hsla"+qe),Wt="^(?:#?|0x?)",tt="([0-9a-fA-F]{1})",et="([0-9a-fA-F]{2})",ri=new RegExp(Wt+tt+tt+tt+"$"),ni=new RegExp(Wt+tt+tt+tt+tt+"$"),si=new RegExp(Wt+et+et+et+"$"),oi=new RegExp(Wt+et+et+et+et+"$");function Yt(s){let t=s/100,e,i,r;return t<66?(e=255,i=-155.25485562709179-.44596950469579133*(i=t-2)+104.49216199393888*Math.log(i),r=t<20?0:-254.76935184120902+.8274096064007395*(r=t-10)+115.67994401066147*Math.log(r)):(e=351.97690566805693+.114206453784165*(e=t-55)-40.25366309332127*Math.log(e),i=325.4494125711974+.07943456536662342*(i=t-50)-28.0852963507957*Math.log(i),r=255),{r:x(Math.floor(e),0,255),g:x(Math.floor(i),0,255),b:x(Math.floor(r),0,255)}}a(Yt,"kelvinToRgb");var tr=2e3,er=4e4;function ai(s){let{r:t,b:e}=s,i=.4,r=tr,n=er,o;for(;n-r>i;){o=(n+r)*.5;let c=Yt(o);c.b/c.r>=e/t?n=o:r=o}return o}a(ai,"rgbToKelvin");function ci(s){let t=s.r/255,e=s.g/255,i=s.b/255,r=Math.max(t,e,i),n=Math.min(t,e,i),o=r-n,c=0,l=r,h=r===0?0:o/r;switch(r){case n:c=0;break;case t:c=(e-i)/o+(e<i?6:0);break;case e:c=(i-t)/o+2;break;case i:c=(t-e)/o+4;break}return{h:c*60%360,s:x(h*100,0,100),v:x(l*100,0,100)}}a(ci,"rgbToHsv");function li(s){let t=s.l*2,e=s.s*(t<=100?t:200-t)/100,i=t+e<1e-9?0:2*e/(t+e);return{h:s.h,s:x(i*100,0,100),v:x((t+e)/2,0,100)}}a(li,"hslToHsv");function ui(s){let t=s.s/100,e=s.v/100,i=(2-t)*e,r=i<=1?i:2-i,n=r<1e-9?0:t*e/r;return{h:s.h,s:x(n*100,0,100),l:x(i*50,0,100)}}a(ui,"hsvToHsl");function hi(s){let t=s.h/60,e=s.s/100,i=s.v/100,r=Math.floor(t),n=t-r,o=i*(1-e),c=i*(1-n*e),l=i*(1-(1-n)*e),h=r%6,d=[i,c,o,o,l,i][h],u=[l,i,i,c,o,o][h],m=[o,o,l,i,i,c][h];return{r:x(d*255,0,255),g:x(u*255,0,255),b:x(m*255,0,255)}}a(hi,"hsvToRgb");function di(s){if(s.length!==2)throw new Error("Invalid hex string: "+s);return parseInt(s,16)}a(di,"parseHexInt");function j(s,t){let e=s.indexOf("%")>-1,i=parseFloat(s);return e?t/100*i:i}a(j,"parseUnit");function Y(s){return s.toString(16).padStart(2,"0")}a(Y,"intToHex");var ir={h:0,s:0,v:0,a:1},D=class s{static{a(this,"Color")}isColor=!0;#t;#e;constructor(t){return this.#t=ir,t&&this.set(t),this.#e=structuredClone(this.#t),this}set(t){if(typeof t=="string")/^(?:#?|0x?)[0-9a-fA-F]{3,8}$/.test(t)?this.hexString=t:/^rgba?/.test(t)?this.rgbString=t:/^hsla?/.test(t)&&(this.hslString=t);else if(typeof t=="object")t instanceof s?this.hsva=t.hsva:"r"in t&&"g"in t&&"b"in t?this.rgb=t:"h"in t&&"s"in t&&"v"in t?this.hsv=t:"h"in t&&"s"in t&&"l"in t?this.hsl=t:"kelvin"in t&&(this.kelvin=t.kelvin);else throw new Error("Invalid color value: "+t)}setChannel(t,e,i){this[t]={...this[t],[e]:i}}reset(){this.hsva=this.#e}clone(){return new s(this)}get hsv(){let{h:t,s:e,v:i}=this.#t;return{h:t,s:e,v:i}}set hsv(t){let i={...this.#t,...t};this.#t.h===i.h&&this.#t.s===i.s&&this.#t.v===i.v&&this.#t.a===i.a||(this.#t={h:Math.round(i.h),s:Math.round(i.s),v:Math.round(i.v),a:i.a})}get hsva(){return structuredClone(this.#t)}set hsva(t){this.hsv=t}get hue(){return this.#t.h}set hue(t){this.hsv={h:t}}get saturation(){return this.#t.s}set saturation(t){this.hsv={s:t}}get value(){return this.#t.v}set value(t){this.hsv={v:t}}get lightness(){return this.hsl.l}set lightness(t){this.hsl={...this.hsl,l:t}}get alpha(){return this.#t.a??1}set alpha(t){this.hsv={...this.hsv,a:t}}get kelvin(){return ai(this.rgb)}set kelvin(t){this.rgb=Yt(t)}get red(){return this.rgb.r}set red(t){this.rgb={...this.rgb,r:t}}get r(){return this.rgb.r/255}set r(t){this.red=t*255}get green(){return this.rgb.g}set green(t){this.rgb={...this.rgb,g:t}}get g(){return this.rgb.g/255}set g(t){this.green=t*255}get blue(){return this.rgb.b}set blue(t){this.rgb={...this.rgb,b:t}}get b(){return this.rgb.b/255}set b(t){this.blue=t*255}get rgb(){let{r:t,g:e,b:i}=hi(this.#t);return{r:Math.round(t),g:Math.round(e),b:Math.round(i)}}set rgb(t){this.hsv={...ci(t),a:"a"in t?t.a:1}}get rgbf(){return{r:this.r,g:this.g,b:this.b}}set rgbf(t){this.rgb={r:t.r,g:t.g,b:t.b}}get rgba(){return{...this.rgb,a:this.alpha}}set rgba(t){this.rgb=t}get hsl(){let{h:t,s:e,l:i}=ui(this.#t);return{h:Math.round(t),s:Math.round(e),l:Math.round(i)}}set hsl(t){this.hsv={...li(t),a:"a"in t?t.a:1}}get hsla(){return{...this.hsl,a:this.alpha}}set hsla(t){this.hsl=t}get rgbString(){return`rgb(${this.rgb.r}, ${this.rgb.g}, ${this.rgb.b})`}set rgbString(t){let e,i,r,n,o=1;if(e=Qe.exec(t))i=j(e[1],255),r=j(e[2],255),n=j(e[3],255);else if(e=ti.exec(t))i=j(e[1],255),r=j(e[2],255),n=j(e[3],255),o=j(e[4],1);else throw new Error("Invalid rgb string: "+t);this.rgb={r:i,g:r,b:n,a:o}}get rgbaString(){let t=this.rgba;return`rgba(${t.r}, ${t.g}, ${t.b}, ${t.a})`}set rgbaString(t){this.rgbString=t}get hex(){return this.hex8String}get hexString(){let t=this.rgb;return`#${Y(t.r)}${Y(t.g)}${Y(t.b)}`}set hexString(t){let e=t.match(ri)||t.match(ni)||t.match(si)||t.match(oi);if(!e)throw new Error("Invalid hex string");let[i,r,n,o=255]=e.slice(1).map(c=>di(c.length===1?`${c}${c}`:c));this.rgb={r:i,g:r,b:n,a:+o/255}}get hex8(){return this.hex8String}get hex8String(){let t=this.rgba;return`#${Y(t.r)}${Y(t.g)}${Y(t.b)}${Y(Math.floor((t.a??1)*255))}`}set hex8String(t){this.hexString=t}get hslString(){let t=this.hsl;return`hsl(${t.h}, ${t.s}%, ${t.l}%)`}set hslString(t){let e=ei.exec(t)||ii.exec(t);if(!e)throw new Error("Invalid rgb string: "+t);let[i,r,n,o=1]=e.slice(1).map((c,l)=>j(c,l<3?255:1));this.rgb={r:i,g:r,b:n,a:o}}get hslaString(){let t=this.hsla;return`hsla(${t.h}, ${t.s}%, ${t.l}%, ${t.a})`}set hslaString(t){this.hslString=t}toString(){return this.hex8String}toJSON(){return{isColor:!0,...this.rgba,hex:this.hex8String}}};function ht(s){return!!s.isColor}a(ht,"isColor");function me(s){return typeof Jt(s)<"u"}a(me,"isColorFormat");function Jt(s){if(typeof s=="string"){if(s.match(/^#?[0-9a-fA-F]{6}$/))return"HexString";if(s.match(/^#?[0-9a-fA-F]{8}$/))return"Hex8String";if(s.match(/^rgba?/))return"RgbaString";if(s.match(/^hsla?/))return"HslaString"}else if(typeof s=="object"){if(s instanceof D)return"Color";if("r"in s&&"g"in s&&"b"in s)return"RgbColor";if("h"in s&&"s"in s&&"v"in s)return"HsvColor";if("h"in s&&"s"in s&&"l"in s)return"HslColor";if("kelvin"in s)return"number"}}a(Jt,"parseColorFormat");function rr(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var c=s.length-1;c>=0;c--)(o=s[c])&&(n=(r<3?o(n):r>3?o(t,e,n):o(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n}a(rr,"_ts_decorate");function fi(s,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,t)}a(fi,"_ts_metadata");var nr={disabled:!1},dt=class{static{a(this,"ColorComponents")}input;opts;element;elements;select;_evm;_mode;_locked;_log;constructor(t,e){this.input=t,this._evm=new E,this._locked=!1,this.updateMode=(d=this.mode)=>{if(this._log.fn("updateMode",d).debug(),this._mode=d,this.#e()==="text"){this.elements.text.classList.add("visible");for(let[,u]of C(this.elements.numbers))u.classList.remove("visible");this.#i()}else{this.elements.text.classList.remove("visible");for(let[,u]of C(this.elements.numbers))u.classList.add("visible");this.mode==="rgba"&&(this.#t(this.elements.numbers.a,{min:0,max:255,step:1}),this.#t(this.elements.numbers.b,{min:0,max:255,step:1}),this.#t(this.elements.numbers.c,{min:0,max:255,step:1}),this.#t(this.elements.numbers.d,{min:0,max:1,step:.01})),["hsla","hsva"].includes(this.mode)&&(this.#t(this.elements.numbers.a,{min:0,max:360,step:1}),this.#t(this.elements.numbers.b,{min:0,max:100,step:1}),this.#t(this.elements.numbers.c,{min:0,max:100,step:1}),this.#t(this.elements.numbers.d,{min:0,max:1,step:.01})),this.elements.select.selected.innerHTML=[...d].map((u,m)=>`<span class="${["a","b","c","d"][m]}">${u}</span>`).join("")}this.refresh()},this.#t=(d,u)=>{this._log.fn("#setProps",d,u).debug();for(let[m,y]of C(u))d[m]=String(y)},this.#i=()=>{this.elements.text.value=this.color[this.mode.startsWith("hex")?this.mode+"String":this.mode]},this.refresh=()=>{this._log.fn("refresh").debug();let d=this.input.state.value.hex8String,u=this.mode;return this.#n===d&&u===this.#s?this:(this.#n=d,this.#s=u,this._locked?(this._locked=!1,this):(this.#e()==="text"?this.#i():(this.elements.numbers.a.value=String(this.a),this.elements.numbers.b.value=String(this.b),this.elements.numbers.c.value=String(this.c),this.elements.numbers.d.value=String(this.d)),this))};let i={...nr,...e};this._log=new b(`ColorComponents ${t.title}`,{fg:"wheat"}),this.opts=i,this._mode=t.mode;let r=i.container??t.elements.controllers.container,n=f("div",{classes:["fracgui-input-color-components-container"],parent:r});this.element=n;let o=f("div",{classes:["fracgui-input-color-components-select-container"],parent:n});this.select=new K({input:this.input,disabled:this.disabled,container:o,options:["hex","hex8","rgba","hsla","hsva"]}),this.select.on("change",d=>{this.updateMode(d.value)});let c=f("div",{classes:["fracgui-input-color-components-numbers-container"],parent:n}),l={a:new G(this.input,this.input.opts,c).element,b:new G(this.input,this.input.opts,c).element,c:new G(this.input,this.input.opts,c).element,d:new G(this.input,this.input.opts,c).element};l.a.classList.add("a"),l.b.classList.add("b"),l.c.classList.add("c"),l.d.classList.add("d");for(let[d,u]of C(l)){let m=a(()=>{this[d]=+u.value,this.input.set(this.color)},"update");this.#e()==="text"&&u.classList.add("visible"),this._evm.listen(u,"input",m)}let h=f("input",{classes:["fracgui-controller","fracgui-controller-text","fracgui-input-color-components-text"],parent:n});this._evm.listen(h,"change",d=>{let u=d.target,m=Jt(u.value);m&&(m=m[0].toLowerCase()+m.slice(1),this.input.set(u.value))}),this.#e()==="text"&&h.classList.add("visible"),this.elements={container:n,title:o,select:this.select.elements,numbers:l,text:h},this.mode=this._mode,typeof e?.disabled<"u"&&(this.disabled=e.disabled)}get color(){return this.input.state.value}get mode(){return this._mode}set mode(t){this._log.fn("set mode",t).debug(),this._mode=t,this.select.selected=t}updateMode;#t;get a(){return this.mode==="rgba"?this.color.rgba.r:this.color.hsla.h}set a(t){this.mode==="rgba"?this.color.red=t:this.color.hue=t,this._locked=!0,this.input.refresh()}get b(){return this.mode==="rgba"?this.color.rgba.g:this.color.hsla.s}set b(t){this.mode==="rgba"?this.color.green=t:this.color.saturation=t,this._locked=!0,this.input.refresh()}get c(){switch(this.mode){case"rgba":return this.color.blue;case"hsla":return this.color.lightness;case"hsva":default:return this.color.value}}set c(t){this.mode==="rgba"?this.color.blue=t:this.mode==="hsla"?this.color.lightness=t:this.mode==="hsva"&&(this.color.value=t),this._locked=!0,this.input.refresh()}get d(){return this.color.alpha}set d(t){this.color.alpha=t,this._locked=!0,this.input.refresh()}#e(){return["rgba","hsla","hsva"].includes(this.mode)?"numbers":"text"}#i;#n;#s;refresh;disable(){this.disabled||(this.disabled=!0),this.select.disable(),this.elements.text.disabled=!0;for(let[,t]of C(this.elements.numbers))t.disabled=!0;return this}enable(){this.disabled&&(this.disabled=!1),this.select.enable(),this.elements.text.disabled=!1;for(let[,t]of C(this.elements.numbers))t.disabled=!1;return this}dispose(){this.elements.title.remove(),this.elements.numbers.a.remove(),this.elements.numbers.b.remove(),this.elements.numbers.c.remove(),this.elements.container.remove(),this.elements.text.remove(),this.select.dispose(),this._evm.dispose()}};dt=rr([V,fi("design:type",Function),fi("design:paramtypes",[typeof InputColor>"u"?Object:InputColor,typeof Partial>"u"?Object:Partial])],dt);var kt=a((s,t,e,i,r)=>(s-t)*(r-i)/(e-t)+i,"mapRange");function gi(s,t=50){let e;return function(...i){clearTimeout(e),e=setTimeout(()=>{e=null,s(...i)},t)}}a(gi,"debounce");function sr(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var c=s.length-1;c>=0;c--)(o=s[c])&&(n=(r<3?o(n):r>3?o(t,e,n):o(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n}a(sr,"_ts_decorate");function pi(s,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,t)}a(pi,"_ts_metadata");var or={color:"#fff",swatches:[],handleSize:10,container:void 0,disabled:!1},ft=class{static{a(this,"ColorPicker")}input;opts;elements;element;_ctx;_height;_width;_resizeObserver;_gradientWhite;_gradientBlack;_dragging;_lockCursorPosition;_lastColor;_log;_evm;on;constructor(t,e){this.input=t,this._height=16*3,this._width=256,this._dragging=!1,this._lockCursorPosition=!1,this._evm=new E(["pointerdown","pointerup"]),this.on=this._evm.on.bind(this._evm),this.enable=()=>(this.disabled&&(this.disabled=!1),this.elements.container.classList.remove("fracgui-disabled"),this.elements.alphaSlider.disabled=!1,this.elements.hueSlider.disabled=!1,this.elements.canvas.style.pointerEvents="auto",this),this.disable=()=>(this.disabled||(this.disabled=!0),this.elements.container.classList.add("fracgui-disabled"),this.elements.alphaSlider.disabled=!0,this.elements.hueSlider.disabled=!0,this.elements.canvas.style.pointerEvents="none",this),this.setAlpha=u=>{this.input.state.value.alpha=Number(u.target.value),this.input.refresh()},this.refresh=()=>{this._log.fn("refresh").debug();let u=this.input.state.value;return this._lastColor?.hex===u.hex8String?this:(this._lastColor=u.clone(),this.elements.hueSlider.value=String(this.hue),this.elements.alphaSlider.value=String(this.alpha),this.elements.alphaSlider.style.color=u.hexString,this.draw(),this._lockCursorPosition?(this.elements.handle.style.background=u.hexString,this._lockCursorPosition=!1):this._updateHandle(),this)},this.draw=()=>{this._fill(`hsl(${this.hue}, 100%, 50%)`),this._fill(this._gradientWhite),this._fill(this._gradientBlack)},this._pointerUpClickLatch=!1,this._onPointerDown=u=>{this._log.fn("_onPointerDown").debug(),this._evm.emit("pointerdown"),this._dragging=!0,this._updateFromMousePosition(u),addEventListener("pointerup",this._onPointerUp,{once:!0})},this._onPointerMove=u=>{this._log.fn("_onPointerMove").debug(),this._dragging&&this._updateFromMousePosition(u)},this._onPointerUp=()=>{this._log.fn("_onPointerUp").debug(),this._evm.emit("pointerup"),this._dragging=!1,this._pointerUpClickLatch=!0},this._onClick=u=>{if(this._log.fn("_onClick"),this._pointerUpClickLatch){this._log.debug("Click latch triggered. Aborting."),this._pointerUpClickLatch=!1;return}this._log.debug(),this._updateFromMousePosition(u),this._dragging=!1},this._getColorAtPosition=(u,m)=>{this._log.fn("_getColorAtPosition").debug();let{width:y,height:v}=this.canvas.getBoundingClientRect(),p=this.opts.handleSize/3;return{s:kt(u,p,y-p,0,100),v:kt(m,p,v-p,100,0)}},this._updateStateFromHue=u=>{this._log.fn("_updateStateFromHue").debug(),this._lockCursorPosition=!0;let m=Number(u.target.value),{s:y,v,a:p}=this.input.state.value.hsva;this.input.state.value.hsva={h:m,s:y,v,a:p},this.input.set(this.input.state.value),this.elements.handle.style.background=this.input.state.value.hexString,this.draw()},this._updateHandle=(u=this.input.state.value)=>{this._drawHandle(this._getHandlePosition(u))},this._getHandlePosition=u=>{let{width:m,height:y}=this.canvas.getBoundingClientRect(),v=this.opts.handleSize/2;return{x:kt(u.hsv.s,0,100,v,m-v),y:kt(u.hsv.v,0,100,y-v,v)}},this._drawHandle=u=>{this.elements.handle.style.transform=`translate(${u.x}px, ${u.y}px)`,this.elements.handle.style.background=this.input.state.value.hexString};let i={...or,...e};this.opts=i,this._log=new b(`ColorPicker ${t.title}`,{fg:"lightgreen"}),this._log.fn("constructor").debug({opts:i,this:this}),this._lastColor=this.input.state.value.clone();let r=t.expanded?{}:{height:"0px"},n=f("div",{classes:["fracgui-input-color-picker-container"],parent:e?.container??t.elements.controllers.container,style:r});this.element=n;let o=f("canvas",{classes:["fracgui-input-color-picker-canvas"],parent:n,height:this._height}),c=gi(this._updateHandle,100);this._resizeObserver=new ResizeObserver(()=>c()),this._resizeObserver.observe(o);let l=f("div",{classes:["fracgui-input-color-picker-handle"],parent:n,style:{background:t.state.value.hexString}}),h=f("input",{type:"range",classes:["fracgui-input-range","fracgui-input-color-picker-hue"],parent:n,min:0,max:359});this._evm.listen(h,"input",this._updateStateFromHue),le(h,{parent:n,text:a(()=>`${this.input.state.value.hsla.h}`,"text"),placement:"top",offsetX:"0px",anchor:{x:"mouse",y:h.querySelector("#thumb")},style:{background:"var(--fracgui-bg-a)",color:"var(--fracgui-fg-a)"}});let d=f("input",{type:"range",classes:["fracgui-input-range","fracgui-input-color-picker-alpha"],parent:n,min:0,max:1,step:.01});this._evm.listen(d,"input",this.setAlpha),le(d,{parent:n,text:a(()=>`${this.input.state.value.alpha}`,"text"),placement:"top",offsetX:"0px",anchor:{x:"mouse",y:d.querySelector("#thumb")},style:{background:"var(--fracgui-bg-a)",color:"var(--fracgui-fg-a)"}}),this.elements={container:n,canvas:o,handle:l,hueSlider:h,alphaSlider:d},this.disabled=this.opts.disabled,this._ctx=o.getContext("2d"),this.canvas.width=this._width,this._evm.listen(this.canvas,"click",this._onClick),this._evm.listen(this.canvas,"pointerdown",this._onPointerDown),this._evm.listen(this.input.elements.container,"pointermove",this._onPointerMove,{passive:!0}),this._updateGradients(),setTimeout(this.draw,10),setTimeout(this._updateHandle,20)}get canvas(){return this.elements.canvas}get hue(){return this.input.state.value.hue}get alpha(){return this.input.state.value.alpha}enable;disable;set(t){this.input.state.value.set(t),this.input.refresh(),this.refresh()}setAlpha;refresh;draw;_fill(t){this._ctx.fillStyle=t,this._ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}_updateGradients(){this._gradientWhite=this._ctx.createLinearGradient(0,0,this.canvas.width,0),this._gradientWhite.addColorStop(0,"rgba(255,255,255,1)"),this._gradientWhite.addColorStop(1,"rgba(255,255,255,0)"),this._gradientBlack=this._ctx.createLinearGradient(0,0,0,this.canvas.height),this._gradientBlack.addColorStop(0,"rgba(0,0,0,0)"),this._gradientBlack.addColorStop(1,"rgba(0,0,0,1)")}_pointerUpClickLatch;_onPointerDown;_onPointerMove;_onPointerUp;_onClick;_updateFromMousePosition(t){this._log.fn("_updateFromMousePosition").debug();let{left:e,top:i,width:r,height:n}=this.canvas.getBoundingClientRect(),o=x(t.clientX-e,0,r),c=x(t.clientY-i,0,n),{s:l,v:h}=this._getColorAtPosition(o,c);this.input.state.value.hsv={h:this.hue,s:l,v:h},this.input.set(this.input.state.value),this._drawHandle(this._getHandlePosition(this.input.state.value))}_getColorAtPosition;_updateStateFromHue;_updateHandle;_getHandlePosition;_drawHandle;dispose(){this._ctx=null,this.elements.alphaSlider.remove(),this.elements.hueSlider.remove(),this.elements.handle.remove(),this.elements.canvas.remove(),this.elements.container.remove(),this._resizeObserver.disconnect(),this._evm.dispose()}};ft=sr([V,pi("design:type",Function),pi("design:paramtypes",[typeof InputColor>"u"?Object:InputColor,typeof Partial>"u"?Object:Partial])],ft);function mi(...s){let t=0,e=[...s],i=e.shift(),r=e.shift();function n(...o){if(t++>500)throw new Error("infinite loop detected! (500 iteration limit)");i&&r&&i.appendChild(r),i=r,r=o.shift(),r&&n(...o)}a(n,"mount"),n(...e)}a(mi,"append");var Zt=class{static{a(this,"CopySVG")}svg;back;front;check;constructor(){let t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.classList.add("icon","copy"),t.setAttribute("width","100%"),t.setAttribute("height","100%"),t.setAttribute("viewBox","0 0 24 24"),t.setAttribute("fill","none"),t.setAttribute("stroke","currentColor"),t.setAttribute("stroke-width","2"),t.setAttribute("stroke-linecap","round"),t.setAttribute("stroke-linejoin","round");let e=document.createElementNS("http://www.w3.org/2000/svg","rect");e.classList.add("front"),e.setAttribute("width","13"),e.setAttribute("height","13"),e.setAttribute("rx","1"),e.setAttribute("ry","1"),e.setAttribute("x","8"),e.setAttribute("y","8");let i=document.createElementNS("http://www.w3.org/2000/svg","rect");i.classList.add("back"),i.setAttribute("width","15"),i.setAttribute("height","15"),i.setAttribute("rx","1"),i.setAttribute("ry","1"),i.setAttribute("x","1"),i.setAttribute("y","1");let r=document.createElementNS("http://www.w3.org/2000/svg","path");return r.classList.add("check"),r.setAttribute("d","M17 9l-7 7-4-4"),r.setAttribute("fill","none"),r.setAttribute("stroke-width","2"),t.appendChild(e),t.appendChild(i),t.appendChild(r),this.svg=t,this.back=i,this.front=e,this.check=r,this}appendTo(t){t.appendChild(this.svg)}};var qt=class{static{a(this,"CopyButton")}container;text;message;button;icon;active;outro;#t;tooltip;constructor(t,e,i="Copy"){this.container=t,this.text=e,this.message=i,this.active=!1,this.outro=!1,this.copy=()=>{if(typeof navigator>"u"||this.active)return;let o=this.text();o&&(typeof o=="object"&&(o=JSON.stringify(o)),navigator.clipboard?.writeText?.(o),clearTimeout(this.#t),this.#e())},this.#e=()=>{this.active=!0,this.tooltip.show(),this.button.blur(),this.button.classList.add("active"),this.icon.svg.classList.add("active"),this.icon.front.setAttribute("x","5.5"),this.icon.front.setAttribute("y","5.5"),this.icon.front.setAttribute("rx","10"),this.icon.front.setAttribute("ry","10"),this.tooltip.text="Copied!",setTimeout(this.#i,1250)},this.#i=()=>{this.active=!1,this.outro=!0,this.button.classList.remove("active"),this.icon.svg.classList.remove("active"),this.icon.svg.classList.add("outro"),this.button.classList.add("outro"),this.icon.front.setAttribute("x","8"),this.icon.front.setAttribute("y","8"),this.icon.front.setAttribute("rx","1"),this.icon.front.setAttribute("ry","1"),setTimeout(this.#n,900)},this.#n=()=>{this.button.classList.remove("outro"),this.icon.svg.classList.remove("outro"),this.outro=!1,this.tooltip.hide(),clearTimeout(this.#t),this.#t=setTimeout(()=>{this.tooltip.text=this.message},300)};let r=f("div",{classes:["copy-button"],title:"Copy",attributes:{"aria-label":"Copy",title:"Copy"}}),n=f("div",{classes:["copy-button-svg-container"]});this.button=r,this.icon=new Zt,this.button.addEventListener("click",this.copy),mi(t,this.button,n,this.icon.svg),this.tooltip=new $(this.button,{text:i,placement:"top",offsetY:"6px",delay:300,parent:t,style:{minWidth:"4.25rem",background:"var(--fracgui-bg-a)",color:"var(--fracgui-fg-a)"}})}copy;#e;#i;#n};var ar={__type:"ColorInputOptions",value:"#FF0000FF",mode:"hex",expanded:!1},gt=class s extends A{static{a(this,"InputColor")}__type="InputColor";initialValue;state;picker;components;expanded;_mode;get mode(){return this._mode}set mode(t){this._mode=t,this.components.mode=t}_log;constructor(t,e){let i=Object.assign({},ar,t,{__type:"ColorInputOptions"});super(i,e),this.expanded=i.expanded,this._mode=i.mode,this._log=new b(`InputColor ${i.title}`,{fg:"cyan"}),this._log.fn("constructor").debug({opts:i,this:this}).groupEnd(),i.binding?(this.initialValue=new D(i.binding.target[i.binding.key]),this.state=_(this.initialValue.clone()),this._evm.add(this.state.subscribe(o=>{i.binding.target[i.binding.key]=o}))):(this.initialValue=new D(i.value),this.state=_(this.initialValue.clone()));let r=f("div",{classes:["fracgui-input-color-container"],parent:this.elements.content});this.elements.controllers.container=r,this.elements.controllers.currentColor=this._createCurrentColor(r);let n=f("div",{classes:["fracgui-input-color-body"],parent:r});this.picker=new ft(this,{container:n}),this.components=new dt(this,{container:n}),this.elements.controllers.body={container:n,picker:this.picker.elements,components:this.components.elements},this._dirty=()=>this.state.value.hex!==this.initialValue.hex,setTimeout(()=>{this.expanded?this.open():this.close(0)},10),this._emit("change"),this.refresh(),this.picker.on("pointerdown",this._lock),this.picker.on("pointerup",this._unlock)}set(t){if(ht(t))this.commit({to:t.rgba,from:this.state.value.rgba,setter:a(i=>{this.state.value.set(i),this.state.refresh(),this.refresh()},"setter")}),this.state.set(new D(t.rgba));else{let i=new D(t);this.commit({to:i.rgba,from:this.state.value.rgba,setter:a(r=>{this.state.value.set(r),this.state.refresh(),this.refresh()},"setter")}),this.state.set(i)}let e=this.state.value;return this._log.fn("set").debug({v:t,newValue:e,this:this}),this._emit("change",e),this.refresh(e),this}refresh=a((t=this.state.value)=>(this._log.fn("refresh").debug({v:t,this:this}),this.elements.controllers.currentColor.display.style.backgroundColor=t.hex,this.picker.refresh(),this.components.refresh(),super.refresh(),this),"refresh");get aTitle(){return this.mode==="rgba"?"r":"h"}get bTitle(){return this.mode==="rgba"?"g":"s"}get cTitle(){return this.mode==="rgba"?"b":this.mode==="hsla"?"l":"v"}get dTitle(){return"a"}_createCurrentColor(t){let e=f("div",{classes:["fracgui-input-color-current-color-container"],parent:t}),i=f("div",{classes:["fracgui-input-color-current-color-background"],parent:e}),r=f("div",{classes:["fracgui-input-color-current-color-display"],parent:i});this._evm.listen(r,"click",this.togglePicker);let n=new qt(e,()=>this.state.value.hex,"Copy Hex");return{container:e,displayBackground:i,display:r,copyButton:n}}static#t="75px";get _pickerContainer(){return this.picker.elements.container}togglePicker=a(async()=>{this.expanded?await this.close():await this.open()},"togglePicker");open=a(async()=>{this.expanded=!0,this.elements.container.dataset.search_height="100px";let t=this._pickerContainer?.animate([{height:"0px",clipPath:"inset(0 0 100% 0)"},{height:s.#t,clipPath:"inset(0 0 -50% 0)"}],{duration:200,easing:"cubic-bezier(.08,.38,0,0.92)",fill:"forwards"}),e=this.elements.container.animate({maxHeight:"100px",height:"100px"},{duration:200,easing:"cubic-bezier(.08,.38,0,0.92)",fill:"forwards"});this._pickerContainer?.style.setProperty("overflow","visible"),this._pickerContainer?.classList.add("expanded"),await Promise.all([t?.finished,e?.finished]),this._pickerContainer&&document.contains(this._pickerContainer)&&t?.commitStyles(),this.elements.container&&document.contains(this.elements.container)&&e?.commitStyles()},"open");close=a(async(t=300)=>{this.expanded=!1,delete this.elements.container.dataset.search_height;let e=this._pickerContainer?.animate([{height:s.#t,clipPath:"inset(0 0 -100% 0)"},{height:"0px",clipPath:"inset(0 0 100% 0)"}],{duration:t,easing:"cubic-bezier(.13,.09,.02,.96)",fill:"forwards"}),i=this.elements.container.animate({minHeight:"var(--fracgui-input_height)",maxHeight:"var(--fracgui-input_height)",height:"var(--fracgui-input_height)"},{duration:t,easing:"cubic-bezier(.13,.09,.02,.96)",fill:"forwards"});this._pickerContainer?.style.setProperty("overflow","hidden"),this._pickerContainer?.classList.remove("expanded"),await Promise.all([e?.finished,i?.finished]),this._pickerContainer&&document.contains(this._pickerContainer)&&e?.commitStyles(),this.elements.container&&document.contains(this.elements.container)&&i?.commitStyles()},"close");_lock=a(()=>{this.lock(this.state.value.rgba)},"_lock");_unlock=a(()=>{this.unlock({target:this,to:this.state.value.rgba,setter:a(t=>{this.state.value.set(t),this.state.refresh(),this._emit("change",this.state.value),this.refresh()},"setter")})},"_unlock");enable(){return this.picker.enable(),super.enable(),this}disable(){return this.picker.disable(),super.disable(),this}save(){return super.save({value:this.state.value.hex})}load(t){let e=typeof t=="string"?JSON.parse(t):t;this.id=e.presetId,this.disabled=e.disabled,this.hidden=e.hidden,this.initialValue=new D(e.value),this.set(this.initialValue.clone())}dispose(){this._log.fn("dispose").debug({this:this}),this.picker.dispose(),super.dispose()}};var bi=a((s,t,e)=>f("input",{type:"textarea",classes:["fracgui-controller","fracgui-controller-text"],value:s.state.value,parent:e,attributes:{spellcheck:"false"}}),"textController");var cr={__type:"TextInputOptions",value:"foo",maxLength:50},pt=class extends A{static{a(this,"InputText")}__type="InputText";initialValue;state;#t;constructor(t,e){let i=Object.assign({},cr,t);super(i,e),this.#t=new b(`InputText ${i.title}`,{fg:"cyan"}),this.#t.fn("constructor").info({opts:i,this:this}),i.binding?(this.initialValue=i.binding.target[i.binding.key],this.state=_(this.initialValue),this._evm.add(this.state.subscribe(n=>{i.binding.target[i.binding.key]=n}))):(this.initialValue=i.value,this.state=_(i.value));let r=f("div",{classes:["fracgui-input-text-container"],parent:this.elements.content});this.elements.controllers={container:r,input:bi(this,i,r)},this._evm.listen(this.elements.controllers.input,"input",this.set),this._evm.add(this.state.subscribe(()=>{this.refresh()}))}enable(){return super.enable(),this.elements.controllers.input.disabled=!1,this}disable(){return super.disable(),this.elements.controllers.input.disabled=!0,this}set=a(t=>{if(!(typeof t>"u"))return typeof t!="string"?t?.target&&"value"in t.target&&(this.commit({to:t.target.value}),this.state.set(t.target.value)):(this.commit({to:t}),this.state.set(t)),this._emit("change",this.state.value),this},"set");refresh=a(()=>{let t=this.state.value;return this.elements.controllers.input.value=t,super.refresh(t),this},"refresh");dispose(){super.dispose()}};function be(s){let n="var(--fracgui-theme-a)",o="var(--fracgui-theme-a)",c=document.createElement("div");c.classList.add("fracgui-folder-icon-container");let l=s.allChildren.length+s.inputs.size;c.style.setProperty("filter",`hue-rotate(${s.hue}deg)`);let h=[{id:1,cx:16.43,cy:11.93,r:1.1103},{id:2,cx:15.13,cy:15.44,r:.8081},{id:3,cx:15.13,cy:8.423,r:.8081},{id:4,cx:12.49,cy:16.05,r:.4788},{id:5,cx:12.42,cy:7.876,r:.545},{id:6,cx:10.43,cy:15.43,r:.2577},{id:7,cx:10.43,cy:8.506,r:.2769},{id:8,cx:17.85,cy:14.59,r:.5635},{id:9,cx:17.85,cy:9.295,r:.5635},{id:10,cx:19.19,cy:12.95,r:.5635},{id:11,cx:19.19,cy:10.9,r:.5635},{id:12,cx:20.38,cy:11.96,r:.2661},{id:13,cx:19.74,cy:14.07,r:.2661},{id:14,cx:19.74,cy:9.78,r:.2661},{id:15,cx:20.7,cy:12.96,r:.2661},{id:16,cx:20.7,cy:10.9,r:.2661},{id:17,cx:21.38,cy:11.96,r:.2661}];function d(T){return`<circle
				class="alt c${T.id}"
				cx="${T.cx*1.1}"
				cy="${T.cy}"
				r="${T.r}"
				style="transition-delay: ${T.id*.05}s;"
			/>`}a(d,"circ");function u(T){return T.map(M=>d(h[M-1])).join(`
`)}a(u,"toCircs");let y=u({0:[],1:[1],2:[2,3],3:[1,2,3],4:[2,3,4,5],5:[1,2,3,4,5],6:[2,3,4,5,6,7],7:[1,2,3,4,5,6,7],8:[1,2,3,4,5,6,7,8],9:[1,2,3,4,5,6,7,8,9],10:[1,2,3,4,5,6,7,8,9,10],11:[1,2,3,4,5,6,7,8,9,10,11],12:[1,2,3,4,5,6,7,8,9,10,11,12],13:[1,2,3,4,5,6,7,8,9,10,11,12,13],14:[1,2,3,4,5,6,7,8,9,10,11,12,13,14],15:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],16:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],17:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]}[Math.min(l,h.length)]),v="cubic-bezier(0.36, 0, 0.66, -0.56)",p="cubic-bezier(0.23, 1, 0.320, 1)",w=`
			.fracgui-folder-icon {
				overflow: visible;
				backface-visibility: hidden;
			}

			.fracgui-folder-icon circle, .fracgui-folder-icon line {
				transform-origin: center;

				transition-duration: 0.25s;
				transition-timing-function: ${p};
				backface-visibility: hidden;
			}

			/*//?	Circle A	*/
			.closed .fracgui-folder-icon circle.a {
				transform: scale(1);
				
				stroke: transparent;
				fill: ${n};
				
				transition: all .5s ${v}, stroke 2s ${v}, fill .2s ${v} 0s;
			}
			.fracgui-folder-icon circle.a {
				transform: scale(0.66);

				stroke: ${n};
				fill: ${o};

				transition: all .33s ${v}, stroke 2s ${v}, fill .2s ease-in 0.25s;
			}

			/*//?	Circle Alt	*/
			.closed .fracgui-folder-icon circle.alt {
				transform: translate(-3px, 0) scale(1.8);

				transition-duration: 0.5s;
				transition-timing-function: ${p};
			}
			 .fracgui-folder-icon circle.alt {
				transform: translate(0, 0) scale(0);

				stroke: none;
				fill: ${o};

				transition-duration: 0.75s;
				transition-timing-function: ${p};
			}
		`.trim();return c.innerHTML=`
		<svg
			xmlns="http://www.w3.org/2000/svg"
			width="100%"
			height="100%"
			viewBox="0 0 24 24"
			fill="none"
			stroke-width="1"
			stroke-linecap="round"
			stroke-linejoin="round"
			class="fracgui-folder-icon"
			overflow="visible"
		>
			<circle class="a" cx="12" cy="12" r="4" stroke="${o}" fill="${n}" />

			${y}

			<style lang="css">
				${w}
			</style>
		</svg>`.trim(),s.closed.value&&c.classList.add("closed"),c}a(be,"createFolderSvg");function vi(s){let t=f("div",{classes:["fracgui-connector-container"]}),e=20,i=s.element.clientHeight,r=1,n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttribute("class","fracgui-connector-svg"),n.setAttribute("width",`${e}`),n.setAttribute("stroke-width",`${r}`),n.setAttribute("viewBox",`0 0 ${e} ${i}`),n.setAttribute("overflow","visible"),n.setAttribute("backface-visibility","hidden"),n.setAttribute("preserveAspectRatio","xMinYMin slice"),n.style.setProperty("filter",`hue-rotate(${s.hue}deg)`);let o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("vector-effect","non-scaling-stroke"),o.setAttribute("fill","none"),o.setAttribute("stroke","var(--fracgui-theme-a)"),o.setAttribute("stroke-width",`${r}`),o.setAttribute("stroke-linecap","round"),o.setAttribute("stroke-linejoin","round"),o.setAttribute("d",`M10,0 Q0,0 0,10 L0,${i}`);let c=s.elements.header.clientHeight;o.setAttribute("transform",`translate(0, ${c/2})`);let l=document.createElementNS("http://www.w3.org/2000/svg","defs"),h=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");h.setAttribute("id","gradient"),h.setAttribute("x1","0%"),h.setAttribute("y1","0%"),h.setAttribute("x2","0%"),h.setAttribute("y2","100%");function d(u,m,y="var(--fracgui-theme-a)"){let v=document.createElementNS("http://www.w3.org/2000/svg","stop");return v.setAttribute("offset",`${u}%`),v.setAttribute("style",`stop-color: ${y}; stop-opacity: ${m}`),h.appendChild(v),v}return a(d,"stop"),d(0,.5),d(1,.5),d(5,.4),d(20,.3),d(40,.2),d(100,.2),o.setAttribute("stroke","url(#gradient)"),l.appendChild(h),n.insertBefore(l,n.firstChild),n.appendChild(o),t.appendChild(n),{container:t,svg:n,path:o}}a(vi,"createFolderConnector");function ve(s,t){if(!s.graphics?.connector)return;let e=s.graphics.connector.path,i=`${e.getTotalLength()}`;e.style.strokeDasharray=`${i}`;let{duration:r,from:n,to:o,delay:c,easing:l}=t==="open"?{duration:600,delay:0,from:i,easing:"cubic-bezier(.29,.1,.03,.94)",to:"0"}:{duration:150,delay:0,from:"0",easing:"cubic-bezier(.15,.84,.19,.98)",to:i},h=[{strokeDashoffset:n},{strokeDashoffset:o}],d={duration:r,delay:c,easing:l,fill:"forwards"};s.graphics.connector.path.animate(h,d)}a(ve,"animateConnector");function yi(s,t){return s.composedPath().some(e=>e.classList?.contains(t))}a(yi,"composedPathContains");function lr(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var c=s.length-1;c>=0;c--)(o=s[c])&&(n=(r<3?o(n):r>3?o(t,e,n):o(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n}a(lr,"_ts_decorate");function _i(s,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,t)}a(_i,"_ts_metadata");var mt=class{static{a(this,"TerminalSvg")}class="fracgui-terminal-icon";element;classes=[this.class,"fracgui-cancel"];constructor(t){let e=t.isRoot?t.elements.header:t.elements.title;t.isRoot&&this.classes.push("fracgui-terminal-icon-root"),this.element=f("div",{parent:e,classes:this.classes,innerHTML:`
                <svg class="icon terminal" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="4 17 10 11 4 5"></polyline>
                    <line x1="12" x2="20" y1="19" y2="19"></line>
                </svg>
                `.replaceAll(/\t|\n/g,""),tooltip:{text:"<code>console.log(folder)</code>",delay:1500,placement:"right"},onclick:a(i=>{i.stopPropagation(),i.preventDefault(),console.log(t)},"onclick")})}static style=`
        .fracgui-terminal-icon {
            position: absolute;
            right: -1.5rem;
            top: 0;
            bottom: 0;

            width: 16px;
            height: 16px;

            color: var(--fracgui-fg-d);
            transform: translateY(15%);
            opacity: 0;

            transition: opacity 0.2s;
            transition-delay: 0.5s;

            z-index: 1;
        }

        .fracgui-terminal-icon-root {
            right: unset;
            left: 0.5rem;
            top: 0.25rem;
        }


        .fracgui-terminal-icon:hover {
            opacity: 0.75;
        }

        .fracgui-terminal-icon svg {
            width: 100%;
            height: 100%;
        }
    `};mt=lr([B,_i("design:type",Function),_i("design:paramtypes",[typeof Folder>"u"?Object:Folder])],mt);function wi(s,t){let e=s.length,i=t.length;if(e>i)return!1;if(e===i)return s===t;t:for(let r=0,n=0;r<e;r++){let o=s.charCodeAt(r);for(;n<i;)if(t.charCodeAt(n++)===o)continue t;return!1}return!0}a(wi,"fuzzysearch");var Qt=class{static{a(this,"Search")}folder;elements;needle;showing;tooltip;get defaultTooltipText(){return"Search "+(this.folder.isRoot?"All":this.folder.title)}_evm;constructor(t){this.folder=t,this.needle="",this.showing=!1,this._evm=new E,this.search=o=>{this.needle=o;for(let[c,l]of this.folder.allInputs){let h=wi(this.needle.toLocaleLowerCase(),c.toLowerCase())?"hit":"miss",d=this.needle===""?"hit":h,u=l.elements.container;if(u.dataset.search===d)continue;let m=getComputedStyle(u);u.dataset.search_height??=m.minHeight,u.dataset.search_overflow??=m.overflow??"unset",u.dataset.search_contain??=m.contain??"none",u.dataset.search_opacity??=m.opacity??1,d==="hit"?this._expandInput(u):d==="miss"&&this._collapseInput(u),u.dataset.search=d}},this._expandInput=async o=>{if(o.dataset.search==="miss"){o.style.setProperty("overflow",o.dataset.search_overflow),o.style.setProperty("contain",o.dataset.search_contain);let c=o.dataset.search_height??"100%",l=o.animate([{opacity:0,height:"0px",minHeight:"0px"},{opacity:1,height:c,minHeight:c}],{duration:300,easing:"cubic-bezier(0.23, 1, 0.32, 1)",fill:"forwards"});await l.finished,l.commitStyles()}},this._collapseInput=async o=>{o.style.setProperty("overflow","hidden"),o.style.setProperty("contain","size");let c=o.animate([{opacity:0,height:"0px",minHeight:"0px"}],{duration:300,easing:"cubic-bezier(0.23, 1, 0.32, 1)",fill:"forwards"});await c.finished,c.commitStyles()},this.clear=()=>{for(let[,o]of this.folder.allInputs)this._expandInput(o.elements.container)},this.toggle=o=>{o?.stopImmediatePropagation(),this.showing?this.close():this.open()},this.open=()=>{this.showing=!0,this.elements.container.classList.add("active"),this.elements.input.focus(),removeEventListener("click",this._clickOutside),addEventListener("click",this._clickOutside),removeEventListener("keydown",this._escape),addEventListener("keydown",this._escape),this.tooltip.hide(),clearTimeout(this._tooltipTimeout),this._tooltipTimeout=setTimeout(()=>{this.tooltip.text="Cancel (esc)",this.tooltip.placement="top",this.tooltip.offsetX="-40px",this.tooltip.offsetY="-2px"},100);for(let o of this.folder.allChildren)o.closed.value&&(o.element.dataset.searchclosed="true",o.open())},this.close=()=>{this.showing=!1,this.elements.container.classList.remove("active"),(document.activeElement===this.elements.input||document.activeElement===this.elements.button)&&document.activeElement?.blur(),this.clear(),removeEventListener("click",this._clickOutside),removeEventListener("keydown",this._escape),this.tooltip.hide(),clearTimeout(this._tooltipTimeout),this._tooltipTimeout=setTimeout(()=>{this.tooltip.text=this.defaultTooltipText,this.tooltip.placement="left",this.tooltip.offsetX=Dt.offsetX,this.tooltip.offsetY=Dt.offsetY},100);for(let o of this.folder.allChildren)o.element.dataset.searchclosed&&(o.element.dataset.searchclosed="",o.close())},this._clickOutside=o=>{!this.needle&&!o.composedPath().includes(this.elements.container)&&this.close()},this._escape=o=>{o.key==="Escape"&&this.close()};let e=f("div",{classes:["fracgui-toolbar-item","fracgui-search-container"]});t.elements.toolbar.container.prepend(e);let i=f("input",{classes:["fracgui-controller-text","fracgui-search-input","fracgui-cancel"],parent:e});this._evm.listen(i,"input",o=>this.search(o.target.value));let r=f("button",{classes:["fracgui-search-button","fracgui-cancel"],parent:e});this.tooltip=new $(r,{text:this.defaultTooltipText,placement:"left",delay:500});let n=this._searchIcon();return r.appendChild(n),this._evm.listen(r,"click",this.toggle),this.elements={container:e,input:i,button:r,icon:n},this}search;_expandInput;_collapseInput;clear;toggle;_tooltipTimeout;open;close;_clickOutside;_escape;_searchIcon(){let t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("aria-hidden","true"),t.setAttribute("width","100%"),t.setAttribute("height","100%"),t.setAttribute("viewBox","0 0 20 20"),t.setAttribute("fill","none"),t.setAttribute("stroke","currentColor"),t.setAttribute("stroke-width","2"),t.setAttribute("stroke-linecap","round"),t.setAttribute("stroke-linejoin","round");let e=document.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("d","M13.34 13.34 L19 19"),t.appendChild(e);let i=document.createElementNS("http://www.w3.org/2000/svg","circle");return i.setAttribute("cx","8"),i.setAttribute("cy","8"),i.setAttribute("r","7"),t.appendChild(i),t.classList.add("search-icon"),t.style.pointerEvents="none",t}dispose(){this._evm.dispose(),this.tooltip.dispose(),this.elements.container.remove()}};var ur=Object.freeze({presetId:"",title:"",children:[],closed:!1,hidden:!1,controls:new Map,saveable:!0}),xi={__type:"InternalFolderOptions",parentFolder:void 0,isRoot:!0,_skipAnimations:!0,gui:void 0,_headerless:!1},St=class s{static{a(this,"Folder")}__type="Folder";isRoot=!0;id=L();gui;presetId;saveable;children=[];inputs=new Map;root;parentFolder;settingsFolder;closed=_(!1);element;elements={};graphics;evm=new E(["change","refresh","toggle","mount"]);on=this.evm.on.bind(this.evm);_title;_hidden=a(()=>!1,"_hidden");_log;_disabledTimer;_clickTime=200;_clicksDisabled=!1;_depth=-1;constructor(t){if(!("container"in t))throw new Error("Folder must have a container.");let e=Object.assign({},ur,xi,{gui:this.gui,isRoot:!0},t);if(this._log=new b(`Folder ${e.title}`,{fg:"DarkSalmon"}),this._log.fn("constructor").debug({opts:e,this:this}),this.isRoot=e.isRoot,this.isRoot)this._depth=0,this.parentFolder=this,this.root=this;else{if(!e.parentFolder)throw new Error("Non-root folders must have a parent folder.");this.parentFolder=e.parentFolder,this._depth=this.parentFolder._depth+1,this.root=this.parentFolder.root}this.gui=e.gui,this._title=e.title??"",this.element=this._createElement(e.container),this.elements=this._createElements(this.element),this.presetId=this.resolvePresetId(e),this.saveable=!!e.saveable,(this.isRoot||e.searchable)&&new Qt(this),e._skipAnimations&&(this.element.classList.add("instant"),setTimeout(()=>{this.element.classList.remove("instant")},0)),this.hidden=e.hidden?k(e.hidden):()=>!1,this.evm.add(this.closed.subscribe(i=>{i?this.close():this.open(),this.evm.emit("toggle",i)})),this._createGraphics(e._headerless).then(()=>{e.closed&&this.closed.set(e.closed),this.evm.emit("mount")})}get title(){return this._title}set title(t){t!==this._title&&(this._title=t,this.elements.title.animate({opacity:0,transform:"translateY(-0.33rem)"},{duration:75,easing:"ease-out",fill:"forwards"}).onfinish=()=>{this.elements.title.textContent=t,this.elements.title.animate([{opacity:0,transform:"translateY(.33rem)"},{opacity:1,transform:"translateY(0rem)"}],{delay:0,duration:75,easing:"ease-in",fill:"forwards"})})}get hidden(){return this._hidden()}set hidden(t){this._hidden=k(t),this._hidden()?this.hide():this.show()}get allChildren(){return this.children.flatMap(t=>[t,...t.allChildren])}get allInputs(){let t=new Map;for(let e of[this,...this.allChildren])for(let[i,r]of e.inputs.entries())t.set(i,r);return t}isRootFolder(){return this.isRoot}addFolder(t,e){e??={},e.title??=t,this._log.fn("addFolder").debug({options:e,this:this});let i=Object.assign({},xi,{parentFolder:this,depth:this._depth+1,gui:this.gui}),r={__type:"InternalFolderOptions",container:this.elements.content,isRoot:!1},n=Object.assign({},i,e,r),o=new s(n);return o.on("change",c=>this.evm.emit("change",c)),this.children.push(o),this._createSvgs(),n._headerless&&(o.elements.header.style.display="none"),o}_handleClick(t){if(t.button===0){if(this._log.fn("#handleClick").debug({event:t,this:this}),this.element.removeEventListener("pointerup",this.toggle),this.element.addEventListener("pointerup",this.toggle,{once:!0}),yi(t,"fracgui-cancel"))return this._disableClicks();clearTimeout(this._disabledTimer),this._disabledTimer=setTimeout(()=>{this.elements.header.removeEventListener("pointermove",this._disableClicks),this.elements.header.addEventListener("pointermove",this._disableClicks,{once:!0}),this._disabledTimer=setTimeout(()=>{this.elements.header.removeEventListener("pointermove",this._disableClicks),this.element.removeEventListener("pointerup",this.toggle),this._clicksDisabled=!1},this._clickTime)},150),this._clicksDisabled}}_disableClicks=a(()=>{this._clicksDisabled||(this._clicksDisabled=!0,this._log.fn("disable").debug("Clicks DISABLED")),this._clicksDisabled=!0,clearTimeout(this._disabledTimer)},"_disableClicks");_resetClicks(){this._log.fn("cancel").debug("Clicks ENABLED"),removeEventListener("pointerup",this.toggle),this._clicksDisabled=!1}toggle=a(()=>{if(this._log.fn("toggle").debug(),clearTimeout(this._disabledTimer),this._clicksDisabled){this._resetClicks();return}if(this.element.classList.contains("fracgui-dragged")){this.element.classList.remove("fracgui-dragged");return}let t=!this.closed.value;this.closed.set(t),this.evm.emit("toggle",t)},"toggle");open(t=!1){this._log.fn("open").debug(),this.element.classList.remove("closed"),t&&this.closed.set(!1),this._clicksDisabled=!1,this.#e(),ve(this,"open")}close(t=!1){this._log.fn("close").debug(),this.element.classList.add("closed"),t&&this.closed.set(!0),this._clicksDisabled=!1,this.#e(),ve(this,"close")}toggleHidden(){this._log.fn("toggleHidden").debug(),this.element.classList.toggle("hidden")}hide(){this._log.fn("hide").error(),this.element.classList.add("hidden")}show(){this._log.fn("show").debug(),this.element.classList.remove("hidden")}#t;#e=a(()=>{this.element.classList.add("animating"),clearTimeout(this.#t),this.#t=setTimeout(()=>{this.element.classList.remove("animating")},600)},"#toggleAnimClass");resolvePresetId=a(t=>{this._log.fn("resolvePresetId").debug({opts:t,this:this});let e=a(n=>n.isRootFolder.bind(n)||n.parentFolder!==this?[n.title]:[...e(n.parentFolder),n.title],"getPaths"),i=e(this),r=t?.presetId||i.join("__");if(!r){let n=0;for(let o of this.allChildren)o.presetId==r&&n++;n>0&&(r+=n)}return r},"resolvePresetId");save(){if(this._log.fn("save").debug({this:this}),this.saveable!==!0)throw new Error("Attempted to save unsaveable Folder: "+this.title);return{__type:"FolderPreset",id:this.presetId,title:this.title,closed:this.closed.value,hidden:k(this._hidden)(),children:this.children.filter(e=>e.title!==it.settingsFolderTitle&&e.saveable).map(e=>e.save()),inputs:Array.from(this.inputs.values()).filter(e=>e.opts.saveable).map(e=>e.save())}}load(t){this._log.fn("load").debug({preset:t,this:this}),this.closed.set(t.closed),this.hidden=t.hidden;for(let e of this.children){let i=t.children?.find(r=>r.id===e.presetId);i&&e.load(i)}for(let e of this.inputs.values()){let i=t.inputs.find(r=>r.presetId===e.id);i&&e.load(i)}}refresh(){this._log.fn("refresh").debug(this);for(let t of this.inputs.values())t.refresh()}refreshAll(){for(let t of this.allInputs.values())t.refresh();this.evm.emit("refresh")}addMany(t,e){let i=e?.folder??this;for(let[r,n]of Object.entries(t))if(typeof n=="object"){if(ht(n)){this.addColor({title:r,value:n});continue}let o=i.addFolder(r);o.addMany(n,{folder:o})}else{let o={title:r,value:n,binding:{target:t,key:r}};typeof n=="number"&&(n>0?(o.max=n*2,o.step=n/10,o.min=0):n==0?(o.min=-1,o.step=.01,o.max=1):(o.min=n*2,o.step=n/10,o.max=0)),this.add(o)}}add(t,e){let i=this._resolveOptions(t,e),r=this._createInput(i);return this.inputs.set(r.id,r),this._refreshIcon(),r}bind(t,e,i){let r=t[e],n=i??{};n.title??=e,n.binding={target:t,key:e,initial:r};let o=this._createInput(n);return this.inputs.set(o.id,o),this._refreshIcon(),o}addNumber(t,e){let i=this._resolveOptions(t,e),r=new ut(i,this);return this.inputs.set(r.id,r),this._refreshIcon(),r}bindNumber(t,e,i){let r=this._resolveBinding(t,e,i),n=new ut(r,this);return this.inputs.set(n.title,n),this._refreshIcon(),n}addText(t,e){let i=this._resolveOptions(t,e),r=new pt(i,this);return this.inputs.set(r.id,r),this._refreshIcon(),r}bindText(t,e,i){let r=this._resolveBinding(t,e,i),n=new pt(r,this);return this.inputs.set(n.title,n),this._refreshIcon(),n}addColor(t,e){let i=this._resolveOptions(t,e),r=new gt(i,this);return this.inputs.set(r.id,r),this._refreshIcon(),r}bindColor(t,e,i){let r=this._resolveBinding(t,e,i),n=new gt(r,this);return this.inputs.set(n.title,n),this._refreshIcon(),n}addButton(t,e){let i=this._resolveOptions(t,e),r=new lt(i,this);return this.inputs.set(r.id,r),this._refreshIcon(),r}bindButton(t,e,i){let r=this._resolveBinding(t,e,i),n=new lt(r,this);return this.inputs.set(n.title,n),this._refreshIcon(),n}addButtonGrid(t,e){let i=this._resolveOptions(t,e),r=new wt(i,this);return this.inputs.set(r.id,r),this._refreshIcon(),r}bindButtonGrid(t,e,i){let r=this._resolveBinding(t,e,i),n=new wt(r,this);return this.inputs.set(n.title,n),this._refreshIcon(),n}addSelect(t,e){let i=this._resolveOptions(t,e),r=new W(i,this);return this.inputs.set(r.id,r),this._refreshIcon(),r}bindSelect(t,e,i){let r=this._resolveBinding(t,e,i),n=new W(r,this);return this.inputs.set(n.title,n),this._refreshIcon(),n}addSwitch(t,e){let i=this._resolveOptions(t,e),r=new ct(i,this);return this.inputs.set(r.id,r),this._refreshIcon(),r}bindSwitch(t,e,i){let r=this._resolveBinding(t,e,i),n=new ct(r,this);return this.inputs.set(n.title,n),this._refreshIcon(),n}_validateOptions(t,e){if(t.binding?.key&&!t.title&&(t.title=t.binding.key),e){let i=t.binding,r=t.value;if(r||(r=i?.target[i?.key]),!r)if(i){let n=!1;if(typeof i.target>"u"&&(n=!0,console.error('\x1B[96mgooey\x1B[39m ~ \x1B[91mError\x1B[39m Binding "target" is undefined:',i)),typeof i.key>"u"&&(n=!0,console.error('\x1B[96mgooey\x1B[39m ~ \x1B[91mError\x1B[39m Binding "key" is undefined:',i)),typeof i.target[i.key]>"u"&&(n=!0,console.error(`\x1B[96mgooey\x1B[39m ~ \x1B[91mError\x1B[39m The provided binding key \x1B[33m"${i.key}"\x1B[39m does not exist on provided \x1B[33mtarget\x1B[39m:`,i)),n)throw new Error("gooey ~ Failed to bind input to the provided target object.",{cause:t})}else throw new Error("gooey ~ No value or binding provided.",{cause:t})}return t}_createInput(t){this._log.fn("#createInput").debug(this);let e=this._resolveType(t);switch(t=this._validateOptions(t),e){case"InputText":return new pt(t,this);case"InputNumber":return new ut(t,this);case"InputColor":return new gt(t,this);case"InputSelect":return new W(t,this);case"InputButton":return new lt(t,this);case"InputSwitch":return new ct(t,this)}throw new Error("Invalid input type: "+e+" for options: "+t)}_resolveOptions(t,e){let i=typeof t=="string"&&typeof e=="object",r=i?t:e?.title??"",n=i?e:t;return n.title??=r,n}_resolveBinding(t,e,i){let r,n=!1;if(typeof t=="string")r=e??{},r.title=t;else{n=!0;let o=t,c=e;r=i??{},r.binding={target:o,key:c,initial:o[c]}}return this._validateOptions(r,n)}_resolveType(t){this._log.fn("resolveType").debug({options:t,this:this});let e=t.value??t.binding?.target[t.binding.key];if("onClick"in t)return"InputButton";if("options"in t&&Array.isArray(t.options)||R(e))return e??=t.options[0],t.value??=e,"InputSelect";switch(typeof e){case"boolean":return"InputSwitch";case"number":return"InputNumber";case"string":return me(e)?"InputColor":"InputText";case"function":return"InputButton";case"object":{if(Array.isArray(e))return"InputSelect";if(ht(e))return"InputColor";if(R(e))return"InputSelect";throw new Error("Invalid input view: "+JSON.stringify(e))}default:throw new Error("Invalid input view: "+e)}}_createElement(t){return this._log.fn("#createElement").debug({el:t,this:this}),this.isRoot?f("div",{id:`fracgui-root_${this.id}`,classes:["fracgui-root","fracgui-folder","closed"],dataset:{theme:this.gui.theme??"default"},parent:t}):f("div",{parent:this.parentFolder.elements.content,classes:["fracgui-folder","closed"]})}_createElements(t){this._log.fn("#createElements").debug({element:t,this:this});let e=f("div",{parent:t,classes:["fracgui-header"]});e.addEventListener("pointerdown",this._handleClick.bind(this));let i=f("div",{parent:e,classes:["fracgui-title"],textContent:this.title}),r=f("div",{parent:e,classes:["fracgui-toolbar"]}),n=f("div",{classes:["fracgui-content-wrapper"],parent:t}),o=f("div",{classes:["fracgui-content"],parent:n});return{header:e,toolbar:{container:r},title:i,contentWrapper:n,content:o}}async _createGraphics(t=!1){this._log.fn("createGraphics").debug({this:this}),await Promise.resolve(),this.isRootFolder()||(this.graphics={icon:be(this)},this.elements.header.prepend(this.graphics.icon),t||(this.graphics.connector=vi(this),this.element.prepend(this.graphics.connector.container))),!1}_createSvgs(){this._log.fn("#createSvgs").debug({this:this})}get hue(){let t=this.parentFolder.children.indexOf(this),e=this.parentFolder.isRootFolder()?t-1:t,i=this._depth-1;return e*20+i*80}_refreshIcon(){this._log.fn("#refreshIcon").debug(this),this.graphics&&this.graphics.icon.replaceWith(be(this))}disposed=!1;dispose(){if(this.disposed&&!1){this._log.fn("dispose").error("Already disposed.",this);return}this.elements.header.removeEventListener("click",this.toggle),this.elements.header.addEventListener("pointerdown",this._handleClick),this.element.remove();for(let t of this.inputs.values())t.dispose();for(let t of this.children)t.dispose();try{this.parentFolder.children.splice(this.parentFolder.children.indexOf(this),1)}catch(t){this._log.fn("dispose").error("Error removing folder from parent",{err:t})}this.disposed=!0}};function hr(s,t,e,i){var r=arguments.length,n=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(s,t,e,i);else for(var c=s.length-1;c>=0;c--)(o=s[c])&&(n=(r<3?o(n):r>3?o(t,e,n):o(t,e))||n);return r>3&&n&&Object.defineProperty(t,e,n),n}a(hr,"_ts_decorate");function ki(s,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,t)}a(ki,"_ts_metadata");var ye={__type:"GuiStorageOptions",key:"fracgui",closed:!0,theme:!0,presets:!0,position:!1,size:!1},te={__type:"WindowManagerOptions",preserveZ:!1,zFloor:0,bounds:void 0,obstacles:void 0,resizable:{grabberSize:9,color:"var(--bg-d)",sides:["right","left"],corners:[]},draggable:{bounds:void 0,classes:{default:"fracgui-draggable",dragging:"fracgui-dragging",cancel:"fracgui-cancel",dragged:"fracgui-dragged"}}},Si={__type:"GuiOptions",title:"gui",storage:!1,closed:!1,position:"top-right",margin:16,container:"body",theme:"default",themeMode:"dark",themes:[Et,we,_e],resizable:!0,draggable:!0},it=class s{static{a(this,"Gui")}__type="Gui";id=L();folder;static style=xe;opts;closed;presetManager;dirty=!1;wrapper;container;settingsFolder;static settingsFolderTitle="fracgui-settings-folder";_undoManager=new Ut;themer;themeEditor;windowManager;_isWindowManagerOwner=!1;_birthday=Date.now();_honeymoon=1e3;_theme;_log;on;addFolder(t,e){return this._honeymoon&&this._birthday-Date.now()<1e3&&(this._honeymoon=!1,this._reveal(!0)),this.folder.addFolder(t,e)}add;addMany;addButtonGrid;addSelect;addButton;addText;addNumber;addSwitch;addColor;constructor(t){let e=O([Si,t??{}],{concatArrays:!1});e.container??=document.body;let i=!1;typeof e.storage=="object"&&(e.storage=Object.assign({},ye,e.storage));let r=st(e.storage,ye);r?(e.storage={...r,key:`${r.key}::${e.title?.toLowerCase().replaceAll(/\s/g,"-")}`},`${e.storage.key}::wm::0::position`in localStorage||(i=!0)):i=!0,this.opts=e,this._log=new b(`Gui ${this.opts.title}`,{fg:"palevioletred"}),this._log.fn("constructor").debug({options:t,opts:e}),this.container=I(this.opts.container)[0],this.wrapper=f("div",{classes:["fracgui-wrapper"],style:{display:"contents"},parent:this.container}),this.folder=new St({...this.opts,__type:"FolderOptions",container:this.wrapper,gui:this}),this.on=this.folder.on.bind(this.folder),this.addFolder=this.folder.addFolder.bind(this.folder),this.add=this.folder.add.bind(this.folder),this.addMany=this.folder.addMany.bind(this.folder),this.addButtonGrid=this.folder.addButtonGrid.bind(this.folder),this.addSelect=this.folder.addSelect.bind(this.folder),this.addButton=this.folder.addButton.bind(this.folder),this.addText=this.folder.addText.bind(this.folder),this.addNumber=this.folder.addNumber.bind(this.folder),this.addSwitch=this.folder.addSwitch.bind(this.folder),this.addColor=this.folder.addColor.bind(this.folder);let n=a(o=>{globalThis.navigator?.userAgent?.match(/mac/i)?o.metaKey&&o.key==="z"&&(o.preventDefault(),o.shiftKey?this._undoManager.redo():this._undoManager.undo()):o.ctrlKey&&(o.key==="z"&&(o.preventDefault(),this._undoManager.undo()),o.key==="y"&&(o.preventDefault(),this._undoManager.redo()))},"handleUndoRedo");return removeEventListener("keydown",n),addEventListener("keydown",n),this.closed=_(!!this.opts.closed,{key:this.opts.storage?`${this.opts.storage.key}::closed`:void 0}),this.folder.elements.toolbar.settingsButton=this._createSettingsButton(this.folder.elements.toolbar.container),this.settingsFolder=this.folder.addFolder(s.settingsFolderTitle,{closed:!0,hidden:!1,_headerless:!0}),this.themer=this.opts._themer??this._createThemer(this.settingsFolder),this.theme=this.opts.theme,this.presetManager=this._createPresetManager(this.settingsFolder),this.applyAltStyle(this.settingsFolder),this.windowManager??=this._createWindowManager(this.opts,this.opts.storage),this._reveal(i),this}async _reveal(t){if(await Promise.resolve(),!this.container)return;let e=this.wrapper.cloneNode(!0);e.style.visibility="hidden",this.container.prepend(e);let i=e.children[0].getBoundingClientRect();if(e.remove(),typeof this.opts.position=="string"){let r=Rt(i,this.opts.position,{bounds:this.opts.container,margin:this.opts.margin});if(t||this.opts.storage&&this.opts.storage.position===!1){let n=this.windowManager?.windows.get(this.folder.element.id);n?.draggableInstance&&(n.draggableInstance.position=r)}else console.error("//todo - set position here or enforce window manager")}this.container.appendChild(this.wrapper),this.folder.element.animate([{opacity:0},{opacity:1}],{fill:"none",duration:400})}_createPresetManager(t){let{presets:e,defaultPreset:i,storage:r}=this.opts,n;return typeof r=="object"&&r.presets&&(n=r.key+"::presets"),new Nt(this,t,{presets:e,defaultPreset:i,localStorageKey:n})}_createWindowManager(t,e){if(this.windowManager)return this.windowManager;let i;this.opts.draggable&&(i=Object.assign({},te.draggable),i.handle=this.folder.elements.header,i.position=this.opts.position,i.localStorageKey=e&&e.key?e.key:void 0,i.bounds=this.container,e&&e.position===!1&&(i.localStorageKey=void 0));let r;if(this.opts.resizable&&(r=Object.assign({},te.resizable),r.bounds=this.container,r.localStorageKey=e&&e.key?e.key:void 0,e&&e.size===!1&&(r.localStorageKey=void 0)),t?._windowManager instanceof _t){let c=t._windowManager;return c.add(this.folder.element,{id:this.id,resizable:r,draggable:i}),c}let n=st({...te,draggable:i,resizable:r},Ft);this._log.fn("_createWindowManager").debug({windowManagerOpts:n,options:t,opts:this.opts,dragOpts:i,resizeOpts:r});let o=new _t({...n,draggable:i,resizable:r});return this._isWindowManagerOwner=!0,o.add(this.folder.element,{id:this.id}),o}set theme(t){this._theme=t,this.folder.element.setAttribute("theme",t),this.folder.element.setAttribute("mode",this.themer.mode.value)}get theme(){return this._theme}save(t,e=L(10)){return{__type:"GuiPreset",__version:0,id:e,title:t,data:this.folder.save()}}load(t){this._log.fn("load").debug({preset:t}),this.dirty=!1,this.lockCommits(t),this.folder.load(t.data),Promise.resolve().then(()=>this.unlockCommits())}_undoLock=!1;lockCommit={from:void 0};commit(t){if(this._undoLock){this._log.fn("commit").debug("LOCKED: prevented commit while locked");return}this._log.fn("commit").debug("commited",t),this._undoManager?.commit(t)}lockCommits=a(t=>{this._undoManager.lockedExternally=!0,this.lockCommit.from=t,this._log.fn(N("lock")).debug("commit",{from:t,lockCommit:this.lockCommit})},"lockCommits");unlockCommits=a(t=>{t??={},t.target??=this,t.from??=this.lockCommit.from,this._undoManager.lockedExternally=!1,this.commit(t),this._log.fn(N("unlock")).debug("commit",{commit:t,lockCommit:this.lockCommit})},"unlockCommits");_createThemer(t){this._log.fn("createThemer").debug({folder:t});let e,i=this.opts._themer,r={localStorageKey:this.opts.storage?this.opts.storage.key+"::themer":void 0,mode:this.opts.themeMode,autoInit:!this.themer,persistent:!!(this.opts.storage&&this.opts.storage.theme),themes:this.opts.themes,theme:this.opts.themes.find(o=>o.title===this.opts.theme),vars:de};r.vars=O([de,r.vars]),i?e=i:(r.wrapper=this.wrapper,e=new jt(this.folder.element,r)),this.folder.evm.add(e.mode.subscribe(()=>{this.settingsFolder&&this.applyAltStyle(this.settingsFolder)}));let n=t.addFolder("ui",{closed:!0});return n.on("mount",()=>{n.graphics?.connector?.svg.style.setProperty("filter","saturate(0.1)"),n.graphics?.icon.style.setProperty("filter","saturate(0)")}),t&&(n.addSelect({title:"theme",labelKey:"title",options:e.themes.value,binding:{target:e,key:"theme"}}),n.addButtonGrid({title:"mode",activeOnClick:!0,value:[["light","dark","system"].map(o=>({text:o,onClick:a(()=>e?.mode.set(o),"onClick"),active:a(()=>e?.mode.value===o,"active")}))]})),e}isGui(){return this.__type==="Gui"}_createSettingsButton(t){let e=f("button",{parent:t,classes:["fracgui-toolbar-item","fracgui-settings-button"],innerHTML:Ge,tooltip:{text:a(()=>this.settingsFolder?.closed.value?"Open Settings":"Close Settings","text"),placement:"left",delay:750,delayOut:0,hideOnClick:!0}});return e.addEventListener("click",()=>{this.settingsFolder.toggle(),this.folder.elements.toolbar.settingsButton?.classList.toggle("open",!this.settingsFolder.closed.value)}),e}applyAltStyle(t){switch(this._setVar(t.elements.content,"box-shadow",`0px 0px 10px 0px hsl(10deg, 0%, var(--${g}-shadow-lightness), inset`),t.elements.content.style.setProperty("background",`--${g}-folder_background`),this._setProps(t.element,[["background",`color-mix(in sRGB, var(--${g}-bg-b) 100%, transparent)`]]),this.themer?.activeMode){case"dark":{this._setVars(t.elements.contentWrapper,[["input-container_color",`var(--${g}-fg-b)`],["folder-header_background",`color-mix(in sRGB, var(--${g}-bg-a) 75%, transparent)`],["controller-dim_background",`color-mix(in sRGB, var(--${g}-bg-a) 50%, transparent)`],["controller_background",`color-mix(in sRGB, var(--${g}-bg-c) 50%, transparent)`]]);break}case"light":{this._setVars(t.elements.contentWrapper,[["folder-header_background",`color-mix(in sRGB, var(--${g}-bg-a) 60%, transparent)`],["controller_background",`var(--${g}-light-a)`]]);break}}}_setProps(t,e){for(let[i,r]of e)t.style.setProperty(i,r)}_setVar(t,e,i){t.style.setProperty(`--${g}-${e}`,i),Promise.resolve().then(()=>{t.style.getPropertyValue(`--${g}-${e}`)||console.warn(`No property found for --${g}-${e}`)})}_setVars(t,e){for(let[i,r]of e)this._setVar(t,i,r)}dispose=a(()=>{this._log.fn("dispose").debug(this),this.themer?.dispose(),this._isWindowManagerOwner&&(this.windowManager?.dispose(),this.container?.remove()),this.settingsFolder?.dispose(),this.folder?.dispose()},"dispose")};it=hr([B,ki("design:type",Function),ki("design:paramtypes",[typeof Partial>"u"?Object:Partial])],it);export{D as Color,St as Folder,Si as GUI_DEFAULTS,ye as GUI_STORAGE_DEFAULTS,te as GUI_WINDOWMANAGER_DEFAULTS,it as Gui,ht as isColor,me as isColorFormat,Jt as parseColorFormat,_ as state};
